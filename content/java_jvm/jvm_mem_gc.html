
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>堆栈 & GC · java-note</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="doctording">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-ace/ace.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sectionx/sectionx.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-treeview/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="jvm_params.html" />
    
    
    <link rel="prev" href="jvm_hot.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    [计算机组成]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../computer/cpu_cache.html">
            
                <a href="../computer/cpu_cache.html">
            
                    
                    CPU,缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../computer/process_thread.html">
            
                <a href="../computer/process_thread.html">
            
                    
                    进程和线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../computer/memory_manage.html">
            
                <a href="../computer/memory_manage.html">
            
                    
                    物理内存管理算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../computer/load.html">
            
                <a href="../computer/load.html">
            
                    
                    CPU负载load
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    [I/O & 网络]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../java_io_net/io_interrupte.html">
            
                <a href="../java_io_net/io_interrupte.html">
            
                    
                    IO与中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    [IO基础]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../java_io_net/io_basic.html">
            
                <a href="../java_io_net/io_basic.html">
            
                    
                    Java IO基础
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1" data-path="../java_io_net/io_basic_pro.html">
            
                <a href="../java_io_net/io_basic_pro.html">
            
                    
                    Java IO面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../java_io_net/nio_basic.html">
            
                <a href="../java_io_net/nio_basic.html">
            
                    
                    BIO 到 NIO & 多线程问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../java_io_net/from_io_to_epoll.html">
            
                <a href="../java_io_net/from_io_to_epoll.html">
            
                    
                    再谈select & epoll
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../java_io_net/server_socket_channel.html">
            
                <a href="../java_io_net/server_socket_channel.html">
            
                    
                    ServerSocketChannel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../distributed_design/design.html">
            
                <a href="../distributed_design/design.html">
            
                    
                    网络IO设计模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    [网络协议]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../java_io_net/http_tcp.html">
            
                <a href="../java_io_net/http_tcp.html">
            
                    
                    tcp & udp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../java_io_net/http_tcp_tcpdump.html">
            
                <a href="../java_io_net/http_tcp_tcpdump.html">
            
                    
                    tcp tcpdump
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../java_io_net/http_tcp_pro.html">
            
                <a href="../java_io_net/http_tcp_pro.html">
            
                    
                    http & tcp面试题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../distributed_design/nginx.html">
            
                <a href="../distributed_design/nginx.html">
            
                    
                    nginx基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../java_io_net/netty.html">
            
                <a href="../java_io_net/netty.html">
            
                    
                    netty
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    [数据库]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../db_cache/io.html">
            
                <a href="../db_cache/io.html">
            
                    
                    局部性原理&磁盘IO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../db_cache/mysql.html">
            
                <a href="../db_cache/mysql.html">
            
                    
                    MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../db_cache/mysql_batis.html">
            
                <a href="../db_cache/mysql_batis.html">
            
                    
                    MySQL连接 & MyBatis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../db_cache/mysql_opt.html">
            
                <a href="../db_cache/mysql_opt.html">
            
                    
                    MySQL优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../db_cache/mysql_monitor.html">
            
                <a href="../db_cache/mysql_monitor.html">
            
                    
                    MySQL线上监控 & 指标
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../db_cache/redis.html">
            
                <a href="../db_cache/redis.html">
            
                    
                    Redis
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../db_cache/redis_skip_list.html">
            
                <a href="../db_cache/redis_skip_list.html">
            
                    
                    跳表&zset
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../db_cache/mq.html">
            
                <a href="../db_cache/mq.html">
            
                    
                    rabbitmq
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    [分布式]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" >
            
                <span>
            
                    
                    [分布式基础]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../distributed_design/distribute.html">
            
                <a href="../distributed_design/distribute.html">
            
                    
                    分布式&微服务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="../distributed_design/distribute_data.html">
            
                <a href="../distributed_design/distribute_data.html">
            
                    
                    分布式存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="../distributed_design/distribute_tx.html">
            
                <a href="../distributed_design/distribute_tx.html">
            
                    
                    分布式事务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.4" data-path="../distributed_design/distribute_lock.html">
            
                <a href="../distributed_design/distribute_lock.html">
            
                    
                    分布式锁
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.5" data-path="../distributed_design/distribute_id.html">
            
                <a href="../distributed_design/distribute_id.html">
            
                    
                    分布式ID
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../distributed_design/rpc.html">
            
                <a href="../distributed_design/rpc.html">
            
                    
                    rpc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../distributed_design/zk.html">
            
                <a href="../distributed_design/zk.html">
            
                    
                    zookeeper
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="../distributed_design/zk2.html">
            
                <a href="../distributed_design/zk2.html">
            
                    
                    zookeeper单机源码 & Watch机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="../distributed_design/zk3.html">
            
                <a href="../distributed_design/zk3.html">
            
                    
                    zookeeper集群 & Zab协议
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../db_cache/LFU.html">
            
                <a href="../db_cache/LFU.html">
            
                    
                    LFU
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../db_cache/LRU.html">
            
                <a href="../db_cache/LRU.html">
            
                    
                    LRU
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../db_cache/consistent_hash.html">
            
                <a href="../db_cache/consistent_hash.html">
            
                    
                    一致性Hash
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    [缓存 & 限流]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../db_cache/cache.html">
            
                <a href="../db_cache/cache.html">
            
                    
                    缓存
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../db_cache/bloom.html">
            
                <a href="../db_cache/bloom.html">
            
                    
                    布隆过滤器
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../distributed_design/flow_limit.html">
            
                <a href="../distributed_design/flow_limit.html">
            
                    
                    限流
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../design_pattern/design_pattern.html">
            
                <a href="../design_pattern/design_pattern.html">
            
                    
                    常见设计模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../design_pattern/1_singleton.html">
            
                <a href="../design_pattern/1_singleton.html">
            
                    
                    单例模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../design_pattern/2_prototype.html">
            
                <a href="../design_pattern/2_prototype.html">
            
                    
                    原型模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../design_pattern/3_factory.html">
            
                <a href="../design_pattern/3_factory.html">
            
                    
                    工厂模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../design_pattern/6_proxy.html">
            
                <a href="../design_pattern/6_proxy.html">
            
                    
                    代理模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.4.1" data-path="../design_pattern/asm.html">
            
                <a href="../design_pattern/asm.html">
            
                    
                    ASM字节码操纵
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../design_pattern/7_adapter.html">
            
                <a href="../design_pattern/7_adapter.html">
            
                    
                    适配器模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../design_pattern/9_decorator.html">
            
                <a href="../design_pattern/9_decorator.html">
            
                    
                    装饰器模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../design_pattern/10_facade.html">
            
                <a href="../design_pattern/10_facade.html">
            
                    
                    门面模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="../design_pattern/13_template.html">
            
                <a href="../design_pattern/13_template.html">
            
                    
                    模板方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="../design_pattern/14_strategy.html">
            
                <a href="../design_pattern/14_strategy.html">
            
                    
                    策略模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="../design_pattern/18_observer.html">
            
                <a href="../design_pattern/18_observer.html">
            
                    
                    观察者模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.10.1" data-path="../design_pattern/publish.html">
            
                <a href="../design_pattern/publish.html">
            
                    
                    发布订阅模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="../design_pattern/19_listener.html">
            
                <a href="../design_pattern/19_listener.html">
            
                    
                    监听者模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="../design_pattern/20_iterator.html">
            
                <a href="../design_pattern/20_iterator.html">
            
                    
                    迭代器模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13" data-path="../design_pattern/21_visitor.html">
            
                <a href="../design_pattern/21_visitor.html">
            
                    
                    访问者模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    [数据结构和算法基础]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../java_data_structure/algorithm_structure.html">
            
                <a href="../java_data_structure/algorithm_structure.html">
            
                    
                    Java算法数据结构使用
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1.1" data-path="../java_utils/sort.html">
            
                <a href="../java_utils/sort.html">
            
                    
                    常见排序(没事手写写)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../java_data_structure/java_basic_datastructure.html">
            
                <a href="../java_data_structure/java_basic_datastructure.html">
            
                    
                    常见基础数据结构
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="../java_data_structure/array_list.html">
            
                <a href="../java_data_structure/array_list.html">
            
                    
                    ArrayList & LinkedList & Vector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" data-path="../java_data_structure/hash_map.html">
            
                <a href="../java_data_structure/hash_map.html">
            
                    
                    Java8 HashMap
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.2.1" data-path="../java_data_structure/hash_map_java7.html">
            
                <a href="../java_data_structure/hash_map_java7.html">
            
                    
                    Java1.7 HashMap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.2" data-path="../java_data_structure/hash_table.html">
            
                <a href="../java_data_structure/hash_table.html">
            
                    
                    HashTable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.3" data-path="../java_data_structure/linked_hash_map.html">
            
                <a href="../java_data_structure/linked_hash_map.html">
            
                    
                    LinkedHashMap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2.4" data-path="../java_data_structure/tree_map.html">
            
                <a href="../java_data_structure/tree_map.html">
            
                    
                    TreeMap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="../java_data_structure/fail_fast.html">
            
                <a href="../java_data_structure/fail_fast.html">
            
                    
                    fail-fast,ConcurrentModificationException
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="../java_data_structure/concurrent_datastructure.html">
            
                <a href="../java_data_structure/concurrent_datastructure.html">
            
                    
                    concurrent数据结构
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.4.1" data-path="../java_data_structure/concurrent_hashmap.html">
            
                <a href="../java_data_structure/concurrent_hashmap.html">
            
                    
                    Java8 ConcurrentMap
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.4.1.1" data-path="../java_data_structure/concurrent_hashmap7.html">
            
                <a href="../java_data_structure/concurrent_hashmap7.html">
            
                    
                    Jdk1.7 ConcurrentMap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.4.2" data-path="../java_data_structure/queue.html">
            
                <a href="../java_data_structure/queue.html">
            
                    
                    Java中的队列
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="../java_data_structure/Map.html">
            
                <a href="../java_data_structure/Map.html">
            
                    
                    HashMap,HashTable,ConcurrentHashMap对比
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../java_data_structure/advanced_structure.html">
            
                <a href="../java_data_structure/advanced_structure.html">
            
                    
                    高级数据结构
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.1" data-path="../java_data_structure/b_tree.html">
            
                <a href="../java_data_structure/b_tree.html">
            
                    
                    B/B+ Tree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.2" data-path="../java_data_structure/inversed_index.html">
            
                <a href="../java_data_structure/inversed_index.html">
            
                    
                    倒排索引
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.3" data-path="../java_data_structure/lsm_tree.html">
            
                <a href="../java_data_structure/lsm_tree.html">
            
                    
                    LSM Tree
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    [Java基础问题]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../db_cache/serialize.html">
            
                <a href="../db_cache/serialize.html">
            
                    
                    序列化问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../java_utils/spi.html">
            
                <a href="../java_utils/spi.html">
            
                    
                    Java SPI机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../java_utils/synthetic.html">
            
                <a href="../java_utils/synthetic.html">
            
                    
                    Java Synthetic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../java_utils/object.html">
            
                <a href="../java_utils/object.html">
            
                    
                    java.lang.Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../java_data_structure/System_arraycopy.html">
            
                <a href="../java_data_structure/System_arraycopy.html">
            
                    
                    System.arraycopy, Array.copyOf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../java_utils/equals_hashcode.html">
            
                <a href="../java_utils/equals_hashcode.html">
            
                    
                    == & equals方法 & hashcode方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../java_utils/Calendar.html">
            
                <a href="../java_utils/Calendar.html">
            
                    
                    Calendar & Date
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="../java_utils/Compare.html">
            
                <a href="../java_utils/Compare.html">
            
                    
                    Comparison method violates its general contract
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="../java_utils/int_Integer.html">
            
                <a href="../java_utils/int_Integer.html">
            
                    
                    int(基本类型) & Integer(包装类类型)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="../java_utils/exception.html">
            
                <a href="../java_utils/exception.html">
            
                    
                    Java异常&错误
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="../java_utils/String.html">
            
                <a href="../java_utils/String.html">
            
                    
                    String,StringBuffer,StringBuilder
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.11.1" data-path="../java_utils/swap_string.html">
            
                <a href="../java_utils/swap_string.html">
            
                    
                    String交换问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11.2" data-path="../java_utils/string_intern.html">
            
                <a href="../java_utils/string_intern.html">
            
                    
                    String.intern()问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.12" data-path="../java_utils/reflect.html">
            
                <a href="../java_utils/reflect.html">
            
                    
                    反射机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.13" data-path="../java_utils/call_back.html">
            
                <a href="../java_utils/call_back.html">
            
                    
                    回调 & 事件机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.14" data-path="../java_utils/array_collection.html">
            
                <a href="../java_utils/array_collection.html">
            
                    
                    数组，集合转换等问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15" data-path="../java_utils/annotation.html">
            
                <a href="../java_utils/annotation.html">
            
                    
                    注解 Annotation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16" data-path="jvm_runtime.html">
            
                <a href="jvm_runtime.html">
            
                    
                    Runtime类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.17" data-path="../java_utils/override_overload.html">
            
                <a href="../java_utils/override_overload.html">
            
                    
                    重载和重写
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.18" data-path="../java_utils/reg.html">
            
                <a href="../java_utils/reg.html">
            
                    
                    正则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.19" data-path="../java_data_structure/unsafe.html">
            
                <a href="../java_data_structure/unsafe.html">
            
                    
                    unsafe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.20" data-path="../java_utils/val_static.html">
            
                <a href="../java_utils/val_static.html">
            
                    
                    Java static关键字
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.21" data-path="../java_thinking_in_Java/basic.html">
            
                <a href="../java_thinking_in_Java/basic.html">
            
                    
                    《Java编程思想》第3章：操作符，第4章：控制执行流程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.22" data-path="../java_thinking_in_Java/constructor.html">
            
                <a href="../java_thinking_in_Java/constructor.html">
            
                    
                    《Java编程思想》第5章：初始化和清理(重点)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.23" data-path="../java_thinking_in_Java/public_private_protect.html">
            
                <a href="../java_thinking_in_Java/public_private_protect.html">
            
                    
                    《Java编程思想》第6章：访问权限控制(重要)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.24" data-path="../java_thinking_in_Java/class_final.html">
            
                <a href="../java_thinking_in_Java/class_final.html">
            
                    
                    《Java编程思想》第7章：复用类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.25" data-path="../java_thinking_in_Java/polymorphism.html">
            
                <a href="../java_thinking_in_Java/polymorphism.html">
            
                    
                    《Java编程思想》第8章：多态
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.26" data-path="../java_thinking_in_Java/class_final.html">
            
                <a href="../java_thinking_in_Java/class_final.html">
            
                    
                    《Java编程思想》第9章：接口 补充：抽象类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.27" data-path="../java_thinking_in_Java/innner_class.html">
            
                <a href="../java_thinking_in_Java/innner_class.html">
            
                    
                    《Java编程思想》第10章：内部类
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    [JVM]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="jvm.html">
            
                <a href="jvm.html">
            
                    
                    JVM规范
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="jvm_instruct.html">
            
                <a href="jvm_instruct.html">
            
                    
                    JVM指令手册
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="jvm_class_load.html">
            
                <a href="jvm_class_load.html">
            
                    
                    类加载机制,运行时内存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="jvm_mem_model.html">
            
                <a href="jvm_mem_model.html">
            
                    
                    Java内存模型与多线程并发
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="jvm_hot.html">
            
                <a href="jvm_hot.html">
            
                    
                    JVM预热
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.10.6" data-path="jvm_mem_gc.html">
            
                <a href="jvm_mem_gc.html">
            
                    
                    堆栈 & GC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="jvm_params.html">
            
                <a href="jvm_params.html">
            
                    
                    JVM参数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="jvm_tools.html">
            
                <a href="jvm_tools.html">
            
                    
                    JVM命令工具(jstack,jmap,jcmd...)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    [Java多线程 & 并发基础]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../java_thread_concurrent/cas.html">
            
                <a href="../java_thread_concurrent/cas.html">
            
                    
                    CAS & 原子变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../java_thread_concurrent/volatile.html">
            
                <a href="../java_thread_concurrent/volatile.html">
            
                    
                    volatile 关键字
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../java_thread_concurrent/synchronized.html">
            
                <a href="../java_thread_concurrent/synchronized.html">
            
                    
                    synchronized 关键字
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../java_thread_concurrent/aqs.html">
            
                <a href="../java_thread_concurrent/aqs.html">
            
                    
                    AQS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../java_thread_concurrent/thread_lock.html">
            
                <a href="../java_thread_concurrent/thread_lock.html">
            
                    
                    Java Lock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../java_thread_concurrent/linux_lock.html">
            
                <a href="../java_thread_concurrent/linux_lock.html">
            
                    
                    Linux spin lock & mutex
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" >
            
                <span>
            
                    
                    [线程]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.7.1" data-path="../java_thread_concurrent/thread_basic.html">
            
                <a href="../java_thread_concurrent/thread_basic.html">
            
                    
                    Java线程基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.2" data-path="../java_thread_concurrent/jvm_object_monitor.html">
            
                <a href="../java_thread_concurrent/jvm_object_monitor.html">
            
                    
                    ObjectMonitor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.3" data-path="../java_thread_concurrent/park_unpark.html">
            
                <a href="../java_thread_concurrent/park_unpark.html">
            
                    
                    park,unpark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.4" data-path="../java_thread_concurrent/thread_condition.html">
            
                <a href="../java_thread_concurrent/thread_condition.html">
            
                    
                    Condition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.5" data-path="../java_thread_concurrent/semaphore.html">
            
                <a href="../java_thread_concurrent/semaphore.html">
            
                    
                    Semaphore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.6" data-path="../java_thread_concurrent/hook_thread.html">
            
                <a href="../java_thread_concurrent/hook_thread.html">
            
                    
                    Hook线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.7" data-path="../java_thread_concurrent/countdownlatch_cyclicBarrier.html">
            
                <a href="../java_thread_concurrent/countdownlatch_cyclicBarrier.html">
            
                    
                    CountDownLatch & CyclicBarrier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.8" data-path="../java_thread_concurrent/longAdder.html">
            
                <a href="../java_thread_concurrent/longAdder.html">
            
                    
                    LongAdder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.9" data-path="../java_thread_concurrent/exchanger.html">
            
                <a href="../java_thread_concurrent/exchanger.html">
            
                    
                    Exchanger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7.10" data-path="../java_thread_concurrent/thread_design.html">
            
                <a href="../java_thread_concurrent/thread_design.html">
            
                    
                    多线程设计模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.8" >
            
                <span>
            
                    
                    [线程池]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.8.1" data-path="../java_thread_concurrent/thread_pool.html">
            
                <a href="../java_thread_concurrent/thread_pool.html">
            
                    
                    Java线程池
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8.2" data-path="../java_thread_concurrent/concurrency_problems.html">
            
                <a href="../java_thread_concurrent/concurrency_problems.html">
            
                    
                    常见的多线程题目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8.3" data-path="../java_thread_concurrent/thread_pool_self.html">
            
                <a href="../java_thread_concurrent/thread_pool_self.html">
            
                    
                    自定义线程池
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="../java_thread_concurrent/thread_deadlock.html">
            
                <a href="../java_thread_concurrent/thread_deadlock.html">
            
                    
                    死锁问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.10" data-path="../java_thread_concurrent/threadLocal.html">
            
                <a href="../java_thread_concurrent/threadLocal.html">
            
                    
                    ThreadLocal对象
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../java8/java8.html">
            
                <a href="../java8/java8.html">
            
                    
                    Java8
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../java8/java8_future.html">
            
                <a href="../java8/java8_future.html">
            
                    
                    Future
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../java8/java8_completableFuture.html">
            
                <a href="../java8/java8_completableFuture.html">
            
                    
                    CompletableFuture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../java8/interface_default.html">
            
                <a href="../java8/interface_default.html">
            
                    
                    interface defalt static
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../java8/java8_mem.html">
            
                <a href="../java8/java8_mem.html">
            
                    
                    Java8 jvm内存结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../java8/lambda.html">
            
                <a href="../java8/lambda.html">
            
                    
                    Java8 lambda表达式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../java8/java8_optional.html">
            
                <a href="../java8/java8_optional.html">
            
                    
                    Java8 Optional
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="../java8/streams.html">
            
                <a href="../java8/streams.html">
            
                    
                    Java8 Streams
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="../java8/streams_parallel.html">
            
                <a href="../java8/streams_parallel.html">
            
                    
                    Java8 并行数据处理与性能
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    [项目经验]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../system_design/seckill.html">
            
                <a href="../system_design/seckill.html">
            
                    
                    系统设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../system_design/db_split.html">
            
                <a href="../system_design/db_split.html">
            
                    
                    10亿级订单系统分库分表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../system_design/pdd.html">
            
                <a href="../system_design/pdd.html">
            
                    
                    个人项目介绍
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    [脚本&面试题]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../shell/awk.html">
            
                <a href="../shell/awk.html">
            
                    
                    awk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../shell/words_count.html">
            
                <a href="../shell/words_count.html">
            
                    
                    统计词频bash脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../shell/big_data.html">
            
                <a href="../shell/big_data.html">
            
                    
                    大数据量问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
                <span>
            
                    
                    [python]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../python/py.html">
            
                <a href="../python/py.html">
            
                    
                    python基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../python/py_coroutine.html">
            
                <a href="../python/py_coroutine.html">
            
                    
                    python协程gevent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="../python/py_object.html">
            
                <a href="../python/py_object.html">
            
                    
                    python可变对象与不可变对象
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="../python/py_time.html">
            
                <a href="../python/py_time.html">
            
                    
                    python时间处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="../python/py_contextor.html">
            
                <a href="../python/py_contextor.html">
            
                    
                    python上线文管理器
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
                <span>
            
                    
                    [算法]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../thought_of_solve/thought.html">
            
                <a href="../thought_of_solve/thought.html">
            
                    
                    剑指Offer解题思路(全)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >堆栈 & GC</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div class="treeview__container"><div class="treeview__container-title"><span class="treeview__main-title">Treeview</span><span class="treeview__copyright">Copyright @doctording all right reserved, powered by <a href="https://github.com/aleen42" target="_blank">aleen42</a></span></div><ul>
<li><div><a href="#&#x5806;&#x5185;&#x5B58;">&#x5806;&#x5185;&#x5B58;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#java7&#x5806;&#x5185;&#x5B58;&#x5212;&#x5206;">Java7&#x5806;&#x5185;&#x5B58;&#x5212;&#x5206;</a><i></i></div></li>
<li><div><a href="#&#x5806;&#x533A;&#x57DF;&#x4E0E;&#x5206;&#x4EE3;">&#x5806;&#x533A;&#x57DF;&#x4E0E;&#x5206;&#x4EE3;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5206;&#x4EE3;&#xFF1F;&#x5206;&#x4EE3;&#x6240;&#x7528;&#x7684;gc&#x7B97;&#x6CD5;&#xFF1F;">&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5206;&#x4EE3;&#xFF1F;&#x5206;&#x4EE3;&#x6240;&#x7528;&#x7684;gc&#x7B97;&#x6CD5;&#xFF1F;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#jvm-&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x6765;&#x6E90;">JVM &#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x6765;&#x6E90;?</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#java7-&#x5806;&#x7684;&#x5404;&#x533A;&#x57DF;">Java7 &#x5806;&#x7684;&#x5404;&#x533A;&#x57DF;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#java7&#x6C38;&#x4E45;&#x4EE3;perm-space">Java7&#x6C38;&#x4E45;&#x4EE3;(Perm space)</a><i></i></div></li>
</ul></li>
<li><div><a href="#java8-&#x5185;&#x5B58;&#x533A;&#x57DF;">Java8 &#x5185;&#x5B58;&#x533A;&#x57DF;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#java8&#x5143;&#x7A7A;&#x95F4;&#x5143;&#x6570;&#x636E;&#x533A;">Java8&#x5143;&#x7A7A;&#x95F4;(&#x5143;&#x6570;&#x636E;&#x533A;)</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#&#x5783;&#x573E;&#x6536;&#x96C6;">&#x5783;&#x573E;&#x6536;&#x96C6;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x4E09;&#x4E2A;&#x95EE;&#x9898;">&#x4E09;&#x4E2A;&#x95EE;&#x9898;</a><i></i></div></li>
<li><div><a href="#&#x901A;&#x8FC7;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x6765;&#x5224;&#x5B9A;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5B58;&#x6D3B;&#x4EC0;&#x4E48;&#x662F;&#x5783;&#x573E;">&#x901A;&#x8FC7;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x6765;&#x5224;&#x5B9A;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5B58;&#x6D3B;(&#x4EC0;&#x4E48;&#x662F;&#x5783;&#x573E;?)</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#java&#x4E2D;&#x53EF;&#x4F5C;&#x4E3A;gc-roots&#x7684;&#x5BF9;&#x8C61;&#x5305;&#x62EC;">Java&#x4E2D;&#x53EF;&#x4F5C;&#x4E3A;(GC Roots)&#x7684;&#x5BF9;&#x8C61;&#x5305;&#x62EC;</a><i></i></div></li>
</ul></li>
<li><div><a href="#4&#x79CD;&#x5F15;&#x7528;reference">4&#x79CD;&#x5F15;&#x7528;(Reference)</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x5F3A;&#x5F15;&#x7528;">&#x5F3A;&#x5F15;&#x7528;</a><i></i></div></li>
<li><div><a href="#&#x8F6F;&#x5F15;&#x7528;softreference">&#x8F6F;&#x5F15;&#x7528;(SoftReference)</a><i></i></div></li>
<li><div><a href="#&#x5F31;&#x5F15;&#x7528;weakreference">&#x5F31;&#x5F15;&#x7528;(WeakReference)</a><i></i></div></li>
<li><div><a href="#&#x865A;&#x5F15;&#x7528;phantomreference">&#x865A;&#x5F15;&#x7528;(PhantomReference)</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x5BF9;&#x8C61;&#x662F;&#x751F;&#x5B58;&#x8FD8;&#x662F;&#x6B7B;&#x4EA1;&#x7684;&#xFF1F;">&#x5BF9;&#x8C61;&#x662F;&#x751F;&#x5B58;&#x8FD8;&#x662F;&#x6B7B;&#x4EA1;&#x7684;&#xFF1F;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x4E24;&#x6B21;&#x6807;&#x8BB0;--f-queue--finalizer&#x7EBF;&#x7A0B;">&#x4E24;&#x6B21;&#x6807;&#x8BB0; &amp; F-Queue &amp; Finalizer&#x7EBF;&#x7A0B;</a><i></i></div></li>
<li><div><a href="#finalize&#x81EA;&#x6551;&#x4EE3;&#x7801;&#x6F14;&#x793A;">finalize()&#x81EA;&#x6551;&#x4EE3;&#x7801;&#x6F14;&#x793A;</a><i></i></div></li>
<li><div><a href="#&#x6700;&#x540E;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;finalize">&#x6700;&#x540E;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;finalize()</a><i></i></div></li>
</ul></li>
<li><div><a href="#java7&#x65B9;&#x6CD5;&#x533A;&#x6C38;&#x4E45;&#x4EE3;&#x7684;&#x56DE;&#x6536;">Java7&#x65B9;&#x6CD5;&#x533A;(&#x6C38;&#x4E45;&#x4EE3;)&#x7684;&#x56DE;&#x6536;</a><i></i></div></li>
<li><div><a href="#hotspot-&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;">HotSpot &#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#stop-the-world">Stop The World</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#&#x5E38;&#x89C1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;">&#x5E38;&#x89C1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;</a><i></i></div></li>
<li><div><a href="#&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x53D1;&#x5C55;&#x548C;&#x4ECB;&#x7ECD;">&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x53D1;&#x5C55;&#x548C;&#x4ECB;&#x7ECD;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#gc&#x6536;&#x96C6;&#x5668;&#x53CA;&#x5176;&#x53D1;&#x5C55;">GC&#x6536;&#x96C6;&#x5668;&#x53CA;&#x5176;&#x53D1;&#x5C55;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x4E00;-serial&#xFF08;stw&#x5355;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;">(&#x4E00;) Serial&#xFF08;STW,&#x5355;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#serial-old">Serial Old</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x4E8C;-parallel-scavenge&#xFF08;stw&#x591A;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;">(&#x4E8C;) Parallel Scavenge&#xFF08;STW,&#x591A;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#parallel-old">Parallel old</a><i></i></div></li>
<li><div><a href="#parnew-parallel-scavenge&#x7684;&#x589E;&#x5F3A;&#x7248;">ParNew (Parallel Scavenge&#x7684;&#x589E;&#x5F3A;&#x7248;)</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x4E09;-cms&#x6536;&#x96C6;&#x5668;&#xFF08;&#x5E76;&#x53D1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#xFF09;">(&#x4E09;) CMS&#x6536;&#x96C6;&#x5668;&#xFF08;&#x5E76;&#x53D1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#xFF09;</a><i></i></div></li>
<li><div><a href="#&#x56DB;-g1">(&#x56DB;) G1</a><i></i></div></li>
<li><div><a href="#&#x4E94;-zgc">(&#x4E94;) ZGC</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#zgc&#x539F;&#x7406;">ZGC&#x539F;&#x7406;</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#java&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x4F9D;&#x636E;&#x5047;&#x8BBE;">Java&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x4F9D;&#x636E;/&#x5047;&#x8BBE;</a><i></i></div></li>
<li><div><a href="#&#x5206;&#x4EE3;gc&#x67E5;&#x770B;&#x9ED8;&#x8BA4;&#x7684;gc&#x914D;&#x7F6E;">&#x5206;&#x4EE3;GC,&#x67E5;&#x770B;&#x9ED8;&#x8BA4;&#x7684;GC&#x914D;&#x7F6E;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#new-object&#x7684;gc&#x751F;&#x547D;&#x5468;&#x671F;">new object&#x7684;gc&#x751F;&#x547D;&#x5468;&#x671F;</a><i></i></div></li>
</ul></li>
<li><div><a href="#cmsconcurrent-mark-sweep&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;">CMS(Concurrent Mark Sweep)&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#cms&#x5904;&#x7406;&#x7684;4&#x4E2A;&#x6B65;&#x9AA4;">CMS&#x5904;&#x7406;&#x7684;4&#x4E2A;&#x6B65;&#x9AA4;</a><i></i></div></li>
<li><div><a href="#&#x7F3A;&#x70B9;">&#x7F3A;&#x70B9;</a><i></i></div></li>
<li><div><a href="#&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF08;gc&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF1A;dfs&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF09;">&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF08;gc&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF1A;dfs&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF09;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x95EE;&#x9898;">&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x95EE;&#x9898;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x6F0F;&#x6807;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;">&#x6F0F;&#x6807;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;</a><i></i></div></li>
</ul></li>
<li><div><a href="#cms&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x548C;remark">CMS&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x548C;remark</a><i></i></div></li>
<li><div><a href="#&#x6269;&#x5C55;&#xFF1A;g1&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x5199;&#x5C4F;&#x969C;--snapshot-at-the-begining">&#x6269;&#x5C55;&#xFF1A;G1&#x89E3;&#x51B3;&#x65B9;&#x6CD5;(&#x5199;&#x5C4F;&#x969C; + Snapshot At the begining)</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#g1garbage-first&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;">G1(Garbage First)&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x53C2;&#x8003;&#x5B66;&#x4E60;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x5B66;&#x4E60;&#x6587;&#x6863;</a><i></i></div></li>
<li><div><a href="#g1&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;">G1&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;</a><i></i></div></li>
<li><div><a href="#g1-&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5206;&#x5E03;&#x56FE;&#x548C;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;">G1 &#x5185;&#x5B58;&#x533A;&#x57DF;&#x5206;&#x5E03;&#x56FE;&#x548C;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;</a><i></i></div></li>
<li><div><a href="#g1-&#x5E38;&#x7528;&#x53C2;&#x6570;">G1 &#x5E38;&#x7528;&#x53C2;&#x6570;</a><i></i></div></li>
<li><div><a href="#remember-set--collection-set">Remember Set &amp; Collection Set</a><i></i></div></li>
<li><div><a href="#satb&#xFF08;snapshot-at-the-beginning&#xFF09;">SATB&#xFF08;Snapshot-At-The-Beginning&#xFF09;</a><i></i></div></li>
<li><div><a href="#g1&#x7684;gc">G1&#x7684;GC</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#young-gcminor-gc&#x5BF9;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;gc">young gc/minor gc(&#x5BF9;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;GC)</a><i></i></div></li>
<li><div><a href="#mixed-gcyoung-&#x548C;-old&#x90FD;gc">mixed gc(young &#x548C; old&#x90FD;gc)</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#mix-gc&#x7684;&#x8FC7;&#x7A0B;">mix gc&#x7684;&#x8FC7;&#x7A0B;</a><i></i></div></li>
<li><div><a href="#initial-marking-phase&#x521D;&#x59CB;&#x6807;&#x8BB0;&#xFF0C;stw">Initial Marking Phase(&#x521D;&#x59CB;&#x6807;&#x8BB0;&#xFF0C;STW)</a><i></i></div></li>
<li><div><a href="#concurrent-marking-phase&#xFF08;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#xFF1A;&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF0C;&#x4E0E;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF09;">Concurrent Marking Phase&#xFF08;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#xFF1A;&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF0C;&#x4E0E;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF09;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x8865;&#x5145;">&#x4E09;&#x8272;&#x6807;&#x8BB0;(&#x8865;&#x5145;)</a><i></i></div></li>
</ul></li>
<li><div><a href="#remark-phase&#xFF08;&#x6700;&#x7EC8;&#x6807;&#x8BB0;&#xFF0C;stw-cpu&#x505C;&#x987F;&#x5904;&#x7406;&#x5783;&#x573E;&#xFF09;">Remark Phase&#xFF08;&#x6700;&#x7EC8;&#x6807;&#x8BB0;&#xFF0C;STW, CPU&#x505C;&#x987F;&#x5904;&#x7406;&#x5783;&#x573E;&#xFF09;</a><i></i></div></li>
<li><div><a href="#copyingcleanup-phase&#xFF08;&#x7B5B;&#x9009;&#x90E8;&#x5206;region&#x56DE;&#x6536;&#xFF0C;&#x800C;&#x975E;&#x5168;&#x90E8;&#x56DE;&#x6536;&#xFF1B;stw&#xFF1A;&#x6839;&#x636E;&#x7528;&#x6237;&#x671F;&#x671B;&#x7684;gc&#x505C;&#x987F;&#x65F6;&#x95F4;&#x56DE;&#x6536;&#xFF09;">Copying/Cleanup Phase&#xFF08;&#x7B5B;&#x9009;&#x90E8;&#x5206;region&#x56DE;&#x6536;&#xFF0C;&#x800C;&#x975E;&#x5168;&#x90E8;&#x56DE;&#x6536;&#xFF1B;STW&#xFF1A;&#x6839;&#x636E;&#x7528;&#x6237;&#x671F;&#x671B;&#x7684;GC&#x505C;&#x987F;&#x65F6;&#x95F4;&#x56DE;&#x6536;&#xFF09;</a><i></i></div></li>
</ul></li>
<li><div><a href="#serial-old-gc">serial old GC</a><i></i></div></li>
<li><div><a href="#g1-gc&#x603B;&#x7ED3;">g1 gc&#x603B;&#x7ED3;</a><i></i></div></li>
</ul></li>
<li><div><a href="#g1&#x505C;&#x987F;&#x8017;&#x65F6;&#x7684;&#x4E3B;&#x8981;&#x74F6;&#x9888;">G1&#x505C;&#x987F;&#x8017;&#x65F6;&#x7684;&#x4E3B;&#x8981;&#x74F6;&#x9888;</a><i></i></div></li>
<li><div><a href="#g1&#x7684;&#x4F18;&#x52BF;&#xFF08;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x591F;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x505C;&#x7559;&#x65F6;&#x95F4;&#xFF09;">G1&#x7684;&#x4F18;&#x52BF;&#xFF08;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x591F;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x505C;&#x7559;&#x65F6;&#x95F4;&#xFF09;</a><i></i></div></li>
</ul></li>
<li><div><a href="#g1-&#x548C;-cms">G1 &#x548C; CMS</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#g1-&#x548C;-cms-&#x5806;&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF08;&#x5206;&#x4EE3;--region&#xFF09;">G1 &#x548C; CMS &#x5806;&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF08;&#x5206;&#x4EE3; &amp; region&#xFF09;</a><i></i></div></li>
<li><div><a href="#g1-&#x548C;-cms-gc&#x7684;&#x533A;&#x522B;">G1 &#x548C; CMS GC&#x7684;&#x533A;&#x522B;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x5185;&#x5B58;&#x5206;&#x914D;&#x4E0E;&#x56DE;&#x6536;&#x7B56;&#x7565;&#x7406;&#x8BBA;&#x57FA;&#x7840;">&#x5185;&#x5B58;&#x5206;&#x914D;&#x4E0E;&#x56DE;&#x6536;&#x7B56;&#x7565;(&#x7406;&#x8BBA;&#x57FA;&#x7840;)</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x5BF9;&#x8C61;&#x4F18;&#x5148;&#x5728;eden&#x5206;&#x914D;">&#x5BF9;&#x8C61;&#x4F18;&#x5148;&#x5728;Eden&#x5206;&#x914D;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#minor-gcyong-gc">minor gc(yong gc)</a><i></i></div></li>
<li><div><a href="#major-gc-full-gc">major gc/ full gc</a><i></i></div></li>
<li><div><a href="#java-&#x5206;&#x4EE3;gc&#x6D4B;&#x8BD5;&#x7A0B;&#x5E8F;-&#x548C;-&#x521D;&#x59CB;&#x5806;&#x60C5;&#x51B5;java7-cms">Java &#x5206;&#x4EE3;GC&#x6D4B;&#x8BD5;&#x7A0B;&#x5E8F; &#x548C; &#x521D;&#x59CB;&#x5806;&#x60C5;&#x51B5;(Java7 CMS)</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x5BF9;&#x5E94;&#x7684;gc&#x65E5;&#x5FD7;">&#x5BF9;&#x5E94;&#x7684;GC&#x65E5;&#x5FD7;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x53C2;&#x8003;">&#x53C2;&#x8003;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x5927;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;">&#x5927;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</a><i></i></div></li>
<li><div><a href="#&#x957F;&#x671F;&#x5B58;&#x6D3B;&#x7684;age15&#x5BF9;&#x8C61;&#x5C06;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;">&#x957F;&#x671F;&#x5B58;&#x6D3B;&#x7684;(Age15)&#x5BF9;&#x8C61;&#x5C06;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</a><i></i></div></li>
<li><div><a href="#&#x52A8;&#x6001;&#x5BF9;&#x8C61;&#x7684;&#x5E74;&#x9F84;&#x5224;&#x5B9A;">&#x52A8;&#x6001;&#x5BF9;&#x8C61;&#x7684;&#x5E74;&#x9F84;&#x5224;&#x5B9A;</a><i></i></div></li>
<li><div><a href="#&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x62C5;&#x4FDD;">&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x62C5;&#x4FDD;</a><i></i></div></li>
<li><div><a href="#&#x89E6;&#x53D1;gc&#x7684;&#x6761;&#x4EF6;">&#x89E6;&#x53D1;gc&#x7684;&#x6761;&#x4EF6;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#minor-gc&#x89E6;&#x53D1;&#x6761;&#x4EF6;">Minor GC&#x89E6;&#x53D1;&#x6761;&#x4EF6;</a><i></i></div></li>
<li><div><a href="#full-gc&#x89E6;&#x53D1;&#x6761;&#x4EF6;">Full GC&#x89E6;&#x53D1;&#x6761;&#x4EF6;</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#jvm&#x53C2;&#x6570;&#x4E0E;gc">JVM&#x53C2;&#x6570;&#x4E0E;GC</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#java8-&#x9ED8;&#x8BA4;gc">Java8 &#x9ED8;&#x8BA4;GC</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#&#x5806;&#x5916;&#x5185;&#x5B58;">&#x5806;&#x5916;&#x5185;&#x5B58;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x95EE;&#x9898;">&#x95EE;&#x9898;</a><i></i></div></li>
<li><div><a href="#&#x6982;&#x5FF5;">&#x6982;&#x5FF5;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#directbytebuffer-&#x5982;&#x4F55;&#x56DE;&#x6536;">DirectByteBuffer &#x5982;&#x4F55;&#x56DE;&#x6536;</a><i></i></div></li>
<li><div><a href="#&#x5806;&#x5916;&#x5185;&#x5B58;&#x6EA2;&#x51FA;">&#x5806;&#x5916;&#x5185;&#x5B58;&#x6EA2;&#x51FA;</a><i></i></div></li>
<li><div><a href="#&#x5806;&#x5916;&#x5185;&#x5B58;&#x66F4;&#x9002;&#x5408;&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;">&#x5806;&#x5916;&#x5185;&#x5B58;&#x66F4;&#x9002;&#x5408;&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#java-&#x5185;&#x5B58;&#x533A;&#x57DF;&#x548C;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x6F14;&#x7EC3;&#x6D4B;&#x8BD5;">Java &#x5185;&#x5B58;&#x533A;&#x57DF;&#x548C;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x6F14;&#x7EC3;&#x6D4B;&#x8BD5;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#outofmemoryerror">OutOfMemoryError</a><i></i></div></li>
<li><div><a href="#&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x6EA2;&#x51FA;">&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x6EA2;&#x51FA;</a><i></i></div></li>
<li><div><a href="#&#x65B9;&#x6CD5;&#x533A;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x6EA2;&#x51FA;">&#x65B9;&#x6CD5;&#x533A;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x6EA2;&#x51FA;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#java7-&#x5E38;&#x91CF;&#x6C60;-&#x4ECD;&#x662F;javalangoutofmemoryerror-java-heap-space">Java7 &#x5E38;&#x91CF;&#x6C60; &#x4ECD;&#x662F;java.lang.OutOfMemoryError: Java heap space</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x6EA2;&#x51FA;">&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x6EA2;&#x51FA;</a><i></i></div></li>
</ul></li>
</ul>
</div>


<p>[TOC]</p>
<h1 id="&#x5806;&#x5185;&#x5B58;">&#x5806;&#x5185;&#x5B58;</h1>
<h2 id="java7&#x5806;&#x5185;&#x5B58;&#x5212;&#x5206;">Java7&#x5806;&#x5185;&#x5B58;&#x5212;&#x5206;</h2>
<p>&#x53C2;&#x8003;&#x56FE;&#x4E66;&#x300A;&#x6DF1;&#x5165;&#x7406;&#x89E3;java&#x865A;&#x62DF;&#x673A;&#x300B;&#x5806;&#x7684;&#x63CF;&#x8FF0;</p>
<ol>
<li>Java&#x5806;&#xFF08;Java Heap&#xFF09;&#x662F;java&#x865A;&#x62DF;&#x673A;&#x6240;&#x7BA1;&#x7406;&#x7684;&#x5185;&#x5B58;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x4E00;&#x5757;</li>
<li>Java&#x5806;&#x88AB;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x533A;&#x57DF;</li>
<li>&#x865A;&#x62DF;&#x673A;&#x542F;&#x52A8;&#x65F6;&#x521B;&#x5EFA;java&#x5806;</li>
<li>Java&#x5806;&#x7684;&#x552F;&#x4E00;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x5B58;&#x653E;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</li>
<li>Java&#x5806;&#x662F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x7BA1;&#x7406;&#x7684;&#x4E3B;&#x8981;&#x533A;&#x57DF;&#x3002;</li>
<li>&#x4ECE;&#x5185;&#x5B58;&#x56DE;&#x6536;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x7531;&#x4E8E;&#x73B0;&#x5728;&#x6536;&#x96C6;&#x5668;&#x57FA;&#x672C;&#x90FD;&#x91C7;&#x7528;&#x5206;&#x4EE3;&#x6536;&#x96C6;&#x7B97;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;Java&#x5806;&#x53EF;&#x4EE5;&#x7EC6;&#x5206;&#x4E3A;&#xFF1A;&#x65B0;&#x751F;&#x4EE3;&#xFF08;<code>Young</code>&#xFF09;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#xFF08;<code>Old</code>&#xFF09;&#x3002;&#x65B0;&#x751F;&#x4EE3;&#x53C8;&#x88AB;&#x5212;&#x5206;&#x4E3A;&#x4E09;&#x4E2A;&#x533A;&#x57DF;<code>Eden</code>&#x3001;<code>From Survivor</code>&#xFF0C;<code>To Survivor</code>&#x7B49;&#x3002;&#x65E0;&#x8BBA;&#x600E;&#x4E48;&#x5212;&#x5206;&#xFF0C;&#x6700;&#x7EC8;&#x5B58;&#x50A8;&#x7684;&#x90FD;&#x662F;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x5212;&#x5206;&#x7684;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x56DE;&#x6536;&#x5185;&#x5B58;&#xFF0C; &#x6216;&#x8005;&#x66F4;&#x5FEB;&#x7684;&#x5206;&#x914D;&#x5185;&#x5B58;&#x3002;</li>
<li>Java&#x5806;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x53EF;&#x6269;&#x5C55;&#x7684;&#xFF0C;&#x901A;&#x8FC7;<code>-Xms</code>&#x548C;<code>-Xmx</code>&#x63A7;&#x5236;&#x3002;</li>
<li>&#x5982;&#x679C;&#x5806;&#x5185;&#x5B58;&#x4E0D;&#x591F;&#x5206;&#x914D;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x4E5F;&#x65E0;&#x6CD5;&#x5728;&#x6269;&#x5C55;&#x65F6;&#xFF0C;&#x5C06;&#x4F1A;&#x629B;&#x51FA;OutOfMemoryError&#x5F02;&#x5E38;&#x3002;</li>
</ol>
<h2 id="&#x5806;&#x533A;&#x57DF;&#x4E0E;&#x5206;&#x4EE3;">&#x5806;&#x533A;&#x57DF;&#x4E0E;&#x5206;&#x4EE3;</h2>
<ul>
<li>&#x5806;&#x5927;&#x5C0F; = &#x65B0;&#x751F;&#x4EE3; + &#x8001;&#x5E74;&#x4EE3;&#xFF08;&#x9ED8;&#x8BA4;&#xFF1A;&#x65B0;&#x751F;&#x4EE3;:&#x8001;&#x5E74;&#x4EE3;=<code>1:2</code>&#xFF0C;&#x5373;<code>1/3</code>&#x7684;&#x65B0;&#x751F;&#x4EE3;&#xFF0C;<code>2/3</code>&#x7684;&#x8001;&#x5E74;&#x4EE3;&#xFF09;&#x3002;&#x5806;&#x5927;&#x5C0F;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#xFF1A;<code>&#x2013;Xms</code>&#xFF08;&#x5806;&#x7684;&#x521D;&#x59CB;&#x5BB9;&#x91CF;&#xFF09;&#x3001;<code>-Xmx</code>&#xFF08;&#x5806;&#x7684;&#x6700;&#x5927;&#x5BB9;&#x91CF;&#xFF09;</li>
<li>&#x5176;&#x4E2D;&#xFF0C;&#x65B0;&#x751F;&#x4EE3; (<code>Young</code>) &#x88AB;&#x7EC6;&#x5206;&#x4E3A;<code>Eden</code>&#x548C;&#x4E24;&#x4E2A;<code>Survivor</code>&#x533A;&#x57DF;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;<code>Survivor</code>&#x533A;&#x57DF;&#x5206;&#x522B;&#x88AB;&#x547D;&#x540D;&#x4E3A;<code>from</code>&#x548C;<code>to</code>&#xFF0C;&#x4EE5;&#x793A;&#x533A;&#x5206;&#x3002;&#x9ED8;&#x8BA4;&#x7684;&#xFF0C;<code>Edem : from : to = 8 : 1 : 1</code>&#x3002;(&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53C2;&#x6570;<code>&#x2013;XX:SurvivorRatio</code>&#x6765;&#x8BBE;&#x5B9A; &#x3002;&#x5373;&#xFF1A; Eden = 8/10 &#x7684;&#x65B0;&#x751F;&#x4EE3;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#xFF0C;from = to = 1/10 &#x7684;&#x65B0;&#x751F;&#x4EE3;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x3002;</li>
<li>JVM &#x6BCF;&#x6B21;&#x53EA;&#x4F1A;&#x4F7F;&#x7528;<code>Eden</code>&#x548C;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x5757;<code>Survivor</code>&#x533A;&#x57DF;&#x6765;&#x4E3A;&#x5BF9;&#x8C61;&#x670D;&#x52A1;&#xFF0C;&#x6240;&#x4EE5;&#x65E0;&#x8BBA;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#xFF0C;&#x603B;&#x662F;&#x6709;&#x4E00;&#x5757;<code>Survivor</code>&#x533A;&#x57DF;&#x662F;&#x7A7A;&#x95F2;&#x7740;&#x7684;&#x3002;</li>
<li>&#x65B0;&#x751F;&#x4EE3;&#x5B9E;&#x9645;&#x53EF;&#x7528;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x4E3A; 9/10 ( &#x5373;90% )&#x7684;&#x65B0;&#x751F;&#x4EE3;&#x7A7A;&#x95F4;&#x3002;</li>
</ul>
<p><code>jstat</code>&#x67E5;&#x770B;gc&#x76F8;&#x5173;&#x7684;&#x5806;&#x4FE1;&#x606F;</p>
<h3 id="&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5206;&#x4EE3;&#xFF1F;&#x5206;&#x4EE3;&#x6240;&#x7528;&#x7684;gc&#x7B97;&#x6CD5;&#xFF1F;">&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5206;&#x4EE3;&#xFF1F;&#x5206;&#x4EE3;&#x6240;&#x7528;&#x7684;gc&#x7B97;&#x6CD5;&#xFF1F;</h3>
<ul>
<li>&#x57FA;&#x4E8E;&#x5047;&#x8BBE;&#xFF1A;&#x5927;&#x90E8;&#x5206;&#x7684;&#x5BF9;&#x8C61;(90%&#x5DE6;&#x53F3;)&#x90FD;&#x662F;&#x751F;&#x547D;&#x5468;&#x671F;&#x5F88;&#x77ED;&#x7684;&#xFF0C;&#x5373;&#x5F88;&#x5FEB;&#x4F1A;&#x88AB;&#x56DE;&#x6536;&#x6389;</li>
<li>gc&#x7684;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;&#x4E2D;&#x8981;&quot;Stop-The-World&quot;&#xFF0C;gc&#x90E8;&#x5206;</li>
</ul>
<p>&#x57FA;&#x4E8E;&#x5047;&#x8BBE;&#xFF0C;&#x5982;&#x679C;&#x8BA9;&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x5728;young gen&#x91CC;&#x521B;&#x5EFA;&#xFF0C;&#x7136;&#x540E;&#x9891;&#x7E41;&#x6536;&#x96C6;young gen&#xFF0C;&#x5219;&#x5927;&#x90E8;&#x5206;&#x5783;&#x573E;&#x90FD;&#x80FD;&#x5728;young GC&#x4E2D;&#x88AB;&#x6536;&#x96C6;&#x6389;&#x3002;&#x7531;&#x4E8E;young gen&#x7684;&#x5927;&#x5C0F;&#x914D;&#x7F6E;&#x901A;&#x5E38;<strong>&#x53EA;&#x5360;&#x6574;&#x4E2A;GC&#x5806;&#x7684;&#x8F83;&#x5C0F;&#x90E8;&#x5206;</strong>&#xFF0C;&#x800C;&#x4E14;&#x8F83;&#x9AD8;&#x7684;&#x5BF9;&#x8C61;&#x6B7B;&#x4EA1;&#x7387;&#xFF08;&#x6216;&#x8005;&#x8BF4;&#x8F83;&#x4F4E;&#x7684;&#x5BF9;&#x8C61;&#x5B58;&#x6D3B;&#x7387;&#xFF09;&#x8BA9;&#x5B83;&#x975E;&#x5E38;&#x9002;&#x5408;&#x4F7F;&#x7528;<font color="red">copying&#x7B97;&#x6CD5;</font>&#x6765;&#x6536;&#x96C6;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x4F46;&#x80FD;&#x964D;&#x4F4E;&#x5355;&#x6B21;GC&#x7684;&#x65F6;&#x95F4;&#x957F;&#x5EA6;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;GC&#x7684;&#x5DE5;&#x4F5C;&#x6548;&#x7387;</p>
<p>&#x9488;&#x5BF9;&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;(&#x5360;&#x7528;&#x7A7A;&#x95F4;&#x5927;)&#x7684;&#x7279;&#x70B9;&#xFF0C;&#x4E00;&#x822C;&#x91C7;&#x7528;<code>&#x6807;&#x8BB0;-&#x6E05;&#x7406;</code>&#xFF08;&#x6709;&#x7684;&#x7B97;&#x6CD5;&#x4F1A;&#x5E26;&#x538B;&#x7F29;&#xFF09;&#x7B56;&#x7565;&#x7684;&#x7B97;&#x6CD5;&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x5982;&#x679C;&#x91C7;&#x7528;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x7684;&#x8BDD;&#xFF0C;&#x4E00;&#x65B9;&#x9762;&#x6CA1;&#x6709;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#x7ED9;&#x5176;&#x62C5;&#x4FDD;&#xFF0C;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#x7531;&#x4E8E;&#x5B58;&#x6D3B;&#x7387;&#x9AD8;&#xFF0C;&#x590D;&#x5236;&#x7684;&#x5F00;&#x9500;&#x663E;&#x8457;&#x589E;&#x5927;&#x3002;</p>
<p><img src="imgs/gc1.png" alt=""></p>
<h4 id="jvm-&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x6765;&#x6E90;">JVM &#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x6765;&#x6E90;?</h4>
<ol>
<li><p>&#x65B0;&#x751F;&#x4EE3;&#x5BF9;&#x8C61;&#x6BCF;&#x7ECF;&#x5386;&#x4F9D;&#x6B21;minor gc&#xFF0C;&#x5E74;&#x9F84;&#x4F1A;&#x52A0;&#x4E00;&#xFF0C;&#x5F53;&#x8FBE;&#x5230;&#x5E74;&#x9F84;&#x9600;&#x503C;&#x4F1A;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#x3002;&#x9600;&#x503C;&#x5927;&#x5C0F;&#x4E00;&#x822C;&#x4E3A;15</p>
</li>
<li><p>Survivor&#x7A7A;&#x95F4;&#x4E2D;&#x5E74;&#x9F84;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#x7684;&#x603B;&#x548C;&#x5927;&#x4E8E;survivor&#x7A7A;&#x95F4;&#x7684;&#x4E00;&#x534A;&#xFF0C;&#x5E74;&#x9F84;&#x5927;&#x4E8E;&#x6216;&#x7B49;&#x4E8E;&#x8BE5;&#x5E74;&#x9F84;&#x7684;&#x5BF9;&#x8C61;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x7B49;&#x5230;&#x5E74;&#x9F84;&#x9600;&#x503C;</p>
</li>
<li><p>&#x5927;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</p>
</li>
<li><p>&#x65B0;&#x751F;&#x4EE3;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x9700;&#x8981;&#x4E00;&#x4E2A;survivor&#x533A;&#x8FDB;&#x884C;&#x8F6E;&#x6362;&#x5907;&#x4EFD;&#xFF0C;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x5927;&#x91CF;&#x5BF9;&#x8C61;&#x5728;minor gc&#x540E;&#x4ECD;&#x7136;&#x5B58;&#x6D3B;&#x7684;&#x60C5;&#x51B5;&#x65F6;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x8001;&#x5E74;&#x4EE3;&#x8FDB;&#x884C;&#x5206;&#x914D;&#x62C5;&#x4FDD;&#xFF0C;&#x8BA9;survivor&#x65E0;&#x6CD5;&#x5BB9;&#x7EB3;&#x7684;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</p>
</li>
</ol>
<h2 id="java7-&#x5806;&#x7684;&#x5404;&#x533A;&#x57DF;">Java7 &#x5806;&#x7684;&#x5404;&#x533A;&#x57DF;</h2>
<pre class="language-"><code class="lang-java"><span class="token operator">^</span><span class="token class-name">Cmubi</span><span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token class-name">Home</span> $ pwd
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_80</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span>
mubi<span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token class-name">Home</span> $ bin<span class="token operator">/</span>jstat <span class="token operator">-</span>gcutil <span class="token number">62850</span> <span class="token number">1000</span> <span class="token number">10</span>
<span class="token class-name">Warning</span><span class="token operator">:</span> <span class="token class-name">Unresolved</span> <span class="token class-name">Symbol</span><span class="token operator">:</span> sun<span class="token punctuation">.</span>gc<span class="token punctuation">.</span>generation<span class="token punctuation">.</span><span class="token number">2.</span>space<span class="token punctuation">.</span><span class="token number">0.</span>capacity substituted <span class="token class-name">NaN</span>
<span class="token class-name">Warning</span><span class="token operator">:</span> <span class="token class-name">Unresolved</span> <span class="token class-name">Symbol</span><span class="token operator">:</span> sun<span class="token punctuation">.</span>gc<span class="token punctuation">.</span>generation<span class="token punctuation">.</span><span class="token number">2.</span>space<span class="token punctuation">.</span><span class="token number">0.</span>used substituted <span class="token class-name">NaN</span>
<span class="token class-name">Warning</span><span class="token operator">:</span> <span class="token class-name">Unresolved</span> <span class="token class-name">Symbol</span><span class="token operator">:</span> sun<span class="token punctuation">.</span>gc<span class="token punctuation">.</span>generation<span class="token punctuation">.</span><span class="token number">2.</span>space<span class="token punctuation">.</span><span class="token number">0.</span>capacity substituted <span class="token class-name">NaN</span>
  S0     S1     <span class="token class-name">E</span>      <span class="token class-name">O</span>      <span class="token class-name">P</span>     YGC     YGCT    FGC    FGCT     GCT
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">76.97</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">77.08</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">77.22</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>   <span class="token number">85.81</span>  <span class="token number">77.33</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
</code></pre>
<ul>
<li>E    &#x2014; Heap&#x4E0A;&#x7684; Eden space &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>Eden</code>)</li>
<li>S0   &#x2014; Heap&#x4E0A;&#x7684; Survivor space 0 &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>From</code>)</li>
<li>S1   &#x2014; Heap&#x4E0A;&#x7684; Survivor space 1 &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>To</code>)</li>
<li>O    &#x2014; Heap&#x4E0A;&#x7684; Old space &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>Old</code>)</li>
<li>P    &#x2014; Perm space &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;&#xFF08;<code>Java7&#x4E2D;&#x7684;Perm Generation</code>&#xFF09;</li>
<li>YGC  &#x2014; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6;&#x53D1;&#x751F; Young GC &#x7684;&#x6B21;&#x6570;</li>
<li>YGCT &#x2013; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6; Young GC &#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;(&#x5355;&#x4F4D;&#x79D2;)</li>
<li>FGC  &#x2014; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6;&#x53D1;&#x751F; Full GC &#x7684;&#x6B21;&#x6570;</li>
<li>FGCT &#x2013; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6; Full GC &#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;(&#x5355;&#x4F4D;&#x79D2;)</li>
<li>GCT  &#x2014; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6;&#x7528;&#x4E8E;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x603B;&#x65F6;&#x95F4;(&#x5355;&#x4F4D;&#x79D2;)</li>
</ul>
<p><img src="imgs/java7_heap.png" alt=""></p>
<h3 id="java7&#x6C38;&#x4E45;&#x4EE3;perm-space">Java7&#x6C38;&#x4E45;&#x4EE3;(Perm space)</h3>
<ul>
<li><p>&#x662F;HotSpot&#x7684;&#x4E00;&#x79CD;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#xFF0C;&#x5B9E;&#x9645;&#x6307;&#x7684;&#x5C31;&#x662F;<strong>&#x65B9;&#x6CD5;&#x533A;</strong></p>
</li>
<li><p>&#x7C7B;&#x5305;&#x542B;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x5143;&#x6570;&#x636E;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;&#x6C60;&#x7B49;&#x88AB;&#x5B58;&#x50A8;&#x5728;&#x6C38;&#x4E45;&#x4EE3;&#xFF08;&#x9ED8;&#x8BA4;&#x5927;&#x5C0F;&#x662F;4m&#xFF09;&#x4E2D;&#xFF0C;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x548C;OOM</p>
</li>
<li><p>&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#x7684;&#x5185;&#x5B58;&#x56DE;&#x6536;&#x76EE;&#x6807;&#x4E3B;&#x8981;&#x662F;&#x9488;&#x5BF9;&#x5E38;&#x91CF;&#x6C60;&#x7684;&#x56DE;&#x6536;&#x548C;&#x5BF9;&#x7C7B;&#x578B;&#x7684;&#x5378;&#x8F7D;</p>
</li>
</ul>
<h2 id="java8-&#x5185;&#x5B58;&#x533A;&#x57DF;">Java8 &#x5185;&#x5B58;&#x533A;&#x57DF;</h2>
<p><img src="imgs/java8.jpeg" alt=""></p>
<pre class="language-"><code class="lang-java"><span class="token comment">// java7</span>
mubi<span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token class-name">Home</span> $ pwd
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_80</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span>
mubi<span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token class-name">Home</span> $ bin<span class="token operator">/</span>jstat <span class="token operator">-</span>gcutil <span class="token number">62850</span> <span class="token number">1000</span> <span class="token number">10</span>
<span class="token class-name">Warning</span><span class="token operator">:</span> <span class="token class-name">Unresolved</span> <span class="token class-name">Symbol</span><span class="token operator">:</span> sun<span class="token punctuation">.</span>gc<span class="token punctuation">.</span>generation<span class="token punctuation">.</span><span class="token number">2.</span>space<span class="token punctuation">.</span><span class="token number">0.</span>capacity substituted <span class="token class-name">NaN</span>
<span class="token class-name">Warning</span><span class="token operator">:</span> <span class="token class-name">Unresolved</span> <span class="token class-name">Symbol</span><span class="token operator">:</span> sun<span class="token punctuation">.</span>gc<span class="token punctuation">.</span>generation<span class="token punctuation">.</span><span class="token number">2.</span>space<span class="token punctuation">.</span><span class="token number">0.</span>used substituted <span class="token class-name">NaN</span>
<span class="token class-name">Warning</span><span class="token operator">:</span> <span class="token class-name">Unresolved</span> <span class="token class-name">Symbol</span><span class="token operator">:</span> sun<span class="token punctuation">.</span>gc<span class="token punctuation">.</span>generation<span class="token punctuation">.</span><span class="token number">2.</span>space<span class="token punctuation">.</span><span class="token number">0.</span>capacity substituted <span class="token class-name">NaN</span>
  S0     S1     <span class="token class-name">E</span>      <span class="token class-name">O</span>      <span class="token class-name">P</span>     YGC     YGCT    FGC    FGCT     GCT
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">76.97</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">77.08</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">77.22</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">77.33</span>  <span class="token number">56.33</span>      &#xFFFD;    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>

<span class="token comment">// java 8</span>
<span class="token operator">^</span><span class="token class-name">Cmubi</span><span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token class-name">Home</span> $ jstat <span class="token operator">-</span>gcutil <span class="token number">62850</span> <span class="token number">1000</span> <span class="token number">10</span>
  S0     S1     <span class="token class-name">E</span>      <span class="token class-name">O</span>      <span class="token class-name">M</span>     CCS    YGC     YGCT    FGC    FGCT     GCT
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">78.86</span>  <span class="token number">56.33</span>  <span class="token number">93.46</span>  <span class="token number">89.80</span>    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">78.93</span>  <span class="token number">56.33</span>  <span class="token number">93.46</span>  <span class="token number">89.80</span>    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">79.04</span>  <span class="token number">56.33</span>  <span class="token number">93.46</span>  <span class="token number">89.80</span>    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">79.17</span>  <span class="token number">56.33</span>  <span class="token number">93.46</span>  <span class="token number">89.80</span>    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
  <span class="token number">0.00</span>  <span class="token number">85.81</span>  <span class="token number">79.29</span>  <span class="token number">56.33</span>  <span class="token number">93.46</span>  <span class="token number">89.80</span>    <span class="token number">161</span>    <span class="token number">1.624</span>    <span class="token number">14</span>    <span class="token number">0.603</span>    <span class="token number">2.227</span>
<span class="token operator">^</span><span class="token class-name">Cmubi</span><span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token class-name">Home</span> $
</code></pre>
<ul>
<li>S0   &#x2014; Heap&#x4E0A;&#x7684; Survivor space 0 &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>From</code>)</li>
<li>S1   &#x2014; Heap&#x4E0A;&#x7684; Survivor space 1 &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>To</code>)</li>
<li>E    &#x2014; Heap&#x4E0A;&#x7684; Eden space &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>Eden</code>)</li>
<li>O    &#x2014; Heap&#x4E0A;&#x7684; Old space &#x533A;&#x5DF2;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x7684;&#x767E;&#x5206;&#x6BD4;(<code>Old</code>)</li>
<li>M    - &#x5143;&#x7A7A;&#x95F4;&#xFF08;Metaspace&#xFF09;&#xFF1A; Klass Metaspace, NoKlass Metaspace</li>
<li>CCS  - &#x8868;&#x793A;&#x7684;&#x662F;NoKlass Metaspace&#x7684;&#x4F7F;&#x7528;&#x7387;</li>
<li>YGC  &#x2014; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6;&#x53D1;&#x751F; Young GC &#x7684;&#x6B21;&#x6570;</li>
<li>YGCT &#x2013; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6; Young GC &#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;(&#x5355;&#x4F4D;&#x79D2;)</li>
<li>FGC  &#x2014; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6;&#x53D1;&#x751F; Full GC &#x7684;&#x6B21;&#x6570;</li>
<li>FGCT &#x2013; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6; Full GC &#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;(&#x5355;&#x4F4D;&#x79D2;)</li>
<li>GCT  &#x2014; &#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x5230;&#x91C7;&#x6837;&#x65F6;&#x7528;&#x4E8E;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x603B;&#x65F6;&#x95F4;(&#x5355;&#x4F4D;&#x79D2;)</li>
</ul>
<h3 id="java8&#x5143;&#x7A7A;&#x95F4;&#x5143;&#x6570;&#x636E;&#x533A;">Java8&#x5143;&#x7A7A;&#x95F4;(&#x5143;&#x6570;&#x636E;&#x533A;)</h3>
<p>&#x53C2;&#x8003;&#x5B66;&#x4E60;1: <a target="_blank" href="http://openjdk.java.net/jeps/122">openjdk&#x76F8;&#x5173;&#x6587;&#x6863;</a></p>
<p>Class metadata, interned Strings and class static variables will be moved from the permanent generation to either the Java heap or native memory.
(&#x539F;&#x6765;&#x7684;&#x6C38;&#x4E45;&#x4EE3;(class&#x5143;&#x4FE1;&#x606F;&#x3001;&#x5B57;&#x9762;&#x5E38;&#x91CF;&#x3001;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x7B49;)&#x8F6C;&#x79FB;&#x5230;heap&#x6216;&#x8005;native memory&#x4E2D;)</p>
<p><strong>Metaspace</strong>&#x7531;&#x4E24;&#x5927;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF1A;Klass Metaspace&#x548C;NoKlass Metaspace&#x3002;</p>
<ol>
<li>klass Metaspace&#x5C31;&#x662F;&#x7528;&#x6765;&#x5B58;klass&#x7684;&#xFF0C;&#x5373;class&#x6587;&#x4EF6;&#x5728;jvm&#x91CC;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x662F;&#x4E00;&#x5757;&#x8FDE;&#x7EED;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;&#x7D27;&#x63A5;&#x7740;Heap</li>
<li>NoKlass Metaspace&#x4E13;&#x95E8;&#x6765;&#x5B58;klass&#x76F8;&#x5173;&#x7684;&#x5176;&#x5B83;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6BD4;&#x5982;method&#xFF0C;ConstantPool&#x7B49;&#xFF0C;&#x53EF;&#x4EE5;&#x7531;&#x591A;&#x5757;&#x4E0D;&#x8FDE;&#x7EED;&#x7684;&#x5185;&#x5B58;&#x7EC4;&#x6210;</li>
</ol>
<h1 id="&#x5783;&#x573E;&#x6536;&#x96C6;">&#x5783;&#x573E;&#x6536;&#x96C6;</h1>
<p><img src="imgs/gc_mem.jpeg" alt=""></p>
<p>GC &#x4E3B;&#x8981;&#x5DE5;&#x4F5C;&#x5728; Heap &#x533A;&#x548C; MetaSpace &#x533A;&#xFF08;&#x4E0A;&#x56FE;&#x84DD;&#x8272;&#x90E8;&#x5206;&#xFF09;&#xFF0C;&#x5728; Direct Memory &#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7684;&#x662F; DirectByteBuffer&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5206;&#x914D;&#x5185;&#x5B58;&#x4E0D;&#x591F;&#x65F6;&#x5219;&#x662F; GC &#x901A;&#x8FC7; Cleaner#clean &#x95F4;&#x63A5;&#x7BA1;&#x7406;</p>
<p>&#x8F6C;&#x81EA;&#xFF1A;<a href="https://blog.csdn.net/MeituanTech/article/details/109664525" target="_blank">Java&#x4E2D;9&#x79CD;&#x5E38;&#x89C1;&#x7684;CMS GC&#x95EE;&#x9898;&#x5206;&#x6790;&#x4E0E;&#x89E3;&#x51B3;
</a></p>
<h2 id="&#x4E09;&#x4E2A;&#x95EE;&#x9898;">&#x4E09;&#x4E2A;&#x95EE;&#x9898;</h2>
<ol>
<li><p>&#x54EA;&#x4E9B;&#x5185;&#x5B58;&#x9700;&#x8981;&#x56DE;&#x6536;</p>
</li>
<li><p>&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x8FDB;&#x884C;&#x56DE;&#x6536;</p>
</li>
<li><p>&#x5982;&#x4F55;&#x56DE;&#x6536;</p>
</li>
</ol>
<h2 id="&#x901A;&#x8FC7;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x6765;&#x5224;&#x5B9A;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5B58;&#x6D3B;&#x4EC0;&#x4E48;&#x662F;&#x5783;&#x573E;">&#x901A;&#x8FC7;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x6765;&#x5224;&#x5B9A;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5B58;&#x6D3B;(&#x4EC0;&#x4E48;&#x662F;&#x5783;&#x573E;?)</h2>
<p>&#x7B97;&#x6CD5;&#x7684;&#x57FA;&#x672C;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x79F0;&#x4E3A;<code>GC Roots</code>&#x7684;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x8D77;&#x59CB;&#x70B9;&#xFF0C;&#x4ECE;&#x8FD9;&#x4E9B;&#x8282;&#x70B9;&#x5411;&#x4E0B;&#x641C;&#x7D22;&#xFF0C;&#x641C;&#x7D22;&#x6240;&#x8D70;&#x8FC7;&#x7684;&#x8DEF;&#x5F84;&#x79F0;&#x4E3A;<code>&#x5F15;&#x7528;&#x94FE;(Reference Chain)</code>,&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5230;<code>GC Roots</code>&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F15;&#x7528;&#x94FE;&#x76F8;&#x8FDE;(&#x7528;&#x56FE;&#x8BBA;&#x7684;&#x8BDD;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;<code>GC Roots</code>&#x5230;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0D;&#x53EF;&#x8FBE;)&#x65F6;&#xFF0C;&#x5219;&#x8BC1;&#x660E;&#x6B64;&#x5BF9;&#x8C61;&#x662F;&#x4E0D;&#x53EF;&#x7528;&#x7684;&#x3002;</p>
<p><img src="imgs/gc_roots.png" alt=""></p>
<h3 id="java&#x4E2D;&#x53EF;&#x4F5C;&#x4E3A;gc-roots&#x7684;&#x5BF9;&#x8C61;&#x5305;&#x62EC;">Java&#x4E2D;&#x53EF;&#x4F5C;&#x4E3A;(GC Roots)&#x7684;&#x5BF9;&#x8C61;&#x5305;&#x62EC;</h3>
<p>JVM stack, native method stack, run-time constant pool, static references in method area, Clazz</p>
<ul>
<li>&#x865A;&#x62DF;&#x673A;&#x6808;&#xFF08;&#x6808;&#x5E27;&#x4E2D;&#x7684;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x8868;&#xFF09;&#x4E2D;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x4E2D;JNI(&#x5373;&#x4E00;&#x822C;&#x8BF4;&#x7684;Native&#x65B9;&#x6CD5;)&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x65B9;&#x6CD5;&#x533A;&#x4E2D;&#x5E38;&#x91CF;&#x6C60;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x65B9;&#x6CD5;&#x533A;&#x4E2D;&#x7684;&#x7C7B;&#x9759;&#x6001;&#x5C5E;&#x6027;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x52A0;&#x8F7D;&#x7684;Clazz</li>
</ul>
<p><a href="https://www.dynatrace.com/resources/ebooks/javabook/how-garbage-collection-works/" target="_blank">&#x53C2;&#x8003;&#x5B66;&#x4E60;&#x6587;&#x7AE0;&#x94FE;&#x63A5;</a></p>
<h2 id="4&#x79CD;&#x5F15;&#x7528;reference">4&#x79CD;&#x5F15;&#x7528;(Reference)</h2>
<p>&#x53C2;&#x8003;&#xFF1A;<a href="https://www.geeksforgeeks.org/types-references-java/" target="_blank">types-references-java</a></p>
<p><img src="imgs/reference.png" alt=""></p>
<h3 id="&#x5F3A;&#x5F15;&#x7528;">&#x5F3A;&#x5F15;&#x7528;</h3>
<p>&#x4F7F;&#x7528;&#x6700;&#x666E;&#x904D;&#x7684;&#x5F15;&#x7528;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5177;&#x6709;&#x5F3A;&#x5F15;&#x7528;&#xFF0C;&#x90A3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x7EDD;&#x4E0D;&#x4F1A;&#x56DE;&#x6536;&#x5B83;&#x3002;&#x5982;</p>
<pre class="language-"><code class="lang-java"><span class="token comment">//Strong Reference - by default</span>
<span class="token class-name">Gfg</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gfg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Now, object to which &apos;g&apos; was pointing earlier is  </span>
<span class="token comment">//eligible for garbage collection.</span>
g <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>&#x5F3A;&#x5F15;&#x7528;&#x4E0E;GC</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">M</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;finalize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* &#x5F3A;&#x5F15;&#x7528;&#xFF0C;&#x5F3A;&#x5236;gc
* &#x8F93;&#x51FA;&#x5982;&#x4E0B;
* Main$M@736e9adb
* null
* finalize
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">M</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">M</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x8F6F;&#x5F15;&#x7528;softreference">&#x8F6F;&#x5F15;&#x7528;(SoftReference)</h3>
<p>In Soft reference, even if the object is free for garbage collection then also its not garbage collected, until JVM is in need of memory badly.The objects gets cleared from the memory when JVM runs out of memory.To create such references java.lang.ref.SoftReference class is used.(<font color="red">JVM &#x5185;&#x5B58;&#x7D27;&#x5F20;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x56DE;&#x6536;&#x8F6F;&#x5F15;&#x7528;&#x5BF9;&#x8C61;</font>)</p>
<p>&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x4E00;&#x4E9B;&#x8FD8;&#x6709;&#x7528;&#x4F46;&#x5E76;&#x975E;&#x5FC5;&#x9700;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5BF9;&#x4E8E;&#x8F6F;&#x5F15;&#x7528;&#x5173;&#x8054;&#x8005;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x7CFB;&#x7EDF;&#x5C06;&#x8981;&#x53D1;&#x751F;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x4E4B;&#x524D;&#xFF0C;&#x5C06;&#x4F1A;&#x628A;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x5217;&#x8FDB;&#x56DE;&#x6536;&#x8303;&#x56F4;&#x4E4B;&#x4E2D;&#x8FDB;&#x884C;&#x7B2C;&#x4E8C;&#x6B21;&#x56DE;&#x6536;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x6B21;&#x56DE;&#x6536;&#x8FD8;&#x6CA1;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x624D;&#x4F1A;&#x629B;&#x51FA;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x3002;</p>
<pre class="language-"><code class="lang-java"><span class="token comment">//Code to illustrate Soft reference</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref</span><span class="token punctuation">.</span><span class="token class-name">SoftReference</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Gfg</span>
<span class="token punctuation">{</span>
    <span class="token comment">//code..</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;GeeksforGeeks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Example</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Strong Reference</span>
        <span class="token class-name">Gfg</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gfg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        g<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Creating Soft Reference to Gfg-type object to which &apos;g&apos;</span>
        <span class="token comment">// is also pointing.</span>
        <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gfg</span><span class="token punctuation">&gt;</span></span> softref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gfg</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Now, Gfg-type object to which &apos;g&apos; was pointing</span>
        <span class="token comment">// earlier is available for garbage collection.</span>
        g <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  

        <span class="token comment">// You can retrieve back the object which</span>
        <span class="token comment">// has been weakly referenced.</span>
        <span class="token comment">// It successfully calls the method.</span>
        g <span class="token operator">=</span> softref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

        g<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>&#x8F6F;&#x5F15;&#x7528;&#x4E0E;GC</li>
</ul>
<pre class="language-"><code class="lang-java"> <span class="token comment">/**
    * &#x5185;&#x5B58;&#x4E0D;&#x591F;&#x7528;&#x4E86;&#xFF0C;&#x8F6F;&#x5F15;&#x7528;&#x624D;&#x88AB;&#x56DE;&#x6536;
    * &#x8F93;&#x51FA;&#x5982;&#x4E0B;
    * [B@736e9adb
    * [B@736e9adb
    * [B@6d21714c
    * null
    */</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testSoftReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
    <span class="token class-name">SoftReference</span><span class="token operator">&lt;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> mSoft <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>mSoft<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// gc&#x6CA1;&#x6709;&#x56DE;&#x6536;&#x8F6F;&#x5F15;&#x7528;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>mSoft<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">11</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x7531;&#x4E8E;&#x5F3A;&#x5F15;&#x7528;&#x7533;&#x8BF7;&#x7A7A;&#x95F4;&#x4E0D;&#x591F;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x6E05;&#x9664;&#x8F6F;&#x5F15;&#x7528;&#x4E86;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>mSoft<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x5F31;&#x5F15;&#x7528;weakreference">&#x5F31;&#x5F15;&#x7528;(WeakReference)</h3>
<pre class="language-"><code class="lang-java"><span class="token comment">// Strong Reference</span>
<span class="token class-name">Gfg</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gfg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Creating Weak Reference to Gfg-type object to which &apos;g&apos;  </span>
<span class="token comment">// is also pointing.</span>
<span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gfg</span><span class="token punctuation">&gt;</span></span> weakref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gfg</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Now, Gfg-type object to which &apos;g&apos; was pointing earlier</span>
<span class="token comment">//is available for garbage collection.</span>
<span class="token comment">//But, it will be garbage collected only when JVM needs memory.</span>
g <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  

<span class="token comment">// You can retrieve back the object which</span>
<span class="token comment">// has been weakly referenced.</span>
<span class="token comment">// It successfully calls the method.</span>
g <span class="token operator">=</span> weakref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

g<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>This type of reference is used in WeakHashMap to reference the entry objects .</li>
<li>If JVM detects an object with only weak references (i.e. no strong or soft references linked to any object object), this object will be marked for garbage collection.</li>
<li>To create such references java.lang.ref.WeakReference class is used.</li>
<li><p>These references are used in real time applications while establishing a DBConnection which might be cleaned up by Garbage Collector when the application using the database gets closed.</p>
</li>
<li><p>&#x5F31;&#x5F15;&#x7528;&#x4E0E;GC</p>
</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token comment">/**
    * &#x53EA;&#x8981;&#x6709;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#xFF0C;&#x5F31;&#x5F15;&#x7528;&#x76F4;&#x63A5;&#x4F1A;&#x88AB;&#x56DE;&#x6536;
    * &#x8F93;&#x51FA;&#x5982;&#x4E0B;&#xFF1A;
    * Main$M@736e9adb
    * null
    * finalize
    */</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testWeakReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">M</span><span class="token punctuation">&gt;</span></span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">M</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x865A;&#x5F15;&#x7528;phantomreference">&#x865A;&#x5F15;&#x7528;(PhantomReference)</h3>
<p>The objects which are being referenced by phantom references are eligible for garbage collection. But, before removing them from the memory, JVM puts them in a queue called &#x2018;reference queue&#x2019; . They are put in a reference queue after calling finalize() method on them.To create such references java.lang.ref.PhantomReference class is used.</p>
<p>&#x4E5F;&#x79F0;&#x4E3A;&#x5E7D;&#x7075;&#x5F15;&#x7528;&#x6216;&#x8005;&#x5E7B;&#x5F71;&#x5F15;&#x7528;&#xFF0C;&#x5B83;&#x662F;&#x6700;&#x5F31;&#x7684;&#x4E00;&#x79CD;&#x5F15;&#x7528;&#x5173;&#x7CFB;&#x3002;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x6709;&#x865A;&#x5F15;&#x7528;&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x5B8C;&#x5168;&#x4E0D;&#x4F1A;&#x5BF9;&#x5176;&#x751F;&#x5B58;&#x65F6;&#x95F4;&#x6784;&#x6210;&#x5F71;&#x54CD;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x865A;&#x5F15;&#x7528;&#x6765;&#x53D6;&#x5F97;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x865A;&#x5F15;&#x7528;&#x5173;&#x8054;&#x7684;&#x552F;&#x4E00;&#x76EE;&#x7684;&#x5C31;&#x662F;<font color="red">&#x80FD;&#x591F;&#x5728;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x6536;&#x96C6;&#x5668;&#x56DE;&#x6536;&#x65F6;&#x6536;&#x5230;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x901A;&#x77E5;&#x3002;</font></p>
<ul>
<li>&#x5B83;&#x7684;get()&#x65B9;&#x6CD5;&#x5199;&#x6B7B;&#x4E86;&#xFF0C;&#x8FD4;&#x56DE;null&#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x8DDF;&#x524D;&#x9762;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x4E0D;&#x80FD;&#x901A;&#x8FC7;get()&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x88AB;&#x5305;&#x88C5;&#x7684;&#x5BF9;&#x8C61;&#xFF09;</li>
<li><p>Java&#x4E2D;&#x865A;&#x5E7B;&#x5F15;&#x7528;&#x4F5C;&#x7528;&#xFF1A;&#x7BA1;&#x7406;&#x76F4;&#x63A5;&#x5185;&#x5B58;(&#x4E0D;&#x5C5E;&#x4E8E;&#x5806;)</p>
</li>
<li><p>&#x865A;&#x5F15;&#x7528;&#x4E0E;GC</p>
</li>
<li><p>&#x865A;&#x5F15;&#x7528;get&#x4E0D;&#x5230;,&#x56E0;&#x4E3A;get&#x65B9;&#x6CD5;&#x662F;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7684;null</p>
</li>
<li>&#x865A;&#x5F15;&#x7528;&#x653E;&#x5230;&#x961F;&#x5217;(<code>java.lang.ref.ReferenceQueue</code>)&#x4E2D;&#xFF0C;&#x4E0D;&#x65AD;&#x7684;&#x4ECE;&#x961F;&#x5217;&#x4E2D;&#x53D6;&#x51FA;&#x6765;&#x770B;&#x662F;&#x5426;&#x88AB;&#x56DE;&#x6536;&#x4E86;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> LIST <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ReferenceQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">M</span><span class="token punctuation">&gt;</span></span> QUEUE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>

    <span class="token class-name">PhantomReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">M</span><span class="token punctuation">&gt;</span></span> phantomReference <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhantomReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">M</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> QUEUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            LIST<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span><span class="token punctuation">{</span>
                <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>

            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>phantomReference<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">Reference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">M</span><span class="token punctuation">&gt;</span></span> poll <span class="token operator">=</span> QUEUE<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>poll <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PhantomReference &#x88AB; jvm &#x56DE;&#x6536;&#x4E86;:&quot;</span> <span class="token operator">+</span> poll<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x7BA1;&#x7406;&#x5806;&#x5916;&#x5185;&#x5B58;&#xFF1A;</p>
<ol>
<li>jvm&#x5BF9;&#x8C61;&#x7528;&#x865A;&#x5F15;&#x7528;&#xFF0C;&#x6307;&#x5411;&#x5806;&#x5916;&#x5185;&#x5B58;&#xFF0C;&#x865A;&#x5F15;&#x7528;<strong>&#x5FC5;&#x987B;&#x548C;&#x5F15;&#x7528;&#x961F;&#x5217;&#x5173;&#x8054;&#x4F7F;&#x7528;</strong></li>
<li>&#x5F53;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x51C6;&#x5907;&#x56DE;&#x6536;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x5B83;&#x8FD8;&#x6709;&#x865A;&#x5F15;&#x7528;&#xFF0C;&#x5C31;&#x4F1A;&#x628A;&#x8FD9;&#x4E2A;&#x865A;&#x5F15;&#x7528;&#x52A0;&#x5165;&#x5230;&#x4E0E;&#x4E4B; &#x5173;&#x8054;&#x7684;&#x5F15;&#x7528;&#x961F;&#x5217;&#x4E2D;&#x3002;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x5F15;&#x7528;&#x961F;&#x5217;&#x4E2D;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x52A0;&#x5165;&#x4E86;&#x865A;&#x5F15;&#x7528;&#xFF0C;&#x6765;&#x4E86;&#x89E3;&#x88AB;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5C06;&#x8981;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF1B;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x53D1;&#x73B0;&#x67D0;&#x4E2A;&#x865A;&#x5F15;&#x7528;&#x5DF2;&#x7ECF;&#x88AB;&#x52A0;&#x5165;&#x5230;&#x5F15;&#x7528;&#x961F;&#x5217;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6240;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5185;&#x5B58;&#x88AB;&#x56DE;&#x6536;&#x4E4B;&#x524D;&#x91C7;&#x53D6;&#x5FC5;&#x8981;&#x7684;&#x884C;&#x52A8;</li>
</ol>
<h2 id="&#x5BF9;&#x8C61;&#x662F;&#x751F;&#x5B58;&#x8FD8;&#x662F;&#x6B7B;&#x4EA1;&#x7684;&#xFF1F;">&#x5BF9;&#x8C61;&#x662F;&#x751F;&#x5B58;&#x8FD8;&#x662F;&#x6B7B;&#x4EA1;&#x7684;&#xFF1F;</h2>
<h3 id="&#x4E24;&#x6B21;&#x6807;&#x8BB0;--f-queue--finalizer&#x7EBF;&#x7A0B;">&#x4E24;&#x6B21;&#x6807;&#x8BB0; &amp; F-Queue &amp; Finalizer&#x7EBF;&#x7A0B;</h3>
<pre class="language-"><code class="lang-java"><span class="token operator">=</span>&#x300B;&#x6CA1;&#x6709;GC <span class="token class-name">Roots</span>&#x7684;&#x5F15;&#x7528;&#x94FE; <span class="token operator">=</span>&#x300B; &#x5224;&#x65AD;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x6709;&#x5FC5;&#x8981;&#x6267;&#x884C; <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> &#x65B9;&#x6CD5;
</code></pre>
<p><strong>&#x7B2C;&#x4E00;&#x6B21;</strong>&#xFF1A;&#x901A;&#x8FC7;GC roots&#x904D;&#x5386;&#xFF0C;&#x627E;&#x5230;&#x4E0D;&#x5728;&#x5F15;&#x7528;&#x94FE;&#x5185;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x9700;&#x8981;&#x6267;&#x884C;finalize()&#x65B9;&#x6CD5;&#x3002;&#xFF08;&#x5982;&#x679C;&#x6CA1;&#x91CD;&#x5199;finalize()&#x5219;&#x53EA;&#x9700;&#x8981;&#x6807;&#x8BB0;&#x4E00;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5;gc&#x6389;&#xFF09;</p>
<p>&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x6807;&#x8BB0;&#x4E2D;&#x6709;<code>finalize()</code>&#x9700;&#x8981;&#x88AB;&#x6267;&#x884C;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4F1A;&#x88AB;&#x4E22;&#x5230;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x8F83;&#x4F4E;&#x7684;&#x961F;&#x5217;(<code>F-Queue</code>:<code>java.lang.ref.Finalizer.ReferenceQueue</code>)&#x4E2D;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x4E0D;&#x4FDD;&#x8BC1;&#x80FD;&#x88AB;&#x6267;&#x884C;(&#x56E0;&#x4E3A;&#x662F;&#x7531;<strong>&#x4F4E;&#x4F18;&#x5148;&#x7EA7;</strong>&#x7684;<code>Finalizer&#x7EBF;&#x7A0B;</code>&#x53BB;&#x5904;&#x7406;&#x7684;&#xFF0C;&#x8BD5;&#x60F3;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#x7EBF;&#x7A0B;&#x4E0D;&#x88AB;&#x6267;&#x884C;&#x5230;&#xFF0C;&#x90A3;&#x4E48;&#x91CD;&#x5199;&#x4E86;<code>finalize()</code>&#x7684;&#x5BF9;&#x8C61;&#x5C31;&#x6C38;&#x4E45;&#x5728;&#x5806;&#x4E2D;&#x4E0D;&#x80FD;&#x88AB;gc&#x6389;&#xFF0C;&#x5373;<code>java.lang.ref.Finalizer</code>&#x5BF9;&#x8C61;&#x4F1A;&#x5360;&#x7528;&#x5F88;&#x5927;&#x7684;&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x751A;&#x81F3;&#x6EA2;&#x51FA;)</p>
<p><strong>&#x7B2C;&#x4E8C;&#x6B21;</strong>&#xFF1A;&#x5BF9;&#x961F;&#x5217;(<code>F-Queue</code>)&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x518D;&#x904D;&#x5386;&#x4E00;&#x6B21;&#xFF0C;&#x770B;&#x662F;&#x5426;&#x6709;&#x81EA;&#x6551;&#xFF0C;&#x6CA1;&#x6709;&#x5219;&#x8FDB;&#x884C;GC</p>
<ol>
<li>&#x5BF9;&#x8C61;&#x6CA1;&#x6709;&#x8986;&#x76D6;<code>finalize()</code>&#x65B9;&#x6CD5;&#xFF0C;&#x6216;&#x8005;<code>finalize()</code>&#x65B9;&#x6CD5;&#x5DF2;&#x7ECF;&#x88AB;&#x865A;&#x62DF;&#x673A;&#x8C03;&#x7528;&#x8FC7;,&#x865A;&#x62DF;&#x673A;&#x5C06;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x90FD;&#x89C6;&#x4E3A;&quot;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x6267;&#x884C;&quot;</li>
<li>&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x5224;&#x5B9A;&#x4E3A;&#x6709;&#x5FC5;&#x8981;&#x6267;&#x884C;<code>finalize()</code>&#x65B9;&#x6CD5;,&#x5219;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4F1A;&#x653E;&#x7F6E;&#x5728;&#x4E00;&#x4E2A;&#x53EB;&#x505A;<code>F-Queue</code>&#x7684;&#x961F;&#x5217;&#x4E4B;&#x4E2D;&#xFF0C;&#x5E76;&#x5728;&#x7A0D;&#x540E;&#x7531;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x673A;&#x81EA;&#x52A8;&#x5EFA;&#x7ACB;&#x7684;&#xFF0C;<strong>&#x4F4E;&#x4F18;&#x5148;&#x7EA7;</strong>&#x7684;<code>Finalizer&#x7EBF;&#x7A0B;</code>&#x53BB;&#x6267;&#x884C;&#x5B83;&#x3002;</li>
</ol>
<p>&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x8981;&#x5728;<code>finalize()</code>&#x4E2D;&#x6210;&#x529F;&#x62EF;&#x6551;&#x81EA;&#x5DF1;&#xFF0C;&#x5219;&#x53EA;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x4E0E;&#x5F15;&#x7528;&#x94FE;&#x4E0A;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5EFA;&#x7ACB;&#x5173;&#x8054;&#x5373;&#x53EF;&#xFF0C;GC&#x5BF9;<code>F-Queue</code>&#x4E2D;&#x5BF9;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x7B2C;&#x4E8C;&#x6B21;&#x6807;&#x8BB0;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x5B83;&#x79FB;&#x51FA;&quot;&#x5373;&#x5C06;&#x56DE;&#x6536;&quot;&#x7684;&#x96C6;&#x5408;&#xFF1B;&#x5426;&#x5219;&#x5C31;&#x4F1A;&#x88AB;&#x56DE;&#x6536;</p>
<h3 id="finalize&#x81EA;&#x6551;&#x4EE3;&#x7801;&#x6F14;&#x793A;"><code>finalize()</code>&#x81EA;&#x6551;&#x4EE3;&#x7801;&#x6F14;&#x793A;</h3>
<pre class="language-"><code class="lang-java"><span class="token comment">/**
 * &#x6B64;&#x4EE3;&#x7801;&#x8BF4;&#x660E;&#x5982;&#x4E0B;&#x4E24;&#x70B9;&#xFF1A;
 * 1. &#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x5728;GC&#x65F6;&#x81EA;&#x6211;&#x62EF;&#x6551;
 * 2. &#x8FD9;&#x79CD;&#x81EA;&#x6551;&#x7684;&#x673A;&#x4F1A;&#x53EA;&#x6709;&#x4E00;&#x6B21;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;`finalize()`&#x65B9;&#x6CD5;&#x6700;&#x591A;&#x53EA;&#x4F1A;&#x88AB;&#x7CFB;&#x7EDF;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x4E00;&#x6B21;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FinalizeEscapeGC</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">FinalizeEscapeGC</span> SAVE_HOOK <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">FinalizeEscapeGC</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;yes, i am still alive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;finalize method executed!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FinalizeEscapeGC</span><span class="token punctuation">.</span>SAVE_HOOK <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        SAVE_HOOK <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FinalizeEscapeGC</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x5BF9;&#x8C61;&#x7B2C;&#x4E00;&#x6B21;&#x6210;&#x529F;&#x62EF;&#x6551;&#x81EA;&#x5DF1;</span>
        SAVE_HOOK <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x6267;&#x884C;finalize&#x65B9;&#x6CD5;&#x7684;&#x7EBF;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x5F88;&#x4F4E;&#xFF0C;&#x6682;&#x505C;0.5&#x79D2;&#x7B49;&#x5F85;&#x5B83;&#x6267;&#x884C;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>SAVE_HOOK <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            SAVE_HOOK<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;no, i am dead&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// &#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E0E;&#x4E0A;&#x9762;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x6B21;&#x81EA;&#x6551;&#x5374;&#x5931;&#x8D25;&#x4E86;</span>
        SAVE_HOOK <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>SAVE_HOOK <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            SAVE_HOOK<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;no, i am dead&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>output</li>
</ul>
<pre class="language-"><code class="lang-java">finalize method executed<span class="token operator">!</span>
abc
yes<span class="token punctuation">,</span> i am still alive
no<span class="token punctuation">,</span> i am dead
</code></pre>
<h3 id="&#x6700;&#x540E;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;finalize">&#x6700;&#x540E;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;<code>finalize()</code></h3>
<h2 id="java7&#x65B9;&#x6CD5;&#x533A;&#x6C38;&#x4E45;&#x4EE3;&#x7684;&#x56DE;&#x6536;">Java7&#x65B9;&#x6CD5;&#x533A;(&#x6C38;&#x4E45;&#x4EE3;)&#x7684;&#x56DE;&#x6536;</h2>
<p>&#x5806;&#x4E2D;&#xFF0C;&#x65B0;&#x751F;&#x4EE3;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x5783;&#x573E;&#x6536;&#x96C6;&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x56DE;&#x6536;<code>70%-95%</code>&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x6C38;&#x4E45;&#x4EE3;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x6548;&#x7387;&#x8FDC;&#x4F4E;&#x4E8E;&#x6B64;&#x3002;</p>
<p>&#x6C38;&#x4E45;&#x4EE3;&#x4E3B;&#x8981;&#x56DE;&#x6536;&#x4E24;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#xFF1A;&#x5E9F;&#x5F03;&#x5E38;&#x91CF;&#x548C;&#x65E0;&#x7528;&#x7684;&#x7C7B;&#xFF0C;&#x5224;&#x65AD;&quot;&#x65E0;&#x7528;&#x7684;&#x7C7B;&quot;&#xFF1A;</p>
<ol>
<li>&#x8BE5;&#x7C7B;&#x6240;&#x6709;&#x7684;&#x5B9E;&#x4F8B;&#x90FD;&#x5DF2;&#x7ECF;&#x88AB;&#x56DE;&#x6536;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;Java&#x5806;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x8BE5;&#x7C7B;&#x7684;&#x4EFB;&#x4F55;&#x5B9E;&#x4F8B;</li>
<li>&#x52A0;&#x8F7D;&#x8BE5;&#x7C7B;&#x7684;ClassLoader&#x5DF2;&#x7ECF;&#x88AB;&#x56DE;&#x6536;</li>
<li>&#x8BE5;&#x7C7B;&#x5BF9;&#x5E94;&#x7684;java.lang.Class&#x5BF9;&#x8C61;&#x6CA1;&#x6709;&#x5728;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x88AB;&#x5F15;&#x7528;&#xFF0C;&#x65E0;&#x6CD5;&#x5728;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x8BBF;&#x95EE;&#x8BE5;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;</li>
</ol>
<p>&#x662F;&#x5426;&#x5BF9;&#x7C7B;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#xFF0C;HotSpot&#x865A;&#x62DF;&#x673A;&#x63D0;&#x4F9B;&#x4E86;<code>-Xnoclassgc</code>&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x63A7;&#x5236;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>-verbose:class</code>&#x4EE5;&#x53CA;<code>-XX:+TraceClassLoading</code>,<code>-XX:+TraceClassUnLoading</code>&#x67E5;&#x770B;&#x7C7B;&#x52A0;&#x8F7D;&#x548C;&#x5378;&#x8F7D;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x4E2D;<code>-verbose:class</code>&#x548C;<code>-XX:+TraceClassLoading</code>&#x53EF;&#x4EE5;&#x5728;Product&#x7248;&#x7684;&#x865A;&#x62DF;&#x673A;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;<code>-XX:+TraceClassUnLoading</code>&#x53C2;&#x6570;&#x9700;&#x8981;FastDebug&#x7248;&#x7684;&#x865A;&#x62DF;&#x673A;&#x652F;&#x6301;</p>
<p>&#x5728;&#x5927;&#x91CF;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#xFF0C;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#xFF0C;CGLib&#x7B49;ByteCode&#x6846;&#x67B6;&#xFF0C;&#x52A8;&#x6001;&#x751F;&#x6210;JSP&#x4EE5;&#x53CA;OSGi&#x8FD9;&#x7C7B;&#x9891;&#x7E41;&#x81EA;&#x5B9A;&#x4E49;ClassLoader&#x7684;&#x573A;&#x666F;&#x90FD;&#x9700;&#x8981;&#x865A;&#x62DF;&#x673A;&#x5177;&#x5907;&#x7C7B;&#x5378;&#x8F7D;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4EE5;&#x4FDD;&#x8BC1;&#x6C38;&#x4E45;&#x4EE3;&#x4E0D;&#x4F1A;&#x6EA2;&#x51FA;</p>
<h2 id="hotspot-&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;">HotSpot &#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;</h2>
<p>&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x7684;&quot;&#x4E00;&#x81F4;&#x6027;&quot;&#x5206;&#x6790;&#xFF0C;GC&#x8FDB;&#x884C;&#x65F6;&#x5FC5;&#x987B;&#x505C;&#x987F;&#x6240;&#x6709;Java&#x6267;&#x884C;&#x7EBF;&#x7A0B;(Sun&#x5C06;&#x8FD9;&#x4EF6;&#x4E8B;&#x60C5;&#x79F0;&#x4E3A;<code>Stop The World</code>)</p>
<p>&#x865A;&#x62DF;&#x673A;&#x6709;&#x529E;&#x6CD5;&#x76F4;&#x63A5;&#x5F97;&#x77E5;&#x54EA;&#x4E9B;&#x5730;&#x65B9;&#x5B58;&#x653E;&#x7740;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF0C;HotSpot&#x4E2D;&#x4F7F;&#x7528;&#x4E00;&#x7EC4;&#x79F0;&#x4E3A;<code>OopMap</code>&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6765;&#x8FBE;&#x5230;&#x8FD9;&#x4E2A;&#x76EE;&#x7684;&#xFF1A;&#x5728;&#x7C7B;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x7684;&#x65F6;&#x5019;&#xFF0C;HotPot&#x5C31;&#x628A;&#x5BF9;&#x8C61;&#x5185;&#x4EC0;&#x4E48;&#x504F;&#x79FB;&#x91CF;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x636E;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#xFF0C;&#x5728;JIT&#x7F16;&#x8BD1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E5F;&#x4F1A;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x4F4D;&#x7F6E;&#x8BB0;&#x5F55;&#x4E0B;&#x6808;&#x548C;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x54EA;&#x4E9B;&#x4F4D;&#x7F6E;&#x662F;&#x5F15;&#x7528;&#x3002;&#x8FD9;&#x6837;&#xFF0C;GC&#x5728;&#x626B;&#x63CF;&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5F97;&#x77E5;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x4E86;&#x3002;</p>
<p>&#x501F;&#x52A9;<code>OopMap</code>&#xFF0C;HotSpot&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x4E14;&#x51C6;&#x786E;&#x5730;&#x5B8C;&#x6210;GC Roots&#x679A;&#x4E3E;&#xFF0C;&#x95EE;&#x9898;&#xFF1A;</p>
<ul>
<li>&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x5F15;&#x7528;&#x5173;&#x7CFB;&#x53D8;&#x5316;&#xFF0C;&#x6216;&#x8005;&#x8BF4;OopMap&#x5185;&#x5BB9;&#x53D8;&#x5316;&#x7684;&#x6307;&#x4EE4;&#x7279;&#x522B;&#x591A;&#xFF0C;&#x5982;&#x679C;&#x4E3A;&#x6BCF;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x90FD;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684;OopMap&#xFF0C;&#x90A3;&#x5C06;&#x4F1A;&#x9700;&#x8981;&#x5927;&#x91CF;&#x7684;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#xFF0C;&#x8FD9;&#x6837;GC&#x7684;&#x7A7A;&#x95F4;&#x6210;&#x672C;&#x5C06;&#x4F1A;&#x53D8;&#x5F97;&#x5F88;&#x9AD8;</li>
</ul>
<p>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;HotSpot&#x6CA1;&#x6709;&#x4E3A;&#x6BCF;&#x6761;&#x6307;&#x4EE4;&#x90FD;&#x751F;&#x6210;<code>oopMap</code>, &#x5B89;&#x5168;&#x70B9;(<code>Sagepoint</code>) GC&#xFF0C; &#x9009;&#x4E3E;&#x4EE5;&quot;&#x662F;&#x5426;&#x5177;&#x6709;&#x8BA9;&#x7A0B;&#x5E8F;&#x957F;&#x65F6;&#x95F4;&#x6267;&#x884C;&#x7684;&#x7279;&#x5F81;&quot;&#x4E3A;&#x6807;&#x51C6;&#x8FDB;&#x884C;&#x9009;&#x5B9A;&#xFF0C;&#x5982;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;&#x5FAA;&#x73AF;&#x8DF3;&#x8F6C;&#xFF0C;&#x5F02;&#x5E38;&#x8DF3;&#x8F6C;&#x7B49;&#xFF0C;&#x8FD9;&#x4E9B;&#x529F;&#x80FD;&#x7684;&#x6307;&#x4EE4;&#x4F1A;&#x4EA7;&#x751F;&#x5B89;&#x5168;&#x70B9;</p>
<h3 id="stop-the-world">Stop The World</h3>
<p><a href="https://www.cubrid.org/blog/understanding-java-garbage-collection" target="_blank">&#x53C2;&#x8003;&#x6587;&#x7AE0;</a></p>
<pre class="language-"><code class="lang-java"><span class="token class-name">There</span> is a term that you should know before learning about GC<span class="token punctuation">.</span> <span class="token class-name">The</span> term is <span class="token string">&quot;stop-the-world.&quot;</span> <span class="token class-name">Stop</span><span class="token operator">-</span>the<span class="token operator">-</span>world will occur no matter which GC algorithm you choose<span class="token punctuation">.</span> <span class="token class-name">Stop</span><span class="token operator">-</span>the<span class="token operator">-</span>world means that the JVM is stopping the application from running <span class="token keyword">to</span> execute a GC<span class="token punctuation">.</span> <span class="token class-name">When</span> stop<span class="token operator">-</span>the<span class="token operator">-</span>world occurs<span class="token punctuation">,</span> every thread except <span class="token keyword">for</span> the threads needed <span class="token keyword">for</span> the GC will stop their tasks<span class="token punctuation">.</span> <span class="token class-name">The</span> interrupted tasks will resume only after the GC task has completed<span class="token punctuation">.</span> GC tuning often means reducing <span class="token keyword">this</span> stop<span class="token operator">-</span>the<span class="token operator">-</span>world time<span class="token punctuation">.</span>
</code></pre>
<p>&#x53EA;&#x6709;GC&#x7EBF;&#x7A0B;&#x5DE5;&#x4F5C;&#xFF0C;&#x5176;&#x5B83;&#x7EBF;&#x7A0B;&#x90FD;&#x505C;&#x6B62;&#xFF1B;&#x5F53;GC&#x7EBF;&#x7A0B;&#x5DE5;&#x4F5C;&#x5B8C;&#x6210;&#xFF0C;&#x5176;&#x5B83;&#x7EBF;&#x7A0B;&#x6062;&#x590D;</p>
<h1 id="&#x5E38;&#x89C1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;">&#x5E38;&#x89C1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;</h1>
<p>&#x53C2;&#x8003;&#x5B66;&#x4E60;&#xFF1A;<a href="https://blog.csdn.net/qq_26437925/article/details/53728388" target="_blank">&#x51E0;&#x79CD;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;</a></p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;</th>
<th style="text-align:center">&#x4F18;&#x7F3A;&#x70B9;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x6CD5;(Referenc Counting)</td>
<td style="text-align:center">&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x5FAA;&#x73AF;&#x5F15;&#x7528;</td>
</tr>
<tr>
<td style="text-align:center">&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x7B97;&#x6CD5;(Mark-Sweep)&#x7B97;&#x6CD5;</td>
<td style="text-align:center">&#x626B;&#x63CF;&#x5E76;&#x6807;&#x8BB0;&#x5783;&#x573E;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5783;&#x573E;&#x6E05;&#x7406;&#x6389;&#xFF1B;&#x80FD;&#x89E3;&#x51B3;&#x5FAA;&#x73AF;&#x5F15;&#x7528;&#xFF0C;&#x4F1A;&#x4EA7;&#x751F;&#x5185;&#x5B58;&#x788E;&#x7247;</td>
</tr>
<tr>
<td style="text-align:center">&#x6807;&#x8BB0;-&#x7F29;&#x5E76;&#xFF08;Mark-Compact)&#x7B97;&#x6CD5;</td>
<td style="text-align:center">&#x7C7B;&#x4F3C;Mark-Sweep,&#x4E0D;&#x8FC7;&#x6700;&#x540E;&#x662F;&#xFF1A;1.&#x538B;&#x7F29;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x89C4;&#x6574;&#x4E0B;&#x5230;&#x4E00;&#x8D77;&#xFF0C;2.&#x6E05;&#x9664;&#x5269;&#x4E0B;&#x5168;&#x90E8;&#x7A7A;&#x95F4;&#xFF1B;&#x53EF;&#x89E3;&#x51B3;&#x5185;&#x5B58;&#x788E;&#x7247;&#xFF1B;&#x663E;&#x7136;&#x4E00;&#x6B21;&#x56DE;&#x6536;&#x540E;&#xFF0C;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x8D8A;&#x591A;&#xFF0C;&#x5219;&#x8017;&#x65F6;&#x5C31;&#x8D8A;&#x5927;</td>
</tr>
<tr>
<td style="text-align:center">&#x62F7;&#x8D1D;(Copying)&#x7B97;&#x6CD5;</td>
<td style="text-align:center">&#x5806;&#x7A7A;&#x95F4;&#x5206;&#x4E24;&#x534A;&#xFF0C;&#x6709;&#x7528;&#x7684;&#x62F7;&#x8D1D;&#x5230;&#x53E6;&#x4E00;&#x534A;&#xFF0C;&#x628A;&#x5F53;&#x524D;&#x8FD9;&#x4E00;&#x534A;&#x76F4;&#x63A5;&#x5168;&#x90E8;&#x6E05;&#x9664;&#xFF0C;&#x80FD;&#x89E3;&#x51B3;&#x5185;&#x90E8;&#x788E;&#x7247;&#xFF0C;&#x4F46;&#x6D6A;&#x8D39;&#x7A7A;&#x95F4;&#xFF0C;&#x4E0D;&#x8FC7;&#x5185;&#x5B58;&#x62F7;&#x8D1D;&#x662F;&#x5F88;&#x5FEB;&#x7684;</td>
</tr>
</tbody>
</table>
<h1 id="&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x53D1;&#x5C55;&#x548C;&#x4ECB;&#x7ECD;">&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x53D1;&#x5C55;&#x548C;&#x4ECB;&#x7ECD;</h1>
<p>&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x5E76;&#x53D1;&amp;&#x5E76;&#x884C;</p>
<ul>
<li><p>&#x5E76;&#x884C;(Parallel)&#xFF1A;&#x6307;&#x591A;&#x6761;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7EBF;&#x7A0B;&#x5E76;&#x884C;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F46;&#x6B64;&#x65F6;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x4ECD;&#x662F;&#x88AB;&#x963B;&#x585E;&#x7684;&#x7B49;&#x5F85;&#x72B6;&#x6001;</p>
</li>
<li><p>&#x5E76;&#x53D1;(Concurrent): &#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x80FD;&#x4E0E;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x6267;&#x884C;&#xFF1A;&#x5373;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x5728;&#x4E00;&#x4E2A;CPU&#x4E0A;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#xFF0C;&#x800C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x4E8E;&#x53E6;&#x4E00;&#x4E2A;CPU&#x4E0A;</p>
</li>
</ul>
<h2 id="gc&#x6536;&#x96C6;&#x5668;&#x53CA;&#x5176;&#x53D1;&#x5C55;">GC&#x6536;&#x96C6;&#x5668;&#x53CA;&#x5176;&#x53D1;&#x5C55;</h2>
<p>&#x968F;&#x7740;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x7684;&#x4E0D;&#x65AD;&#x589E;&#x957F;&#x800C;&#x6F14;&#x8FDB;</p>
<h3 id="&#x4E00;-serial&#xFF08;stw&#x5355;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;">(&#x4E00;) Serial&#xFF08;STW,&#x5355;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;</h3>
<font color="red">a stop-the-world,coping collector which uses a single GC thread</font>

<p>&#x4F7F;&#x7528;<code>Coping&#x7B97;&#x6CD5;</code>&#x7684;&#x5355;&#x7EBF;&#x7A0B;&#x7684;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x7684;&quot;&#x5355;&#x7EBF;&#x7A0B;&quot;&#x7684;&#x610F;&#x4E49;&#x5E76;&#x4E0D;&#x4EC5;&#x4EC5;&#x8BF4;&#x660E;&#x5B83;&#x53EA;&#x4F1A;&#x4F7F;&#x7528;<strong>&#x4E00;&#x4E2A;CPU</strong>&#x6216;&#x8005;<strong>&#x4E00;&#x6761;&#x6536;&#x96C6;&#x7EBF;&#x7A0B;</strong>&#x53BB;&#x5B8C;&#x6210;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5DE5;&#x4F5C;&#xFF0C;&#x66F4;&#x91CD;&#x8981;&#x7684;&#x662F;&#x5B83;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#xFF0C;<strong>&#x5FC5;&#x987B;&#x6682;&#x505C;&#x5176;&#x5B83;&#x6240;&#x6709;&#x7684;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x76F4;&#x5230;&#x6536;&#x96C6;&#x7ED3;&#x675F;</strong>&#x5373;<code>Stop The World</code></p>
<h4 id="serial-old">Serial Old</h4>
<p>a stop-the-world, mark-sweep-compact collector which uses a single GC thread</p>
<h3 id="&#x4E8C;-parallel-scavenge&#xFF08;stw&#x591A;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;">(&#x4E8C;) Parallel Scavenge&#xFF08;STW,&#x591A;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#xFF09;</h3>
<font color="red">a stop-the-world,coping collector which uses multi GC threads</font>

<p>&#x4F7F;&#x7528;<code>Coping&#x7B97;&#x6CD5;</code>&#x7684;<strong>&#x5E76;&#x884C;&#x591A;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;</strong>&#x3002;Parallel Scavenge&#x662F;<code>Java1.8</code>&#x9ED8;&#x8BA4;&#x7684;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x7279;&#x70B9;&#x662F;&#x5E76;&#x884C;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x56DE;&#x6536;&#xFF0C;&#x4EE5;&#x541E;&#x5410;&#x91CF;&#xFF08;CPU&#x7528;&#x4E8E;&#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x95F4;&#x4E0E;CPU&#x603B;&#x6D88;&#x8017;&#x65F6;&#x95F4;&#x7684;&#x6BD4;&#x503C;&#xFF0C;&#x541E;&#x5410;&#x91CF;=&#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x65F6;&#x95F4;/(&#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x65F6;&#x95F4;+&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x95F4;)&#xFF09;&#x4F18;&#x5148;</p>
<p>&#x505C;&#x987F;&#x65F6;&#x95F4;&#x8D8A;&#x77ED;&#x5C31;&#x8D8A;&#x9002;&#x5408;&#x9700;&#x8981;&#x4E0E;&#x7528;&#x6237;&#x4EA4;&#x4E92;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x826F;&#x597D;&#x7684;&#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x80FD;&#x63D0;&#x5347;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#xFF0C;&#x800C;&#x9AD8;&#x541E;&#x5410;&#x91CF;&#x5219;&#x53EF;&#x4EE5;&#x9AD8;&#x6548;&#x7387;&#x5730;&#x5229;&#x7528;CPU&#x65F6;&#x95F4;&#xFF0C;&#x5C3D;&#x5FEB;&#x5B8C;&#x6210;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x7B97;&#x4EFB;&#x52A1;&#xFF0C;&#x4E3B;&#x8981;&#x9002;&#x5408;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x7B97;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x592A;&#x591A;&#x4EA4;&#x4E92;&#x7684;&#x4EFB;&#x52A1;</p>
<h4 id="parallel-old">Parallel old</h4>
<font color="red">a stop-the-world, mark-sweep-compact collector that uses multi GC threads</font>

<h4 id="parnew-parallel-scavenge&#x7684;&#x589E;&#x5F3A;&#x7248;">ParNew (Parallel Scavenge&#x7684;&#x589E;&#x5F3A;&#x7248;)</h4>
<p>&#x540C;Parallel Scavenge&#xFF0C;&#x4F46;&#x662F;&#x662F;&#x5DE5;&#x4F5C;&#x5728;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#xFF1B;&#x4E14;&#x80FD;&#x4E0E;<code>CMS</code>&#x6536;&#x96C6;&#x5668;&#x914D;&#x5408;&#x5DE5;&#x4F5C;&#x3002;</p>
<h3 id="&#x4E09;-cms&#x6536;&#x96C6;&#x5668;&#xFF08;&#x5E76;&#x53D1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#xFF09;">(&#x4E09;) CMS&#x6536;&#x96C6;&#x5668;&#xFF08;&#x5E76;&#x53D1;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#xFF09;</h3>
<ul>
<li>concurret mark sweep</li>
<li>a mostly concurrent, low-pause collector</li>
</ul>
<p>4 phases:</p>
<ol>
<li>initial mark(stw)</li>
<li>concurrent mark</li>
<li>remark(stw)</li>
<li>concurrent sweep</li>
</ol>
<p>CMS&#x6536;&#x96C6;&#x5668;&#x5728;Minor GC&#x65F6;&#x4F1A;&#x6682;&#x505C;&#x6240;&#x6709;&#x7684;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x4EE5;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x3002;&#x5728;Full GC&#x65F6;&#x4E0D;&#x518D;&#x6682;&#x505C;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x662F;&#x4F7F;&#x7528;&#x82E5;&#x5E72;&#x4E2A;&#x540E;&#x53F0;&#x7EBF;&#x7A0B;&#x5B9A;&#x671F;&#x7684;&#x5BF9;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x8FDB;&#x884C;&#x626B;&#x63CF;&#xFF0C;&#x53CA;&#x65F6;&#x56DE;&#x6536;&#x5176;&#x4E2D;&#x4E0D;&#x518D;&#x4F7F;&#x7528;&#x7684;&#x5BF9;&#x8C61;</p>
<p>&#x5206;&#x4EE3;&#x7B97;&#x6CD5;&#x4E2D;&#xFF0C;&#x4E00;&#x822C;Serial&#x6216;ParNew&#x7528;&#x4E8E;&#x5E74;&#x8F7B;&#x4EE3;&#x3001;CMS&#x4F5C;&#x4E3A;&#x8001;&#x5E74;&#x4EE3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;</p>
<h3 id="&#x56DB;-g1">(&#x56DB;) G1</h3>
<p>G1&#x6536;&#x96C6;&#x5668;&#xFF08;&#x6216;&#x8005;&#x5783;&#x573E;&#x4F18;&#x5148;&#x6536;&#x96C6;&#x5668;&#xFF09;&#x7684;&#x8BBE;&#x8BA1;&#x521D;&#x8877;&#x662F;&#x4E3A;&#x4E86;&#x5C3D;&#x91CF;&#x7F29;&#x77ED;&#x5904;&#x7406;&#x8D85;&#x5927;&#x5806;&#xFF08;&#x5927;&#x4E8E;4GB&#xFF09;&#x65F6;&#x4EA7;&#x751F;&#x7684;&#x505C;&#x987F;&#x3002;&#x76F8;&#x5BF9;&#x4E8E;CMS&#x7684;&#x4F18;&#x52BF;&#x800C;&#x8A00;&#x662F;&#x5185;&#x5B58;&#x788E;&#x7247;&#x7684;&#x4EA7;&#x751F;&#x7387;&#x5927;&#x5927;&#x964D;&#x4F4E;&#xFF1B;&#x76EE;&#x6807;&#x662F;&#x7528;&#x5728;<strong>&#x591A;&#x6838;</strong>&#xFF0C;<strong>&#x5927;&#x5185;&#x5B58;</strong>&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x5B83;&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6307;&#x5B9A;&#x7684;GC&#x6682;&#x505C;&#x65F6;&#x95F4;&#xFF0C;&#x540C;&#x65F6;&#x8FD8;&#x80FD;&#x4FDD;&#x6301;&#x8F83;&#x9AD8;&#x7684;&#x541E;&#x5410;&#x91CF;</p>
<pre class="language-"><code class="lang-java"><span class="token class-name">Java</span> <span class="token class-name">HotSpot</span><span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span><span class="token operator">-</span><span class="token class-name">Bit</span> <span class="token class-name">Server</span> VM <span class="token punctuation">(</span><span class="token number">25.171</span><span class="token operator">-</span>b11<span class="token punctuation">)</span> <span class="token keyword">for</span> bsd<span class="token operator">-</span>amd64 JRE <span class="token punctuation">(</span><span class="token number">1.8</span><span class="token number">.0_171</span><span class="token operator">-</span>b11<span class="token punctuation">)</span><span class="token punctuation">,</span> built on <span class="token class-name">Mar</span> <span class="token number">28</span> <span class="token number">2018</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">50</span><span class="token operator">:</span><span class="token number">57</span> by <span class="token string">&quot;java_re&quot;</span> <span class="token keyword">with</span> gcc <span class="token number">4.2</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token class-name">Based</span> on <span class="token class-name">Apple</span> <span class="token class-name">Inc</span><span class="token punctuation">.</span> build <span class="token number">5658</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>LLVM build <span class="token number">2336.11</span><span class="token number">.00</span><span class="token punctuation">)</span>
<span class="token class-name">Memory</span><span class="token operator">:</span> <span class="token number">4</span>k page<span class="token punctuation">,</span> physical <span class="token function">16777216k</span><span class="token punctuation">(</span><span class="token number">1978920</span>k free<span class="token punctuation">)</span>

<span class="token operator">/</span>proc<span class="token operator">/</span>meminfo<span class="token operator">:</span>

<span class="token class-name">CommandLine</span> flags<span class="token operator">:</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">InitialHeapSize</span><span class="token operator">=</span><span class="token number">20971520</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxHeapSize</span><span class="token operator">=</span><span class="token number">20971520</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxNewSize</span><span class="token operator">=</span><span class="token number">10485760</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">NewSize</span><span class="token operator">=</span><span class="token number">10485760</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGC</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCDetails</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCTimeStamps</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">SurvivorRatio</span><span class="token operator">=</span><span class="token number">8</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseCompressedClassPointers</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseCompressedOops</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseG1GC</span>
<span class="token number">0.196</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">GC</span> pause <span class="token punctuation">(</span>G1 <span class="token class-name">Humongous</span> <span class="token class-name">Allocation</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token punctuation">(</span>initial<span class="token operator">-</span>mark<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0022978</span> secs<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Parallel</span> <span class="token class-name">Time</span><span class="token operator">:</span> <span class="token number">2.0</span> ms<span class="token punctuation">,</span> GC <span class="token class-name">Workers</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">Start</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">196.2</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">196.2</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">196.3</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Ext</span> <span class="token class-name">Root</span> <span class="token class-name">Scanning</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">2.4</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Update</span> RS <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
         <span class="token punctuation">[</span><span class="token class-name">Processed</span> <span class="token class-name">Buffers</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Scan</span> RS <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Code</span> <span class="token class-name">Root</span> <span class="token class-name">Scanning</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Object</span> <span class="token class-name">Copy</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">1.3</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">4.3</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Termination</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">1.1</span><span class="token punctuation">]</span>
         <span class="token punctuation">[</span><span class="token class-name">Termination</span> <span class="token class-name">Attempts</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">Other</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">Total</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">1.9</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">7.8</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">End</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">198.2</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">198.2</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">198.2</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Code</span> <span class="token class-name">Root</span> <span class="token class-name">Fixup</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Code</span> <span class="token class-name">Root</span> <span class="token class-name">Purge</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Clear</span> CT<span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Other</span><span class="token operator">:</span> <span class="token number">0.2</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Choose</span> <span class="token class-name">CSet</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Ref</span> <span class="token class-name">Proc</span><span class="token operator">:</span> <span class="token number">0.1</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Ref</span> <span class="token class-name">Enq</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Redirty</span> <span class="token class-name">Cards</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Humongous</span> <span class="token class-name">Register</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Humongous</span> <span class="token class-name">Reclaim</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Free</span> <span class="token class-name">CSet</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Eden</span><span class="token operator">:</span> <span class="token number">3072.</span><span class="token function">0K</span><span class="token punctuation">(</span><span class="token number">10.0</span>M<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token number">0.</span><span class="token function">0B</span><span class="token punctuation">(</span><span class="token number">9216.0</span>K<span class="token punctuation">)</span> <span class="token class-name">Survivors</span><span class="token operator">:</span> <span class="token number">0.0</span>B<span class="token operator">-&gt;</span><span class="token number">1024.0</span>K <span class="token class-name">Heap</span><span class="token operator">:</span> <span class="token number">8629.</span><span class="token function">0K</span><span class="token punctuation">(</span><span class="token number">20.0</span>M<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token number">6823.</span><span class="token function">5K</span><span class="token punctuation">(</span><span class="token number">20.0</span>M<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.01</span> secs<span class="token punctuation">]</span> 
<span class="token number">0.199</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>root<span class="token operator">-</span>region<span class="token operator">-</span>scan<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token number">0.199</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>root<span class="token operator">-</span>region<span class="token operator">-</span>scan<span class="token operator">-</span>end<span class="token punctuation">,</span> <span class="token number">0.0005314</span> secs<span class="token punctuation">]</span>
<span class="token number">0.199</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>start<span class="token punctuation">]</span>
<span class="token number">0.199</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>end<span class="token punctuation">,</span> <span class="token number">0.0000251</span> secs<span class="token punctuation">]</span>
<span class="token number">0.202</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC remark <span class="token number">0.202</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">Finalize</span> <span class="token class-name">Marking</span><span class="token punctuation">,</span> <span class="token number">0.0000621</span> secs<span class="token punctuation">]</span> <span class="token number">0.202</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC ref<span class="token operator">-</span>proc<span class="token punctuation">,</span> <span class="token number">0.0000215</span> secs<span class="token punctuation">]</span> <span class="token number">0.202</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">Unloading</span><span class="token punctuation">,</span> <span class="token number">0.0003779</span> secs<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.0005651</span> secs<span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
<span class="token number">0.203</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC cleanup <span class="token number">13</span>M<span class="token operator">-&gt;</span><span class="token function">13M</span><span class="token punctuation">(</span><span class="token number">20</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0001664</span> secs<span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
 <span class="token class-name">Heap</span>
 garbage<span class="token operator">-</span>first heap   total <span class="token number">20480</span>K<span class="token punctuation">,</span> used <span class="token number">12967</span>K <span class="token punctuation">[</span><span class="token number">0x00000007bec00000</span><span class="token punctuation">,</span> <span class="token number">0x00000007bed000a0</span><span class="token punctuation">,</span> <span class="token number">0x00000007c0000000</span><span class="token punctuation">)</span>
  region size <span class="token number">1024</span>K<span class="token punctuation">,</span> <span class="token number">2</span> young <span class="token punctuation">(</span><span class="token number">2048</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> survivors <span class="token punctuation">(</span><span class="token number">1024</span>K<span class="token punctuation">)</span>
 <span class="token class-name">Metaspace</span>       used <span class="token number">3342</span>K<span class="token punctuation">,</span> capacity <span class="token number">4500</span>K<span class="token punctuation">,</span> committed <span class="token number">4864</span>K<span class="token punctuation">,</span> reserved <span class="token number">1056768</span>K
  <span class="token keyword">class</span> space    used <span class="token number">371</span>K<span class="token punctuation">,</span> capacity <span class="token number">388</span>K<span class="token punctuation">,</span> committed <span class="token number">512</span>K<span class="token punctuation">,</span> reserved <span class="token number">1048576</span>K
</code></pre>
<h3 id="&#x4E94;-zgc">(&#x4E94;) ZGC</h3>
<p><a href="https://blog.csdn.net/meituantech/article/details/107853015" target="_blank">&#x65B0;&#x4E00;&#x4EE3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;ZGC&#x7684;&#x63A2;&#x7D22;&#x4E0E;&#x5B9E;&#x8DF5;</a></p>
<p>ZGC&#xFF08;The Z Garbage Collector&#xFF09;&#x662F;JDK 11&#x4E2D;&#x63A8;&#x51FA;&#x7684;&#x4E00;&#x6B3E;&#x4F4E;&#x5EF6;&#x8FDF;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#xFF0C;&#x5B83;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E0D;&#x8D85;&#x8FC7;10ms&#xFF1B;</li>
<li>&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E0D;&#x4F1A;&#x968F;&#x7740;&#x5806;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x6216;&#x8005;&#x6D3B;&#x8DC3;&#x5BF9;&#x8C61;&#x7684;&#x5927;&#x5C0F;&#x800C;&#x589E;&#x52A0;&#xFF1B;</li>
<li>&#x652F;&#x6301;8MB~4TB&#x7EA7;&#x522B;&#x7684;&#x5806;&#xFF08;&#x672A;&#x6765;&#x652F;&#x6301;16TB&#xFF09;&#x3002;</li>
</ul>
<h4 id="zgc&#x539F;&#x7406;">ZGC&#x539F;&#x7406;</h4>
<p>&#x4E0E;CMS&#x4E2D;&#x7684;ParNew&#x548C;G1&#x7C7B;&#x4F3C;&#xFF0C;ZGC&#x4E5F;&#x91C7;&#x7528;&#x6807;&#x8BB0;-&#x590D;&#x5236;&#x7B97;&#x6CD5;&#xFF0C;&#x4E0D;&#x8FC7;ZGC&#x5BF9;&#x8BE5;&#x7B97;&#x6CD5;&#x505A;&#x4E86;&#x91CD;&#x5927;&#x6539;&#x8FDB;&#xFF1A;ZGC&#x5728;&#x6807;&#x8BB0;&#x3001;&#x8F6C;&#x79FB;&#x548C;&#x91CD;&#x5B9A;&#x4F4D;&#x9636;&#x6BB5;&#x51E0;&#x4E4E;&#x90FD;&#x662F;&#x5E76;&#x53D1;&#x7684;&#xFF0C;&#x8FD9;&#x662F;ZGC&#x5B9E;&#x73B0;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x5C0F;&#x4E8E;10ms&#x76EE;&#x6807;&#x7684;&#x6700;&#x5173;&#x952E;&#x539F;&#x56E0;&#x3002;</p>
<p><img src="imgs/zgc.png" alt=""></p>
<p>ZGC&#x53EA;&#x6709;&#x4E09;&#x4E2A;STW&#x9636;&#x6BB5;&#xFF1A;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#xFF0C;&#x518D;&#x6807;&#x8BB0;&#xFF0C;&#x521D;&#x59CB;&#x8F6C;&#x79FB;&#x3002;&#x5176;&#x4E2D;&#xFF0C;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x548C;&#x521D;&#x59CB;&#x8F6C;&#x79FB;&#x5206;&#x522B;&#x90FD;&#x53EA;&#x9700;&#x8981;&#x626B;&#x63CF;&#x6240;&#x6709;GC Roots&#xFF0C;&#x5176;&#x5904;&#x7406;&#x65F6;&#x95F4;&#x548C;GC Roots&#x7684;&#x6570;&#x91CF;&#x6210;&#x6B63;&#x6BD4;&#xFF0C;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x8017;&#x65F6;&#x975E;&#x5E38;&#x77ED;&#xFF1B;&#x518D;&#x6807;&#x8BB0;&#x9636;&#x6BB5;STW&#x65F6;&#x95F4;&#x5F88;&#x77ED;&#xFF0C;&#x6700;&#x591A;1ms&#xFF0C;&#x8D85;&#x8FC7;1ms&#x5219;&#x518D;&#x6B21;&#x8FDB;&#x5165;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x3002;&#x5373;&#xFF0C;ZGC&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x6682;&#x505C;&#x90FD;&#x53EA;&#x4F9D;&#x8D56;&#x4E8E;GC Roots&#x96C6;&#x5408;&#x5927;&#x5C0F;&#xFF0C;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E0D;&#x4F1A;&#x968F;&#x7740;&#x5806;&#x7684;&#x5927;&#x5C0F;&#x6216;&#x8005;&#x6D3B;&#x8DC3;&#x5BF9;&#x8C61;&#x7684;&#x5927;&#x5C0F;&#x800C;&#x589E;&#x52A0;&#x3002;&#x4E0E;ZGC&#x5BF9;&#x6BD4;&#xFF0C;G1&#x7684;&#x8F6C;&#x79FB;&#x9636;&#x6BB5;&#x5B8C;&#x5168;STW&#x7684;&#xFF0C;&#x4E14;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x968F;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x5927;&#x5C0F;&#x589E;&#x52A0;&#x800C;&#x589E;&#x52A0;&#x3002;</p>
<p>ZGC&#x901A;&#x8FC7;<strong>&#x7740;&#x8272;&#x6307;&#x9488;</strong>&#x548C;<strong>&#x8BFB;&#x5C4F;&#x969C;</strong>&#x6280;&#x672F;&#xFF0C;&#x89E3;&#x51B3;&#x4E86;&#x8F6C;&#x79FB;&#x8FC7;&#x7A0B;&#x4E2D;&#x51C6;&#x786E;&#x8BBF;&#x95EE;&#x5BF9;&#x8C61;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x5E76;&#x53D1;&#x8F6C;&#x79FB;&#x3002;&#x5927;&#x81F4;&#x539F;&#x7406;&#x63CF;&#x8FF0;&#x5982;&#x4E0B;&#xFF1A;&#x5E76;&#x53D1;&#x8F6C;&#x79FB;&#x4E2D;&quot;&#x5E76;&#x53D1;&quot;&#x610F;&#x5473;&#x7740;GC&#x7EBF;&#x7A0B;&#x5728;&#x8F6C;&#x79FB;&#x5BF9;&#x8C61;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x4E5F;&#x5728;&#x4E0D;&#x505C;&#x5730;&#x8BBF;&#x95EE;&#x5BF9;&#x8C61;&#x3002;&#x5047;&#x8BBE;&#x5BF9;&#x8C61;&#x53D1;&#x751F;&#x8F6C;&#x79FB;&#xFF0C;&#x4F46;&#x5BF9;&#x8C61;&#x5730;&#x5740;&#x672A;&#x53CA;&#x65F6;&#x66F4;&#x65B0;&#xFF0C;&#x90A3;&#x4E48;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x8BBF;&#x95EE;&#x5230;&#x65E7;&#x5730;&#x5740;&#xFF0C;&#x4ECE;&#x800C;&#x9020;&#x6210;&#x9519;&#x8BEF;&#x3002;&#x800C;&#x5728;ZGC&#x4E2D;&#xFF0C;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x5BF9;&#x8C61;&#x5C06;&#x89E6;&#x53D1;&quot;&#x8BFB;&#x5C4F;&#x969C;&quot;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x5BF9;&#x8C61;&#x88AB;&#x79FB;&#x52A8;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&quot;&#x8BFB;&#x5C4F;&#x969C;&quot;&#x4F1A;&#x628A;&#x8BFB;&#x51FA;&#x6765;&#x7684;&#x6307;&#x9488;&#x66F4;&#x65B0;&#x5230;&#x5BF9;&#x8C61;&#x7684;&#x65B0;&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x59CB;&#x7EC8;&#x8BBF;&#x95EE;&#x7684;&#x90FD;&#x662F;&#x5BF9;&#x8C61;&#x7684;&#x65B0;&#x5730;&#x5740;&#x3002;&#x90A3;&#x4E48;&#xFF0C;JVM&#x662F;&#x5982;&#x4F55;&#x5224;&#x65AD;&#x5BF9;&#x8C61;&#x88AB;&#x79FB;&#x52A8;&#x8FC7;&#x5462;&#xFF1F;&#x5C31;&#x662F;&#x5229;&#x7528;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5373;&#x7740;&#x8272;&#x6307;&#x9488;&#x3002;</p>
<ul>
<li>&#x7740;&#x8272;&#x6307;&#x9488;&#x662F;&#x4E00;&#x79CD;&#x5C06;&#x4FE1;&#x606F;&#x5B58;&#x50A8;&#x5728;&#x6307;&#x9488;&#x4E2D;&#x7684;&#x6280;&#x672F;&#x3002;</li>
<li>&#x8BFB;&#x5C4F;&#x969C;&#x662F;JVM&#x5411;&#x5E94;&#x7528;&#x4EE3;&#x7801;&#x63D2;&#x5165;&#x4E00;&#x5C0F;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x6280;&#x672F;&#x3002;&#x5F53;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x4ECE;&#x5806;&#x4E2D;&#x8BFB;&#x53D6;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x6267;&#x884C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x3002;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x4EC5;&quot;&#x4ECE;&#x5806;&#x4E2D;&#x8BFB;&#x53D6;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&quot;&#x624D;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x3002;</li>
</ul>
<h2 id="java&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x4F9D;&#x636E;&#x5047;&#x8BBE;">Java&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x4F9D;&#x636E;/&#x5047;&#x8BBE;</h2>
<ul>
<li>Most objects soon become unreachable.</li>
<li>References from old objects to young objects only exist in small numbers.</li>
</ul>
<h2 id="&#x5206;&#x4EE3;gc&#x67E5;&#x770B;&#x9ED8;&#x8BA4;&#x7684;gc&#x914D;&#x7F6E;">&#x5206;&#x4EE3;GC,&#x67E5;&#x770B;&#x9ED8;&#x8BA4;&#x7684;GC&#x914D;&#x7F6E;</h2>
<pre class="language-"><code class="lang-java">mubi<span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token operator">~</span> $ java <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintCommandLineFlags</span> <span class="token operator">-</span>version
<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">InitialHeapSize</span><span class="token operator">=</span><span class="token number">268435456</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxHeapSize</span><span class="token operator">=</span><span class="token number">4294967296</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintCommandLineFlags</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseCompressedClassPointers</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseCompressedOops</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseParallelGC</span>
java version <span class="token string">&quot;1.8.0_171&quot;</span>
<span class="token class-name">Java</span><span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE <span class="token class-name">Runtime</span> <span class="token class-name">Environment</span> <span class="token punctuation">(</span>build <span class="token number">1.8</span><span class="token number">.0_171</span><span class="token operator">-</span>b11<span class="token punctuation">)</span>
<span class="token class-name">Java</span> <span class="token class-name">HotSpot</span><span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span><span class="token operator">-</span><span class="token class-name">Bit</span> <span class="token class-name">Server</span> VM <span class="token punctuation">(</span>build <span class="token number">25.171</span><span class="token operator">-</span>b11<span class="token punctuation">,</span> mixed mode<span class="token punctuation">)</span>
mubi<span class="token annotation punctuation">@mubideMacBook</span><span class="token operator">-</span><span class="token class-name">Pro</span> <span class="token operator">~</span> $
</code></pre>
<p><img src="imgs/gc_fen_dai.png" alt=""></p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th style="text-align:center">&#x5E74;&#x8F7B;&#x4EE3;(&#x522B;&#x540D;)</th>
<th style="text-align:center">&#x8001;&#x5E74;&#x4EE3;</th>
<th style="text-align:center">JVM &#x53C2;&#x6570;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x7EC4;&#x5408;&#x4E00;</td>
<td style="text-align:center">Serial (DefNew)</td>
<td style="text-align:center">Serial Old(PSOldGen)</td>
<td style="text-align:center">-XX:+UseSerialGC</td>
</tr>
<tr>
<td style="text-align:center">&#x7EC4;&#x5408;&#x4E8C;</td>
<td style="text-align:center">Parallel Scavenge (PSYoungGen)</td>
<td style="text-align:center">Serial Old(PSOldGen)</td>
<td style="text-align:center">-XX:+UseParallelGC</td>
</tr>
<tr>
<td style="text-align:center">&#x7EC4;&#x5408;&#x4E09;(*)</td>
<td style="text-align:center">Parallel Scavenge (PSYoungGen)</td>
<td style="text-align:center">Parallel Old (ParOldGen)</td>
<td style="text-align:center">-XX:+UseParallelOldGC</td>
</tr>
<tr>
<td style="text-align:center">&#x7EC4;&#x5408;&#x56DB;</td>
<td style="text-align:center">ParNew (ParNew)</td>
<td style="text-align:center">Serial Old(PSOldGen)</td>
<td style="text-align:center">-XX:-UseParNewGC</td>
</tr>
<tr>
<td style="text-align:center">&#x7EC4;&#x5408;&#x4E94;(*)</td>
<td style="text-align:center">ParNew (ParNew)</td>
<td style="text-align:center">CMS+Serial Old(PSOldGen)</td>
<td style="text-align:center">-XX:+UseConcMarkSweepGC</td>
</tr>
<tr>
<td style="text-align:center">&#x7EC4;&#x5408;&#x516D;(*)</td>
<td style="text-align:center">G1</td>
<td style="text-align:center">G1</td>
<td style="text-align:center">-XX:+UseG1GC</td>
</tr>
</tbody>
</table>
<h3 id="new-object&#x7684;gc&#x751F;&#x547D;&#x5468;&#x671F;"><code>new object</code>&#x7684;gc&#x751F;&#x547D;&#x5468;&#x671F;</h3>
<p><img src="imgs/gc_fen_dai_2.png" alt=""></p>
<ul>
<li>&#x7EBF;&#x7A0B;TLAB&#x5C40;&#x90E8;&#x7F13;&#x5B58;&#x533A;&#x57DF;&#xFF08;Thread Local Allocation Buffer&#xFF09;</li>
</ul>
<p>Sun Hotspot JVM&#x4E3A;&#x4E86;&#x63D0;&#x5347;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x6548;&#x7387;&#xFF0C;&#x5BF9;&#x4E8E;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#x90FD;&#x4F1A;&#x5206;&#x914D;&#x4E00;&#x5757;&#x72EC;&#x7ACB;&#x7684;&#x7A7A;&#x95F4;TLAB&#xFF08;Thread Local Allocation Buffer&#xFF09;&#xFF0C;&#x5176;&#x5927;&#x5C0F;&#x7531;JVM&#x6839;&#x636E;&#x8FD0;&#x884C;&#x7684;&#x60C5;&#x51B5;&#x8BA1;&#x7B97;&#x800C;&#x5F97;&#xFF0C;&#x5728;TLAB&#x4E0A;&#x5206;&#x914D;&#x5BF9;&#x8C61;&#x65F6;&#x4E0D;&#x9700;&#x8981;&#x52A0;&#x9501;&#xFF08;&#x57FA;&#x4E8E; CAS &#x7684;&#x72EC;&#x4EAB;&#x7EBF;&#x7A0B;&#xFF08;Mutator Threads)&#xFF09;&#xFF0C;&#x56E0;&#x6B64;JVM&#x5728;&#x7ED9;&#x7EBF;&#x7A0B;&#x7684;&#x5BF9;&#x8C61;&#x5206;&#x914D;&#x5185;&#x5B58;&#x65F6;&#x4F1A;&#x5C3D;&#x91CF;&#x7684;&#x5728;TLAB&#x4E0A;&#x5206;&#x914D;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;JVM&#x4E2D;&#x5206;&#x914D;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x7684;&#x6027;&#x80FD;&#x548C;C&#x57FA;&#x672C;&#x662F;&#x4E00;&#x6837;&#x9AD8;&#x6548;&#x7684;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x8FC7;&#x5927;&#x7684;&#x8BDD;&#x5219;&#x4ECD;&#x7136;&#x662F;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x5806;&#x7A7A;&#x95F4;&#x5206;&#x914D;&#xFF08;&#x5806;&#x662F;JVM&#x4E2D;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x5176;&#x4E0A;&#x8FDB;&#x884C;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x7684;&#x5206;&#x914D;&#x5747;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x52A0;&#x9501;&#xFF0C;&#x8FD9;&#x4E5F;&#x5BFC;&#x81F4;&#x4E86;new&#x5BF9;&#x8C61;&#x7684;&#x5F00;&#x9500;&#x662F;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#xFF09;</p>
<h2 id="cmsconcurrent-mark-sweep&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;">CMS(Concurrent Mark Sweep)&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;</h2>
<p><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/cms.html" target="_blank">&#x53C2;&#x8003;&#x6587;&#x6863;&#x5730;&#x5740;</a></p>
<p>The Concurrent Mark Sweep (CMS) collector is designed for applications that prefer shorter garbage collection pauses and that can afford to share processor resources with the garbage collector while the application is running.</p>
<p>&#x4E00;&#x79CD;&#x4EE5;&#x83B7;&#x53D6;<strong>&#x6700;&#x77ED;&#x56DE;&#x6536;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E3A;&#x76EE;&#x6807;</strong>&#x7684;&#x6536;&#x96C6;&#x5668;(&#x4EE5;&#x727A;&#x7272;&#x4E86;&#x541E;&#x5410;&#x91CF;&#x4E3A;&#x4EE3;&#x4EF7;)&#xFF1A;&#x5E0C;&#x671B;&#x7CFB;&#x7EDF;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x6700;&#x77ED;&#xFF0C;&#x7ED9;&#x7528;&#x6237;&#x5E26;&#x6765;&#x8F83;&#x597D;&#x4F46;&#x4F53;&#x9A8C;&#x3002;&#x57FA;&#x7840;&#x7B97;&#x6CD5;&#x662F;<code>Mark-Sweep</code>&#x7B97;&#x6CD5;&#xFF1B;&#x4E0D;&#x4F1A;&#x6574;&#x7406;&#x3001;&#x538B;&#x7F29;&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x4F1A;&#x4EA7;&#x751F;&#x5185;&#x5B58;&#x788E;&#x7247;</p>
<p>&#x8981;&#x6C42;&#x591A;CPU&#xFF1B;&#x4E3A;&#x4E86;&#x8BA9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0D;&#x505C;&#x987F;&#xFF0C;CMS&#x7EBF;&#x7A0B;&#x548C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x9700;&#x8981;&#x6709;&#x66F4;&#x591A;&#x7684;CPU&#xFF0C;&#x5355;&#x7EAF;&#x9760;&#x7EBF;&#x7A0B;&#x5207;&#x6362;&#x6548;&#x7387;&#x592A;&#x4F4E;&#x3002;&#x5E76;&#x4E14;&#xFF0C;&#x91CD;&#x65B0;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF0C;&#x4E3A;&#x4FDD;&#x8BC1;<code>Stop The World</code>&#x5FEB;&#x901F;&#x5B8C;&#x6210;&#xFF0C;&#x4E5F;&#x8981;&#x7528;&#x5230;&#x66F4;&#x591A;&#x7684;&#x751A;&#x81F3;&#x6240;&#x6709;&#x7684;CPU&#x8D44;&#x6E90;&#x3002;</p>
<h3 id="cms&#x5904;&#x7406;&#x7684;4&#x4E2A;&#x6B65;&#x9AA4;">CMS&#x5904;&#x7406;&#x7684;4&#x4E2A;&#x6B65;&#x9AA4;</h3>
<p><img src="imgs/cms_deal_flow.png" alt=""></p>
<ul>
<li>&#x521D;&#x59CB;&#x6807;&#x8BB0;&#xFF08;CMS initial mark&#xFF09;&#xFF0C;&#x9700;&#x8981;&#x77ED;&#x6682;&#x7684;<code>Stop The World</code></li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4ECE;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&quot;&#x6839;&#x5BF9;&#x8C61;&quot;&#x5F00;&#x59CB;&#xFF0C;&#x53EA;&#x626B;&#x63CF;&#x5230;&#x80FD;&#x591F;&#x548C;&quot;&#x6839;&#x5BF9;&#x8C61;&quot;&#x76F4;&#x63A5;&#x5173;&#x8054;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4F5C;&#x6807;&#x8BB0;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x867D;&#x7136;&#x6682;&#x505C;&#x4E86;&#x6574;&#x4E2A;JVM&#xFF0C;&#x4F46;&#x662F;&#x5F88;&#x5FEB;&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x3002;</p>
<ul>
<li>&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#xFF08;CMS concurrent mark&#xFF09;&#xFF08;&#x4E00;&#x5B9A;&#x4F1A;&#x6709;&#x9519;&#x8BEF;&#x6807;&#x8BB0;&#xFF09;</li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7D27;&#x968F;<code>&#x521D;&#x59CB;&#x6807;&#x8BB0;</code>&#x9636;&#x6BB5;&#xFF0C;&#x5728;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x7EE7;&#x7EED;&#x5411;&#x4E0B;&#x8FFD;&#x6EAF;&#x6807;&#x8BB0;&#x3002;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x7EBF;&#x7A0B;&#x548C;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x7684;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x7528;&#x6237;&#x4E0D;&#x4F1A;&#x611F;&#x53D7;&#x5230;&#x505C;&#x987F;&#x3002;(&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x6240;&#x6709;&#x8001;&#x5E74;&#x4EE3;)</p>
<ul>
<li>&#x91CD;&#x65B0;&#x6807;&#x8BB0;&#xFF08;CMS remark&#xFF09;&#x6B63;&#x786E;&#x6807;&#x8BB0;&#xFF0C;&#x9700;&#x8981;<code>Stop The World</code></li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4F1A;&#x6682;&#x505C;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x6536;&#x96C6;&#x5668;&#x7EBF;&#x7A0B;&#x626B;&#x63CF;&#x5728;CMS&#x5806;&#x4E2D;&#x5269;&#x4F59;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x626B;&#x63CF;&#x4ECE;&quot;&#x6839;&#x5BF9;&#x8C61;&quot;&#x5F00;&#x59CB;&#x5411;&#x4E0B;&#x8FFD;&#x6EAF;&#xFF0C;&#x5E76;&#x5904;&#x7406;&#x5BF9;&#x8C61;&#x5173;&#x8054;&#x3002;</p>
<ul>
<li>&#x5E76;&#x53D1;&#x6E05;&#x9664;&#xFF08;CMS concurrent sweep&#xFF09;</li>
</ul>
<p>&#x6E05;&#x7406;&#x5783;&#x573E;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x6536;&#x96C6;&#x5668;&#x7EBF;&#x7A0B;&#x548C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EBF;&#x7A0B;<strong>&#x5E76;&#x53D1;</strong>&#x6267;&#x884C;&#xFF1B;&#x4F1A;&#x4EA7;&#x751F;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF08;&#x4F7F;&#x7528;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x7B97;&#x6CD5;&#xFF09;</p>
<h3 id="&#x7F3A;&#x70B9;">&#x7F3A;&#x70B9;</h3>
<ol>
<li><p>CMS&#x6536;&#x96C6;&#x5668;&#x5BF9;CPU&#x8D44;&#x6E90;&#x975E;&#x5E38;&#x654F;&#x611F;&#x3002;&#x5728;&#x5E76;&#x53D1;&#x9636;&#x6BB5;&#xFF0C;&#x867D;&#x7136;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x505C;&#x987F;&#xFF0C;&#x4F46;&#x662F;<font color="red">&#x4F1A;&#x56E0;&#x4E3A;&#x5360;&#x7528;&#x4E86;&#x4E00;&#x90E8;&#x5206;&#x7EBF;&#x7A0B;&#xFF0C;&#x4F7F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53D8;&#x6162;&#xFF0C;&#x603B;&#x541E;&#x5410;&#x91CF;&#x4F1A;&#x964D;&#x4F4E;</font>&#xFF0C;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&quot;&#x589E;&#x91CF;&#x5F0F;&#x5E76;&#x53D1;&#x6536;&#x96C6;&#x5668;&quot;(Incremental Concurrent Mark Sweep/i-CMS)&#x7684;CMS&#x6536;&#x96C6;&#x5668;&#x53D8;&#x79CD;&#xFF0C;&#x6240;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x5C31;&#x662F;&#x5728;<code>&#x5E76;&#x53D1;&#x6807;&#x8BB0;</code>&#x548C;<code>&#x5E76;&#x53D1;&#x6E05;&#x9664;</code>&#x7684;&#x65F6;&#x5019;&#x8BA9;GC&#x7EBF;&#x7A0B;&#x548C;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x4EA4;&#x66FF;&#x8FD0;&#x884C;&#xFF0C;&#x5C3D;&#x91CF;&#x51CF;&#x5C11;GC&#x7EBF;&#x7A0B;&#x72EC;&#x5360;&#x8D44;&#x6E90;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x8FD9;&#x6837;&#x6574;&#x4E2A;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7684;&#x8FC7;&#x7A0B;&#x4F1A;&#x53D8;&#x957F;&#xFF0C;&#x4F46;&#x662F;&#x5BF9;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x7684;&#x5F71;&#x54CD;&#x4F1A;&#x51CF;&#x5C11;&#x3002;&#xFF08;&#x6548;&#x679C;&#x4E0D;&#x660E;&#x663E;&#xFF0C;&#x5DF2;&#x7ECF;&#x4E0D;&#x63A8;&#x8350;&#xFF09;</p>
</li>
<li><p>CMS&#x5904;&#x7406;&#x5668;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF08;<code>Floating Garbage</code>&#xFF09;&#x3002;&#x7531;&#x4E8E;CMS&#x5728;&#x5E76;&#x53D1;&#x6E05;&#x9664;&#x9636;&#x6BB5;<strong>&#x6709;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x8FD8;&#x5728;&#x8FD0;&#x884C;&#x7740;</strong>&#xFF0C;&#x4F34;&#x968F;&#x7740;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#x81EA;&#x7136;&#x4E5F;&#x4F1A;&#x4EA7;&#x751F;&#x65B0;&#x7684;&#x5783;&#x573E;&#xFF0C;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x5783;&#x573E;&#x4EA7;&#x751F;&#x5728;&#x6807;&#x8BB0;&#x8FC7;&#x7A0B;&#x4E4B;&#x540E;&#xFF0C;CMS&#x65E0;&#x6CD5;&#x5728;&#x5F53;&#x6B21;&#x6536;&#x96C6;&#x8FC7;&#x7A0B;&#x4E2D;&#x5904;&#x7406;&#x6389;&#x5B83;&#x4EEC;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x6709;&#x7B49;&#x5230;&#x4E0B;&#x6B21;gc&#x65F6;&#x5019;&#x518D;&#x6E05;&#x7406;&#x6389;&#xFF0C;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x5783;&#x573E;&#x5C31;&#x79F0;&#x4F5C;&quot;&#x6D6E;&#x52A8;&#x5783;&#x573E;&quot;&#xFF1B;&#x56E0;&#x6B64;CMS&#x6536;&#x96C6;&#x5668;&#x4E0D;&#x80FD;&#x50CF;&#x5176;&#x5B83;&#x6536;&#x96C6;&#x5668;&#x90A3;&#x6837;&#x7B49;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x51E0;&#x4E4E;&#x5B8C;&#x5168;&#x88AB;&#x586B;&#x6EE1;&#x4E86;&#x518D;&#x8FDB;&#x884C;&#x6536;&#x96C6;&#xFF0C;&#x800C;&#x662F;&#x9700;&#x8981;&#x9884;&#x7559;&#x4E00;&#x90E8;&#x5206;&#x7A7A;&#x95F4;&#x63D0;&#x9AD8;&#x5E76;&#x53D1;&#x6536;&#x96C6;&#x65F6;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x4F5C;&#x4F7F;&#x7528;&#x3002;</p>
</li>
<li><p><font color="red">CMS&#x662F;&#x57FA;&#x4E8E;(<code>mark-sweep</code>)&quot;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&quot;&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6536;&#x96C6;&#x7ED3;&#x675F;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6709;&#x5927;&#x91CF;&#x7684;<code>&#x7A7A;&#x95F4;&#x788E;&#x7247;</code>&#x4EA7;&#x751F;</font>&#x3002;&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x592A;&#x591A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C06;&#x4F1A;&#x7ED9;&#x5927;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x914D;&#x5E26;&#x6765;&#x5F88;&#x5927;&#x7684;&#x9EBB;&#x70E6;&#xFF0C;&#x5F80;&#x5F80;&#x4F1A;&#x51FA;&#x73B0;&#x8001;&#x5E74;&#x4EE3;&#x8FD8;&#x6709;&#x5F88;&#x5927;&#x7684;&#x7A7A;&#x95F4;&#x5269;&#x4F59;&#xFF0C;&#x4F46;&#x662F;&#x65E0;&#x6CD5;&#x627E;&#x5230;&#x8DB3;&#x591F;&#x5927;&#x7684;&#x8FDE;&#x7EED;&#x7A7A;&#x95F4;&#x6765;&#x5206;&#x914D;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x7684;&#xFF0C;&#x53EA;&#x80FD;&#x63D0;&#x524D;&#x89E6;&#x53D1;<code>full gc</code>&#x3002;</p>
</li>
</ol>
<p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;CMS&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5F00;&#x5173;&#x53C2;&#x6570;&#xFF08;<code>-XX: UseCMSCompactAtFullCollection</code>&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x5728;CMS&#x8981;&#x8FDB;&#x884C;full gc&#x7684;&#x65F6;&#x5019;&#x5F00;&#x542F;&#x5185;&#x5B58;&#x788E;&#x7247;&#x7684;&#x5408;&#x5E76;&#x6574;&#x7406;&#x8FC7;&#x7A0B;&#xFF0C;&#x5185;&#x5B58;&#x6574;&#x7406;&#x7684;&#x8FC7;&#x7A0B;&#x662F;&#x65E0;&#x6CD5;&#x5E76;&#x53D1;&#x7684;&#xFF0C;&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x6CA1;&#x6709;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x505C;&#x987F;&#x7684;&#x65F6;&#x95F4;&#x53D8;&#x957F;&#x4E86;&#x3002;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x53C2;&#x6570;(<code>-XX: CMSFullGCsBeforeCompaction</code>)&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;&#x6267;&#x884C;&#x591A;&#x5C11;&#x6B21;&#x4E0D;&#x538B;&#x7F29;&#x7684;full gc&#x540E;&#xFF0C;&#x8DDF;&#x7740;&#x6765;&#x4E00;&#x6B21;&#x5E26;&#x538B;&#x7F29;&#x7684;&#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;0&#xFF0C;&#x8868;&#x793A;&#x6BCF;&#x6B21;&#x8FDB;&#x5165;full gc&#x65F6;&#x90FD;&#x8FDB;&#x884C;&#x788E;&#x7247;&#x6574;&#x7406;&#xFF09;</p>
<h3 id="&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF08;gc&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF1A;dfs&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF09;">&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF08;gc&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF1A;dfs&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x7B97;&#x6CD5;&#xFF09;</h3>
<p>&#x628A;&#x904D;&#x5386;&#x5BF9;&#x8C61;&#x56FE;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x6309;&quot;&#x662F;&#x5426;&#x8BBF;&#x95EE;&#x8FC7;&quot;&#x8FD9;&#x4E2A;&#x6761;&#x4EF6;&#x6807;&#x8BB0;&#x6210;&#x4EE5;&#x4E0B;&#x4E09;&#x79CD;&#x989C;&#x8272;</p>
<ul>
<li>&#x767D;&#x8272;&#xFF1A;&#x5C1A;&#x672A;&#x8BBF;&#x95EE;&#x8FC7;</li>
<li>&#x7070;&#x8272;&#xFF1A;&#x6B63;&#x5728;&#x641C;&#x7D22;&#x7684;&#x5BF9;&#x8C61;&#xFF1A;&#x81EA;&#x5DF1;&#x6807;&#x8BB0;&#x5B8C;&#x6210;&#xFF0C;&#x5176;Fields&#x8FD8;&#x6CA1;&#x6709;&#x6807;&#x8BB0;&#x5B8C;&#x6210;</li>
<li>&#x9ED1;&#x8272;&#xFF1A;&#x641C;&#x7D22;&#x5B8C;&#x6210;&#x7684;&#x5BF9;&#x8C61;,&#x81EA;&#x5DF1;&#x548C;&#x5176;Fields&#x90FD;&#x6807;&#x8BB0;&#x5B8C;&#x6210;&#xFF08;&#x4E0D;&#x4F1A;&#x5F53;&#x6210;&#x5783;&#x573E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;GC&#xFF09;</li>
</ul>
<p>&#x904D;&#x5386;&#x6807;&#x8BB0;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<ol>
<li>&#x521D;&#x59CB;&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x90FD;&#x5728;&#x3010;&#x767D;&#x8272;&#x96C6;&#x5408;&#x3011;&#x4E2D;&#xFF1B;</li>
<li>&#x5C06;GC Roots &#x76F4;&#x63A5;&#x5F15;&#x7528;&#x5230;&#x7684;&#x5BF9;&#x8C61; &#x632A;&#x5230;&#x3010;&#x7070;&#x8272;&#x96C6;&#x5408;&#x3011;&#x4E2D;&#xFF1B;</li>
<li>&#x4ECE;&#x7070;&#x8272;&#x96C6;&#x5408;&#x4E2D;&#x83B7;&#x53D6;&#x5BF9;&#x8C61;&#xFF1A;<ul>
<li>&#x5C06;&#x672C;&#x5BF9;&#x8C61; &#x5F15;&#x7528;&#x5230;&#x7684; &#x5176;&#x4ED6;&#x5BF9;&#x8C61; &#x5168;&#x90E8;&#x632A;&#x5230; &#x3010;&#x7070;&#x8272;&#x96C6;&#x5408;&#x3011;&#x4E2D;&#xFF1B;</li>
<li>&#x5C06;&#x672C;&#x5BF9;&#x8C61; &#x632A;&#x5230; &#x3010;&#x9ED1;&#x8272;&#x96C6;&#x5408;&#x3011;&#x91CC;&#x9762;&#x3002;</li>
</ul>
</li>
<li>&#x91CD;&#x590D;&#x6B65;&#x9AA4;3&#xFF0C;&#x76F4;&#x81F3;&#x3010;&#x7070;&#x8272;&#x96C6;&#x5408;&#x3011;&#x4E3A;&#x7A7A;&#x65F6;&#x7ED3;&#x675F;&#x3002;</li>
<li>&#x6700;&#x540E;&#x4ECD;&#x5728;&#x3010;&#x767D;&#x8272;&#x96C6;&#x5408;&#x3011;&#x7684;&#x5BF9;&#x8C61;&#x5373;&#x4E3A;GC Roots &#x4E0D;&#x53EF;&#x8FBE;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#x3002;</li>
</ol>
<h4 id="&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x95EE;&#x9898;">&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x95EE;&#x9898;</h4>
<ul>
<li>&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF1A;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#x5E76;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x53EA;&#x662F;&#x9700;&#x8981;&#x7B49;&#x5230;&#x4E0B;&#x4E00;&#x8F6E;&#x5783;&#x573E;&#x56DE;&#x6536;&#x4E2D;&#x624D;&#x88AB;&#x6E05;&#x9664;&#x3002;</li>
<li><code>&#x591A;&#x6807;</code>&#x548C;<code>&#x6F0F;&#x6807;</code>&#x95EE;&#x9898;</li>
</ul>
<p>&#x5047;&#x8BBE;GC&#x7EBF;&#x7A0B;&#x5DF2;&#x7ECF;&#x904D;&#x5386;&#x5230;E&#xFF08;&#x53D8;&#x4E3A;&#x7070;&#x8272;&#x4E86;&#xFF09;&#xFF0C;&#x6B64;&#x65F6;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x5148;&#x6267;&#x884C;&#x4E86;&#xFF1A;</p>
<pre class="language-"><code class="lang-java"><span class="token keyword">var</span> <span class="token class-name">G</span> <span class="token operator">=</span> objE<span class="token punctuation">.</span>fieldG<span class="token punctuation">;</span>
objE<span class="token punctuation">.</span>fieldG <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// &#x7070;&#x8272;E &#x65AD;&#x5F00;&#x5F15;&#x7528; &#x767D;&#x8272;G</span>
objD<span class="token punctuation">.</span>fieldG <span class="token operator">=</span> <span class="token class-name">G</span><span class="token punctuation">;</span>  <span class="token comment">// &#x9ED1;&#x8272;D &#x5F15;&#x7528; &#x767D;&#x8272;G</span>
</code></pre>
<p><img src="imgs/cms_color.png" alt=""></p>
<p>&#x6B64;&#x65F6;&#x5207;&#x56DE;GC&#x7EBF;&#x7A0B;&#x7EE7;&#x7EED;&#x8DD1;&#xFF0C;&#x56E0;&#x4E3A;E&#x5DF2;&#x7ECF;&#x6CA1;&#x6709;&#x5BF9;G&#x7684;&#x5F15;&#x7528;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x4F1A;&#x5C06;G&#x653E;&#x5230;&#x7070;&#x8272;&#x96C6;&#x5408;&#xFF1B;&#x5C3D;&#x7BA1;&#x56E0;&#x4E3A;D&#x91CD;&#x65B0;&#x5F15;&#x7528;&#x4E86;G&#xFF0C;&#x4F46;&#x56E0;&#x4E3A;D&#x5DF2;&#x7ECF;&#x662F;&#x9ED1;&#x8272;&#x4E86;&#xFF0C;&#x662F;&#x4E0D;&#x4F1A;&#x518D;&#x91CD;&#x65B0;&#x505A;&#x904D;&#x5386;&#x5904;&#x7406;&#x3002;&#x6700;&#x7EC8;&#x7ED3;&#x5C40;&#x5C31;&#x662F;&#xFF1A;G&#x4F1A;&#x4E00;&#x76F4;&#x505C;&#x7559;&#x5728;&#x767D;&#x8272;&#x96C6;&#x5408;&#x4E2D;&#xFF0C;&#x6700;&#x540E;&#x88AB;&#x5F53;&#x4F5C;&#x5783;&#x573E;&#x8FDB;&#x884C;&#x6E05;&#x9664;&#x3002;&#x4F46;&#x662F;G&#x663E;&#x7136;&#x662F;&#x4E0D;&#x80FD;&#x88AB;&#x56DE;&#x6536;&#x7684;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5F71;&#x54CD;&#x5230;&#x4E86;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x662F;&#x4E0D;&#x53EF;&#x63A5;&#x53D7;&#x7684;&#x3002;</p>
<h5 id="&#x6F0F;&#x6807;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;">&#x6F0F;&#x6807;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;</h5>
<p>&#x6F0F;&#x6807;&#x53EA;&#x6709;&#x540C;&#x65F6;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#x65F6;&#x624D;&#x4F1A;&#x53D1;&#x751F;&#xFF1A;</p>
<ul>
<li>&#x6761;&#x4EF6;&#x4E00;&#xFF1A;&#x7070;&#x8272;&#x5BF9;&#x8C61; &#x65AD;&#x5F00;&#x4E86; &#x767D;&#x8272;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF1B;&#x5373;&#x7070;&#x8272;&#x5BF9;&#x8C61; &#x539F;&#x6765;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x7684;&#x5F15;&#x7528; &#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;&#x3002;</li>
<li>&#x6761;&#x4EF6;&#x4E8C;&#xFF1A;&#x9ED1;&#x8272;&#x5BF9;&#x8C61; &#x91CD;&#x65B0;&#x5F15;&#x7528;&#x4E86; &#x8BE5;&#x767D;&#x8272;&#x5BF9;&#x8C61;&#xFF1B;&#x5373;&#x9ED1;&#x8272;&#x5BF9;&#x8C61; &#x6210;&#x5458;&#x53D8;&#x91CF;&#x589E;&#x52A0;&#x4E86;&#x65B0;&#x7684;&#x5F15;&#x7528;&#x3002;</li>
</ul>
<p>&#x89E3;&#x51B3;</p>
<ul>
<li>inremental update &#x589E;&#x91CF;&#x66F4;&#x65B0;&#xFF1A;&#x5173;&#x6CE8;&#x5F15;&#x7528;&#x7684;&#x589E;&#x52A0;&#xFF0C;&#x5F53;&#x5BF9;&#x8C61;&#x589E;&#x52A0;&#x5F15;&#x7528;&#x65F6;&#x628A;&#x5BF9;&#x8C61;&#x91CD;&#x65B0;&#x6807;&#x8BB0;&#x4E3A;&#x7070;&#x8272;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E0B;&#x4E00;&#x6B21;&#x91CD;&#x65B0;&#x626B;&#x63CF;&#xFF08;&#x5373;&#x9ED1;&#x8272;&#x65B0;&#x589E;&#x5F15;&#x7528;&#xFF0C;&#x628A;&#x9ED1;&#x8272;&#x518D;&#x6B21;&#x53D8;&#x6210;&#x7070;&#x8272;&#xFF09;&#xFF1B;&#xFF08;CMS &#x4F7F;&#x7528;&#xFF09;</li>
<li>SATB Snapshot At The Beginning &#x5F00;&#x59CB;&#x5FEB;&#x7167;&#xFF0C;&#x5173;&#x6CE8;&#x5F15;&#x7528;&#x7684;&#x5220;&#x9664;&#xFF0C;&#x5F53;&#x5220;&#x9664;&#x5F15;&#x7528;&#x65F6;&#x628A;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#x63A8;&#x7ED9;GC&#x7684;&#x5806;&#x6808;&#xFF0C;&#x8BA9;GC&#x53EF;&#x4EE5;&#x8FD8;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#xFF1B;&#xFF08;G1&#x4F7F;&#x7528;&#xFF09;</li>
</ul>
<h4 id="cms&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x548C;remark">CMS&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x548C;<code>remark</code></h4>
<ul>
<li>&#x5199;&#x5C4F;&#x969C;(&#x8BFB;&#x5199;&#x524D;&#x540E;&#xFF0C;&#x5C06;&#x5BF9;&#x8C61;G&#x7ED9;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;) + &#x589E;&#x91CF;&#x66F4;&#x65B0;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token keyword">var</span> <span class="token class-name">G</span> <span class="token operator">=</span> objE<span class="token punctuation">.</span>fieldG<span class="token punctuation">;</span> <span class="token comment">// 1.&#x8BFB;&#xFF0C;&#x8BFB;&#x5C4F;&#x969C;</span>
objE<span class="token punctuation">.</span>fieldG <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// 2.&#x5199;&#xFF0C;&#x5199;&#x5C4F;&#x969C;</span>
objD<span class="token punctuation">.</span>fieldG <span class="token operator">=</span> <span class="token class-name">G</span><span class="token punctuation">;</span>     <span class="token comment">// 3.&#x5199;&#xFF0C;&#x5199;&#x5C4F;&#x969C;</span>
</code></pre>
<font color="red">CMS&#x6709;`remark`&#xFF0C;&#x4ECE;&#x5934;&#x5230;&#x5C3E;&#x626B;&#x63CF;&#x4E00;&#x904D;</font>

<h4 id="&#x6269;&#x5C55;&#xFF1A;g1&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x5199;&#x5C4F;&#x969C;--snapshot-at-the-begining">&#x6269;&#x5C55;&#xFF1A;G1&#x89E3;&#x51B3;&#x65B9;&#x6CD5;(&#x5199;&#x5C4F;&#x969C; + Snapshot At the begining)</h4>
<p>&#x5757;(RSet) &#x914D;&#x5408; SATB &#x89E3;&#x51B3;&#xFF08;&#x5C06;&#x5F15;&#x7528;&#x5173;&#x7CFB;&#x4E2D;&#x8F6C;&#x5230;GC&#x7684;&#x5806;&#x6808;&#x4E2D;&#xFF09;</p>
<h2 id="g1garbage-first&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;">G1(Garbage First)&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;</h2>
<h3 id="&#x53C2;&#x8003;&#x5B66;&#x4E60;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x5B66;&#x4E60;&#x6587;&#x6863;</h3>
<p>&#x53C2;&#x8003;&#x5B66;&#x4E60;1: <a target="_blank" href="https://tech.meituan.com/2016/09/23/g1.html">&#x7F8E;&#x56E2;&#x6280;&#x672F;&#x6587;&#x7AE0;</a></p>
<p>&#x53C2;&#x8003;&#x5B66;&#x4E60;2: <a target="_blank" href="https://www.oracle.com/technetwork/tutorials/tutorials-1876574.html">oracle g1 document</a></p>
<p>&#x53C2;&#x8003;&#x5B66;&#x4E60;3: <a target="_blank" href="https://blogs.oracle.com/poonam/understanding-g1-gc-logs">g1 log</a></p>
<h3 id="g1&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;">G1&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;</h3>
<ul>
<li><p>Can operate concurrently with applications threads like the CMS collector.
&#xFF08;&#x80FD;&#x591F;&#x50CF;CMS&#x6536;&#x96C6;&#x5668;&#x4E00;&#x6837;&#x8DDF;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x7684;&#x53BB;&#x6267;&#x884C;&#x3002;&#x3010;CMS&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5E76;&#x53D1;&#x7684;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;GC&#x7EBF;&#x7A0B;&#x4E0E;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x95F4;&#x6267;&#x884C;&#x3011;&#xFF09;</p>
</li>
<li><p>Compact free space without lengthy GC induced pause times.
&#xFF08;&#x53EF;&#x4EE5;&#x538B;&#x7F29;&#x53EF;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x8BA9;GC&#x5F15;&#x8D77;&#x6682;&#x505C;&#x65F6;&#x95F4;&#x8FC7;&#x957F;&#x3002;&#xFF09;</p>
</li>
<li><p>Need more predictable GC pause durations.
&#xFF08;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x53EF;&#x9884;&#x6D4B;&#x7684;GC&#x6682;&#x505C;&#x7684;&#x95F4;&#x9694;&#x3002;&#x3010;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;GC&#x6682;&#x505C;&#x7684;&#x65F6;&#x95F4;&#x4F1A;&#x5C3D;&#x91CF;&#x5F80;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;&#x7684;&#x6682;&#x65F6;&#x65F6;&#x95F4;&#x6765;&#x9760;&#x3011;&#xFF09;</p>
</li>
<li><p>Do not want to sacrifice a lot of throughput performance.
&#xFF08;&#x4E0D;&#x60F3;&#x727A;&#x7272;&#x5927;&#x91CF;&#x541E;&#x5410;&#x6027;&#x80FD;&#x3002;&#xFF09;</p>
</li>
<li><p>Do not require a much larger Java heap.
&#xFF08;&#x4E0D;&#x60F3;&#x9700;&#x8981;&#x5927;&#x91CF;Java&#x7684;&#x5806;&#x7A7A;&#x95F4;&#x3002;&#xFF09;</p>
</li>
</ul>
<h3 id="g1-&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5206;&#x5E03;&#x56FE;&#x548C;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;">G1 &#x5185;&#x5B58;&#x533A;&#x57DF;&#x5206;&#x5E03;&#x56FE;&#x548C;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;</h3>
<p><img src="imgs/g1.png" alt=""></p>
<ul>
<li><p>&#x6574;&#x4E2A;&#x5806;&#x88AB;&#x5206;&#x4E3A;&#x4E00;&#x4E2A;&#x5927;&#x5C0F;&#x76F8;&#x7B49;&#x7684;region&#x96C6;&#x5408;&#xFF0C;&#x6BCF;&#x4E2A;region&#x662F;&#x903B;&#x8F91;&#x4E0A;&#x8FDE;&#x7EED;&#x7684;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF1B;</p>
</li>
<li><p>&#x8FD9;&#x4E9B;region&#x6709;eden,survivor,old&#x7684;&#x6982;&#x5FF5;(&#x5373;&#x903B;&#x8F91;&#x4E0A;&#x662F;&#x5206;&#x4EE3;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x7269;&#x7406;&#x4E0A;&#x4E0D;&#x5206;&#x4EE3;&#xFF0C;&#x662F;&#x5927;&#x5C0F;&#x76F8;&#x7B49;&#x7684;region&#x533A;&#x57DF;)&#xFF1B;G1&#x7684;&#x5404;&#x4EE3;&#x5B58;&#x50A8;&#x5730;&#x5740;&#x662F;&#x4E0D;&#x8FDE;&#x7EED;&#x7684;&#xFF0C;&#x6BCF;&#x4E00;&#x4EE3;&#x90FD;&#x4F7F;&#x7528;&#x4E86;n&#x4E2A;&#x4E0D;&#x8FDE;&#x7EED;&#x7684;&#x5927;&#x5C0F;&#x76F8;&#x540C;&#x7684;Region&#xFF1B;&#x5E74;&#x8F7B;&#x4EE3;&#xFF08;eden + survivor&#xFF09;&#xFF0C;&#x5E74;&#x8001;&#x4EE3;&#xFF08;old + humongous&#xFF09;</p>
</li>
<li><p>Humongous&#x533A;&#x57DF;&#xFF1A;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5360;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#x8D85;&#x8FC7;&#x4E86;region&#x5BB9;&#x91CF;(<code>region size</code>)50%&#x4EE5;&#x4E0A;&#xFF0C;G1&#x6536;&#x96C6;&#x5668;&#x5C31;&#x8BA4;&#x4E3A;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5DE8;&#x578B;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x4E9B;&#x5DE8;&#x578B;&#x5BF9;&#x8C61;&#xFF0C;&#x9ED8;&#x8BA4;&#x76F4;&#x63A5;&#x4F1A;&#x88AB;&#x5206;&#x914D;&#x5728;<code>old</code>region&#xFF0C;&#x4E3A;&#x4E86;&#x80FD;&#x627E;&#x5230;&#x8FDE;&#x7EED;&#x7684;region&#x6765;&#x5206;&#x914D;&#x5DE8;&#x578B;&#x5BF9;&#x8C61;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x4E0D;&#x5F97;&#x4E0D;&#x542F;&#x52A8;Full GC</p>
<ol>
<li>H-obj&#x76F4;&#x63A5;&#x5206;&#x914D;&#x5230;&#x4E86;old gen&#xFF0C;&#x9632;&#x6B62;&#x4E86;&#x53CD;&#x590D;&#x62F7;&#x8D1D;&#x79FB;&#x52A8;</li>
<li>H-obj&#x5728;<code>global concurrent marking</code>&#x9636;&#x6BB5;&#x7684;<code>cleanup</code> &#x548C; <code>full GC</code>&#x9636;&#x6BB5;&#x56DE;&#x6536;</li>
<li>&#x5728;&#x5206;&#x914D;H-obj&#x4E4B;&#x524D;&#x5148;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x8D85;&#x8FC7; <code>initiating heap occupancy percent</code>&#x548C;<code>the marking threshold</code>, &#x5982;&#x679C;&#x8D85;&#x8FC7;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x542F;&#x52A8;<code>global concurrent marking</code>&#xFF0C;&#x4E3A;&#x7684;&#x662F;&#x63D0;&#x65E9;&#x56DE;&#x6536;&#xFF0C;&#x9632;&#x6B62; <code>evacuation failures</code> &#x548C; <code>full GC</code>&#x3002;</li>
</ol>
</li>
</ul>
<p>When performing garbage collections, G1 operates in a manner similar to the CMS collector. G1 performs a concurrent global marking phase to determine the liveness of objects throughout the heap. After the mark phase completes, G1 knows which regions are mostly empty. It collects in these regions first, which usually yields a large amount of free space. This is why this method of garbage collection is called Garbage-First.As the name suggests, G1 concentrates its collection and compaction activity on the areas of the heap that are likely to be full of reclaimable objects, that is, garbage. G1 uses a pause prediction model to meet a user-defined pause time target and selects the number of regions to collect based on the specified pause time target.
&#xFF08;&#x6982;&#x62EC;&#x8D77;&#x6765;&#xFF1A;&#x4ECD;&#x7136;&#x7C7B;&#x4F3C;CMS&#x91C7;&#x7528;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#xFF0C;&#x4E0D;&#x8FC7;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x4E0D;&#x662F;&#x56DE;&#x6536;&#x5168;&#x90E8;&#xFF0C;&#x800C;&#x662F;&#x5BF9;&#x90A3;&#x4E9B;&#x5783;&#x573E;&#x8F83;&#x591A;&#x7684;region&#x533A;&#x57DF;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#xFF1B;&#x6839;&#x636E;&#x6B64;&#x6B21;&#x56DE;&#x6536;&#x53EF;&#x4EE5;&#x5BF9;&#x4E0B;&#x6B21;&#x56DE;&#x6536;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;&#x9884;&#x6D4B;&#xFF09;</p>
<h3 id="g1-&#x5E38;&#x7528;&#x53C2;&#x6570;">G1 &#x5E38;&#x7528;&#x53C2;&#x6570;</h3>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;</th>
<th>&#x542B;&#x4E49;</th>
</tr>
</thead>
<tbody>
<tr>
<td>-XX:G1HeapRegionSize=n</td>
<td>&#x8BBE;&#x7F6E;Region&#x5927;&#x5C0F;&#xFF0C;&#x5E76;&#x975E;&#x6700;&#x7EC8;&#x503C;</td>
</tr>
<tr>
<td>-XX:MaxGCPauseMillis</td>
<td>&#x8BBE;&#x7F6E;G1&#x6536;&#x96C6;&#x8FC7;&#x7A0B;&#x76EE;&#x6807;&#x65F6;&#x95F4;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;200ms&#xFF0C;&#x4E0D;&#x662F;&#x786C;&#x6027;&#x6761;&#x4EF6;</td>
</tr>
<tr>
<td>-XX:G1NewSizePercent</td>
<td>&#x65B0;&#x751F;&#x4EE3;&#x6700;&#x5C0F;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;5%</td>
</tr>
<tr>
<td>-XX:G1MaxNewSizePercent</td>
<td>&#x65B0;&#x751F;&#x4EE3;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;60%</td>
</tr>
<tr>
<td>-XX:ParallelGCThreads</td>
<td>STW&#x671F;&#x95F4;&#xFF0C;&#x5E76;&#x884C;GC&#x7EBF;&#x7A0B;&#x6570;</td>
</tr>
<tr>
<td>-XX:ConcGCThreads=n</td>
<td>&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF0C;&#x5E76;&#x884C;&#x6267;&#x884C;&#x7684;&#x7EBF;&#x7A0B;&#x6570;</td>
</tr>
<tr>
<td>-XX:InitiatingHeapOccupancyPercent</td>
<td>&#x8BBE;&#x7F6E;&#x89E6;&#x53D1;&#x6807;&#x8BB0;&#x5468;&#x671F;&#x7684; Java &#x5806;&#x5360;&#x7528;&#x7387;&#x9608;&#x503C;&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x662F;45%&#x3002;&#x8FD9;&#x91CC;&#x7684;Java&#x5806;&#x5360;&#x6BD4;&#x6307;&#x7684;&#x662F;non_young_capacity_bytes&#xFF0C;&#x5305;&#x62EC;old+humongous</td>
</tr>
</tbody>
</table>
<ul>
<li>&#x5982;&#x4E0B;&#x4E00;&#x4E2A;&#x7EBF;&#x4E0A;&#x914D;&#x7F6E;(&#x673A;&#x5668;<code>2C4G</code>)&#x4F8B;&#x5B50;&#xFF1A;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token operator">-</span><span class="token class-name">Xms2700M</span> <span class="token operator">-</span><span class="token class-name">Xmx2700M</span> <span class="token operator">-</span><span class="token class-name">Xss512K</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxDirectMemorySize</span><span class="token operator">=</span><span class="token number">512</span>M

<span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseG1GC</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxGCPauseMillis</span><span class="token operator">=</span><span class="token number">200</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ParallelGCThreads</span><span class="token operator">=</span><span class="token number">4</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">ConcGCThreads</span><span class="token operator">=</span><span class="token number">2</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">InitiatingHeapOccupancyPercent</span><span class="token operator">=</span><span class="token number">70</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxMetaspaceSize</span><span class="token operator">=</span><span class="token number">500</span>m <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCDetails</span>
</code></pre>
<h3 id="remember-set--collection-set">Remember Set &amp; Collection Set</h3>
<ul>
<li>headpRegion.cpp &#x90E8;&#x5206;&#x5B9E;&#x73B0;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token comment">// Minimum region size; we won&apos;t go lower than that.</span>
<span class="token comment">// We might want to decrease this in the future, to deal with small</span>
<span class="token comment">// heaps a bit more efficiently.</span>
#define MIN_REGION_SIZE  <span class="token punctuation">(</span>      <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token punctuation">)</span>

<span class="token comment">// Maximum region size; we don&apos;t go higher than that. There&apos;s a good</span>
<span class="token comment">// reason for having an upper bound. We don&apos;t want regions to get too</span>
<span class="token comment">// large, otherwise cleanup&apos;s effectiveness would decrease as there</span>
<span class="token comment">// will be fewer opportunities to find totally empty regions after</span>
<span class="token comment">// marking.</span>
#define MAX_REGION_SIZE  <span class="token punctuation">(</span> <span class="token number">32</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token punctuation">)</span>

<span class="token comment">// The automatic region size calculation will try to have around this</span>
<span class="token comment">// many regions in the heap (based on the min heap size).</span>
#define TARGET_REGION_NUMBER          <span class="token number">2048</span>

size_t <span class="token class-name">HeapRegion</span><span class="token operator">::</span><span class="token function">max_region_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>size_t<span class="token punctuation">)</span>MAX_REGION_SIZE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x8BA1;&#x7B97;region&#x7684;&#x6838;&#x5FC3;&#x5B9E;&#x73B0;</span>
<span class="token keyword">void</span> <span class="token class-name">HeapRegion</span><span class="token operator">::</span><span class="token function">setup_heap_region_size</span><span class="token punctuation">(</span>size_t initial_heap_size<span class="token punctuation">,</span> size_t max_heap_size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  uintx region_size <span class="token operator">=</span> <span class="token class-name">G1HeapRegionSize</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x662F;&#x5426;&#x8BBE;&#x7F6E;&#x4E86;G1HeapRegionSize&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x914D;&#x7F6E;&#xFF0C;&#x90A3;&#x4E48;&#x6309;&#x7167;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x8BA1;&#x7B97;&#xFF1B;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;G1HeapRegionSize&#x5C31;&#x6309;&#x7167;&#x8BBE;&#x7F6E;&#x7684;&#x503C;&#x8BA1;&#x7B97;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FLAG_IS_DEFAULT</span><span class="token punctuation">(</span><span class="token class-name">G1HeapRegionSize</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// average_heap_size&#x5373;&#x5E73;&#x5747;&#x5806;&#x7684;&#x5927;&#x5C0F;&#xFF0C;(&#x521D;&#x59CB;&#x5316;&#x5806;&#x7684;&#x5927;&#x5C0F;&#x5373;Xms+&#x6700;&#x5927;&#x5806;&#x7684;&#x5927;&#x5C0F;&#x5373;Xmx)/2</span>
    size_t average_heap_size <span class="token operator">=</span> <span class="token punctuation">(</span>initial_heap_size <span class="token operator">+</span> max_heap_size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">// average_heap_size&#x9664;&#x4EE5;&#x671F;&#x671B;&#x7684;REGION&#x6570;&#x91CF;&#x5F97;&#x5230;&#x6BCF;&#x4E2A;REGION&#x7684;SIZE&#xFF0C;&#x4E0E;MIN_REGION_SIZE&#x53D6;&#x4E24;&#x8005;&#x4E2D;&#x7684;&#x66F4;&#x5927;&#x503C;&#x5C31;&#x662F;&#x5B9E;&#x9645;&#x7684;REGION_SIZE&#xFF1B;&#x4ECE;&#x8FD9;&#x4E2A;&#x8BA1;&#x7B97;&#x516C;&#x5F0F;&#x53EF;&#x77E5;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5982;&#x679C;JVM&#x5806;&#x5728;2G&#xFF08;TARGET_REGION_NUMBER*MIN_REGION_SIZE&#xFF09;&#x4EE5;&#x4E0B;&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x4E2A;REGION_SIZE&#x90FD;&#x662F;1M&#xFF1B;</span>
    region_size <span class="token operator">=</span> <span class="token function">MAX2</span><span class="token punctuation">(</span>average_heap_size <span class="token operator">/</span> TARGET_REGION_NUMBER<span class="token punctuation">,</span> <span class="token punctuation">(</span>uintx<span class="token punctuation">)</span> MIN_REGION_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// region_size&#x7684;&#x5BF9;&#x6570;&#x503C;</span>
  <span class="token keyword">int</span> region_size_log <span class="token operator">=</span> <span class="token function">log2_long</span><span class="token punctuation">(</span><span class="token punctuation">(</span>jlong<span class="token punctuation">)</span> region_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x91CD;&#x65B0;&#x8BA1;&#x7B97;region_size&#xFF0C;&#x786E;&#x4FDD;&#x5B83;&#x662F;&#x6700;&#x5927;&#x7684;&#x5C0F;&#x4E8E;&#x6216;&#x7B49;&#x4E8E;region_size&#x7684;2&#x7684;N&#x6B21;&#x65B9;&#x7684;&#x6570;&#x503C;&#xFF0C;&#x4F8B;&#x5982;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x524D;region_size=33&#xFF0C;&#x90A3;&#x4E48;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x540E;region_size=32&#xFF1B;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x524D;region_size=16&#xFF0C;&#x90A3;&#x4E48;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x540E;region_size=16&#xFF1B;</span>
  <span class="token comment">// Recalculate the region size to make sure it&apos;s a power of</span>
  <span class="token comment">// 2. This means that region_size is the largest power of 2 that&apos;s</span>
  <span class="token comment">// &lt;= what we&apos;ve calculated so far.</span>
  region_size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>uintx<span class="token punctuation">)</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> region_size_log<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// &#x786E;&#x4FDD;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x7684;region_size&#x4E0D;&#x80FD;&#x6BD4;MIN_REGION_SIZE&#x66F4;&#x5C0F;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x6BD4;MAX_REGION_SIZE&#x66F4;&#x5927;</span>
  <span class="token comment">// Now make sure that we don&apos;t go over or under our limits.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>region_size <span class="token operator">&lt;</span> MIN_REGION_SIZE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    region_size <span class="token operator">=</span> MIN_REGION_SIZE<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>region_size <span class="token operator">&gt;</span> MAX_REGION_SIZE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    region_size <span class="token operator">=</span> MAX_REGION_SIZE<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// &#x4E0E;MIN_REGION_SIZE&#x548C;MAX_REGION_SIZE&#x6BD4;&#x8F83;&#x540E;&#xFF0C;&#x518D;&#x6B21;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;region_size</span>
  <span class="token comment">// And recalculate the log.</span>
  region_size_log <span class="token operator">=</span> <span class="token function">log2_long</span><span class="token punctuation">(</span><span class="token punctuation">(</span>jlong<span class="token punctuation">)</span> region_size<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li><p>region size: <code>1M-32M</code>,&#x901A;&#x8FC7;<code>-XX:G1HeapRegionSize</code>&#x53EF;&#x6307;&#x5B9A;</p>
</li>
<li><p>G1&#x7684;&#x6BCF;&#x4E2A;<code>region</code>&#x90FD;&#x6709;&#x4E00;&#x4E2A;<code>Remember Set(RSet)</code>&#xFF0C;&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x522B;&#x7684;<code>region</code>&#x7684;&#x5BF9;&#x8C61;&#x5BF9;&#x8BE5;region&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x901A;&#x8FC7;<code>Remember Set</code>&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x54EA;&#x4E9B;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x4E86;&#x5F53;&#x524D;<code>region</code>&#x91CC;&#x9762;&#x7684;&#x5BF9;&#x8C61;&#xFF1B;<code>Collection Set</code>&#x5219;&#x8868;&#x793A;&#x672C;&#x6B21;&#x5783;&#x573E;&#x6E05;&#x7406;&#x7684;region&#x96C6;&#x5408;</p>
</li>
</ul>
<p>This allows the GC to avoid collecting the entire heap at once, and instead approach the problem incrementally: only a subset of the regions, called the collection set will be considered at a time.&#xFF08;&#x907F;&#x514D;&#x4E00;&#x6B21;&#x5BF9;&#x6574;&#x4E2A;&#x5806;&#x7684;&#x5783;&#x573E;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x6B21;&#x56DE;&#x6536;&#x79F0;&#x4E3A;<code>collection set</code>&#x7684;&#x90E8;&#x5206;&#xFF0C;<code>collection set</code>&#x5C31;&#x662F;&#x5783;&#x573E;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x90A3;&#x4E9B;<code>region</code>&#xFF09;</p>
<ul>
<li>&#x88AB;&#x56DE;&#x6536;&#x7684;region&#x53EF;&#x4EE5;&#x590D;&#x5236;&#x5230;&#x7A7A;&#x7684;region,&#x6216;&#x8005;&#x590D;&#x5236;&#x5230;survivor&#x533A;&#x57DF;&#xFF0C;&#x540C;&#x65F6;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x538B;&#x7F29;&#xFF08;&#x590D;&#x5236;&#x6548;&#x7387;&#x9AD8;&#xFF0C;&#x5E76;&#x4E14;&#x51CF;&#x5C11;&#x4E86;&#x788E;&#x7247;&#xFF09;</li>
</ul>
<h3 id="satb&#xFF08;snapshot-at-the-beginning&#xFF09;">SATB&#xFF08;Snapshot-At-The-Beginning&#xFF09;</h3>
<p>&#x662F;GC&#x5F00;&#x59CB;&#x65F6;&#x6D3B;&#x7740;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x5FEB;&#x7167;&#x3002;&#x5B83;&#x662F;&#x901A;&#x8FC7;Root Tracing&#x5F97;&#x5230;&#x7684;&#xFF0C;&#x4F5C;&#x7528;&#x662F;&#x7EF4;&#x6301;&#x5E76;&#x53D1;GC&#x7684;&#x6B63;&#x786E;&#x6027;&#x3002;&#x7ED3;&#x5408;<code>&#x4E09;&#x8272;&#x6807;&#x8BB0;</code></p>
<h3 id="g1&#x7684;gc">G1&#x7684;GC</h3>
<p><strong>Note:</strong> G1 has both concurrent (runs along with application threads, e.g., refinement, marking, cleanup) and parallel (multi-threaded, e.g., stop the world) phases. Full garbage collections are still single threaded, but if tuned properly your applications should avoid full GCs.</p>
<h4 id="young-gcminor-gc&#x5BF9;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;gc">young gc/minor gc(&#x5BF9;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;GC)</h4>
<p>Live objects are evacuated to one or more survivor regions. If the aging threshold is met, some of the objects are promoted to old generation regions.</p>
<p>(young gc&#x7684;&#x5904;&#x7406;&#x6548;&#x679C;&#x5C31;&#x662F;&#xFF1A;&#x5B58;&#x6D3B;&#x5728;<code>Eden</code>&#x7684;&#x5BF9;&#x8C61;&#x4F1A;&#x8FDB;&#x5165;<code>survivor</code>&#x533A;&#x57DF;&#xFF0C;&#x5982;&#x679C;&#x8FBE;&#x5230;aging&#x9608;&#x503C;&#x5219;&#x8FDB;&#x5165;&#x5230;<code>old</code>&#x533A;&#x57DF;&#xFF09;</p>
<p>This is a stop the world (STW) pause. Eden size and survivor size is calculated for the next young GC. Accounting information is kept to help calculate the size. Things like the pause time goal are taken into consideration.</p>
<p>This approach makes it very easy to resize regions, making them bigger or smaller as needed.</p>
<p>&#xFF08;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;stop the world&#x7684;&#x505C;&#x987F;,<code>eden</code>&#x548C;<code>survivor</code>&#x533A;&#x57DF;&#x4F1A;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x5206;&#x914D;&#xFF0C;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x662F;&#x8981;&#x8003;&#x8651;&#x5230;&#x7684;&#xFF09;</p>
<h4 id="mixed-gcyoung-&#x548C;-old&#x90FD;gc">mixed gc(young &#x548C; old&#x90FD;gc)</h4>
<h5 id="mix-gc&#x7684;&#x8FC7;&#x7A0B;">mix gc&#x7684;&#x8FC7;&#x7A0B;</h5>
<table>
<thead>
<tr>
<th style="text-align:center">Phase</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">(1) Initial Mark (Stop the World)</td>
<td style="text-align:center">This is a stop the world event. With G1, it is piggybacked on a normal young GC. Mark survivor regions (root regions) which may have references to objects in old generation.</td>
</tr>
<tr>
<td style="text-align:center">(2) Root Region Scanning</td>
<td style="text-align:center">Scan survivor regions for references into the old generation. This happens while the application continues to run. The phase must be completed before a young GC can occur.</td>
</tr>
<tr>
<td style="text-align:center">(3) Concurrent Marking</td>
<td style="text-align:center">Find live objects over the entire heap. This happens while the application is running. This phase can be interrupted by young generation garbage collections.</td>
</tr>
<tr>
<td style="text-align:center">(4) Remark(Stop the World)</td>
<td style="text-align:center">Completes the marking of live object in the heap. Uses an algorithm called snapshot-at-the-beginning (SATB) which is much faster than what was used in the CMS collector.</td>
</tr>
<tr>
<td style="text-align:center">(5) Cleanup(Stop the World Event and Concurrent)</td>
<td style="text-align:center"><em> Performs accounting on live objects and completely free regions. (Stop the World); </em> Scrubs the Remembered Sets. (Stop the world); * Reset the empty regions and return them to the free list. (Concurrent)</td>
</tr>
<tr>
<td style="text-align:center">(*) Copying (Stop the World)</td>
<td style="text-align:center">These are the stop the world pauses to evacuate or copy live objects to new unused regions. This can be done with young generation regions which are logged as [GC pause (young)]. Or both young and old generation regions which are logged as [GC Pause (mixed)].</td>
</tr>
</tbody>
</table>
<ul>
<li>Concurrent Marking(&#x5E76;&#x53D1;&#x6807;&#x8BB0;)&#x5BF9;&#x6BD4;CMS&#xFF0C;&#x6807;&#x8BB0;&#x626B;&#x63CF;&#x7684;region&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0A;&#x4E00;&#x6B65;Root Region&#x626B;&#x63CF;&#x6392;&#x9664;&#x4E86;&#x54EA;&#x4E9B;&#x6709;&#x6839;&#x5BF9;&#x8C61;&#x5E94;&#x7528;&#x7684;region</li>
<li>Remark(&#x91CD;&#x65B0;&#x6807;&#x8BB0;)&#x5BF9;&#x6BD4;CMS&#xFF0C;&#x4F7F;&#x7528;&#x66F4;&#x5FEB;&#x7684;SATB</li>
<li>Cleanup(&#x6E05;&#x7406;)&#xFF0C;Stop-The-World&#xFF0C;&#x91C7;&#x7528;&#x590D;&#x5236;&#x6E05;&#x7406;&#xFF0C;&#x53EA;&#x6E05;&#x7406;&#x5783;&#x573E;&#x591A;&#x7684;region</li>
</ul>
<h5 id="initial-marking-phase&#x521D;&#x59CB;&#x6807;&#x8BB0;&#xFF0C;stw">Initial Marking Phase(&#x521D;&#x59CB;&#x6807;&#x8BB0;&#xFF0C;STW)</h5>
<p>Initial marking of live object is piggybacked on a young generation garbage collection.(&#x6807;&#x8BB0;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;)</p>
<p>gc log: <code>(young) (initial-mark)</code></p>
<h5 id="concurrent-marking-phase&#xFF08;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#xFF1A;&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF0C;&#x4E0E;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF09;">Concurrent Marking Phase&#xFF08;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#xFF1A;&#x4E09;&#x8272;&#x6807;&#x8BB0;&#xFF0C;&#x4E0E;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF09;</h5>
<p>If empty regions are found (as denoted by the &quot;X&quot;), they are removed immediately in the Remark phase. Also, &quot;accounting&quot; information that determines liveness is calculated.
&#xFF08;&#x7A7A;&#x533A;&#x57DF;&#x4F1A;&#x7ACB;&#x523B;&#x88AB;&#x6807;&#x8BB0;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4F1A;&#x8BA1;&#x7B97;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#xFF09;</p>
<h6 id="&#x4E09;&#x8272;&#x6807;&#x8BB0;&#x8865;&#x5145;">&#x4E09;&#x8272;&#x6807;&#x8BB0;(&#x8865;&#x5145;)</h6>
<p>&#x56F0;&#x96BE;&#x70B9;&#xFF1A;&#x5728;&#x6807;&#x8BB0;&#x5BF9;&#x8C61;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5F15;&#x7528;&#x5173;&#x7CFB;&#x4E5F;&#x6B63;&#x53D1;&#x751F;&#x7740;&#x53D8;&#x5316;</p>
<ol>
<li>&#x767D;&#x8272;&#xFF1A;&#x6CA1;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x7070;&#x8272;&#xFF1A;&#x81EA;&#x8EAB;&#x88AB;&#x6807;&#x8BB0;&#xFF0C;&#x6210;&#x5458;&#x672A;&#x88AB;&#x6807;&#x8BB0;</li>
<li>&#x9ED1;&#x8272;&#xFF1A;&#x81EA;&#x8EAB;&#x88AB;&#x548C;&#x6210;&#x5458;&#x90FD;&#x88AB;&#x6807;&#x8BB0;&#x5B8C;&#x6210;&#x4E86;</li>
</ol>
<p><img src="imgs/three_color.png" alt=""></p>
<p>&#x4ECE;&#x5DE6;&#x8FB9;&#x53D8;&#x6210;&#x53F3;&#x8FB9;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x4E24;&#x4E2A;&#x53D8;&#x5316;</p>
<ol>
<li>B-&gt;D &#x5F15;&#x7528;&#x6D88;&#x5931;</li>
<li>A-&gt;D &#x5F15;&#x7528;&#x65B0;&#x589E;</li>
</ol>
<p>&#x8FD9;&#x6837;&#x4E0B;&#x6B21;&#x626B;&#x63CF;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7531;&#x4E8E;A&#x662F;&#x9ED1;&#x8272;&#xFF0C;&#x5219;A&#x7684;&#x5F15;&#x7528;&#x4E0D;&#x4F1A;&#x7406;&#x4F1A;&#xFF1B;B,C&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F15;&#x7528;&#x4E86;&#xFF1B;&#x8FD9;&#x6837;&#x5BFC;&#x81F4;D&#x6F0F;&#x6807;&#x4E86;&#xFF0C;&#x5373;D&#x88AB;&#x5F53;&#x6210;&#x5783;&#x573E;&#x4E86;</p>
<p>G1 snapshot at the begining,&#x5173;&#x6CE8;&#x5F15;&#x7528;&#x7684;&#x5220;&#x9664;&#xFF1A;&#x5F53;B-&gt;D&#x6D88;&#x5931;&#x65F6;&#xFF0C;&#x8981;&#x628A;&#x8FD9;&#x79CD;&#x5F15;&#x7528;&#x4FDD;&#x5B58;&#x5230;GC&#x6808;&#xFF0C;&#x4FDD;&#x8BC1;&#x4E0B;&#x6B21;D&#x8981;&#x88AB;&#x626B;&#x63CF;&#x5230;(&#x914D;&#x5408;<code>Remember Set</code>)</p>
<h5 id="remark-phase&#xFF08;&#x6700;&#x7EC8;&#x6807;&#x8BB0;&#xFF0C;stw-cpu&#x505C;&#x987F;&#x5904;&#x7406;&#x5783;&#x573E;&#xFF09;">Remark Phase&#xFF08;&#x6700;&#x7EC8;&#x6807;&#x8BB0;&#xFF0C;STW, CPU&#x505C;&#x987F;&#x5904;&#x7406;&#x5783;&#x573E;&#xFF09;</h5>
<p>Empty regions are removed and reclaimed. Region liveness is now calculated for all regions.
&#xFF08;&#x7A7A;&#x533A;&#x57DF;&#x4F1A;&#x88AB;&#x5220;&#x9664;&#x53EF;&#x4EE5;&#x8BA9;&#x91CD;&#x65B0;&#x5206;&#x914D;&#xFF0C;&#x6240;&#x6709;&#x533A;&#x57DF;&#x7684;liveness&#x4F1A;&#x8BA1;&#x7B97;&#xFF09;</p>
<h5 id="copyingcleanup-phase&#xFF08;&#x7B5B;&#x9009;&#x90E8;&#x5206;region&#x56DE;&#x6536;&#xFF0C;&#x800C;&#x975E;&#x5168;&#x90E8;&#x56DE;&#x6536;&#xFF1B;stw&#xFF1A;&#x6839;&#x636E;&#x7528;&#x6237;&#x671F;&#x671B;&#x7684;gc&#x505C;&#x987F;&#x65F6;&#x95F4;&#x56DE;&#x6536;&#xFF09;">Copying/Cleanup Phase&#xFF08;<code>&#x7B5B;&#x9009;</code>&#x90E8;&#x5206;region&#x56DE;&#x6536;&#xFF0C;&#x800C;&#x975E;&#x5168;&#x90E8;&#x56DE;&#x6536;&#xFF1B;STW&#xFF1A;&#x6839;&#x636E;&#x7528;&#x6237;&#x671F;&#x671B;&#x7684;GC&#x505C;&#x987F;&#x65F6;&#x95F4;&#x56DE;&#x6536;&#xFF09;</h5>
<p>G1 selects the regions with the lowest &quot;liveness&quot;, those regions which can be collected the fastest. Then those regions are collected at the same time as a young GC. This is denoted in the logs as [GC pause (mixed)]. So both young and old generations are collected at the same time.</p>
<p>&#xFF08;the lowest &quot;liveness&quot;&#x7684;region&#x4F1A;&#x88AB;&#x6E05;&#x7406;&#x6389;&#xFF09;</p>
<p>&#xFF08;<code>yong gc</code>&#x548C;<code>mixed gc</code>&#x4F1A;&#x540C;&#x65F6;&#x8FDB;&#x884C;&#xFF09;</p>
<p>gc log: <code>GC pause (mixed)</code></p>
<h4 id="serial-old-gc">serial old GC</h4>
<p>Mixed GC&#x4E0D;&#x662F;full GC&#xFF0C;&#x5B83;&#x53EA;&#x80FD;&#x56DE;&#x6536;&#x90E8;&#x5206;&#x8001;&#x5E74;&#x4EE3;&#x7684;Region&#xFF0C;&#x5982;&#x679C;mixed GC&#x5B9E;&#x5728;&#x65E0;&#x6CD5;&#x8DDF;&#x4E0A;&#x7A0B;&#x5E8F;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x5BFC;&#x81F4;&#x8001;&#x5E74;&#x4EE3;&#x586B;&#x6EE1;&#x65E0;&#x6CD5;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;Mixed GC(&#x5373;mixed gc&#x56DE;&#x6536;&#x540E;&#x68C0;&#x67E5;&#x8001;&#x5E74;&#x4EE3;&#x662F;&#x5426;&#x4F4E;&#x4E8E;45%&#xFF0C;&#x5982;&#x679C;8&#x6B21;mixed gc &#x8FD8;&#x672A;&#x8FBE;&#x6807;&#xFF0C;&#x5219;&#x7C97;&#x996D;Serial Old gc)&#xFF0C;&#x5C31;&#x4F1A;&#x4F7F;&#x7528;serial old GC&#xFF08;full GC&#xFF09;&#x6765;&#x6536;&#x96C6;&#x6574;&#x4E2A;GC heap&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;G1&#x662F;&#x4E0D;&#x63D0;&#x4F9B;full GC&#x7684;&#x3002;</p>
<h4 id="g1-gc&#x603B;&#x7ED3;">g1 gc&#x603B;&#x7ED3;</h4>
<ul>
<li><p>&#x5BF9;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;GC</p>
</li>
<li><p>young gc&#x9700;&#x8981;stop the world</p>
</li>
<li>young gc&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x5E76;&#x884C;&#x5904;&#x7406;&#x7684;</li>
<li><p>eden&#x4F1A;&#x5230;&#x8FBE;<code>survivor</code>&#x6216;&#x8005;<code>old</code> generation regions</p>
</li>
<li><p>&#x5BF9;&#x8001;&#x5E74;&#x4EE3;&#x7684;GC</p>
</li>
<li><p>Concurrent Marking Phase</p>
<ul>
<li>Liveness information is calculated concurrently while the application is running.</li>
<li>This liveness information identifies which regions will be best to reclaim during an evacuation pause.</li>
<li>There is no sweeping phase like in CMS.</li>
</ul>
</li>
<li>Remark Phase<ul>
<li>Uses the Snapshot-at-the-Beginning (SATB) algorithm which is much faster then what was used with CMS.</li>
<li>Completely empty regions are reclaimed.(&#x5B8C;&#x5168;&#x7A7A;&#x7684;regions&#x4F1A;&#x7ACB;&#x523B;&#x88AB;&#x4F1A;&#x6536;&#x6389;)</li>
</ul>
</li>
<li>Copying/Cleanup Phase<ul>
<li>Young generation and old generation are reclaimed at the same time.&#xFF08;&#x5E74;&#x8F7B;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#x4F1A;&#x540C;&#x65F6;&#x88AB;&#x56DE;&#x6536;&#xFF09;</li>
<li>Old generation regions are selected based on their liveness.</li>
</ul>
</li>
</ul>
<h3 id="g1&#x505C;&#x987F;&#x8017;&#x65F6;&#x7684;&#x4E3B;&#x8981;&#x74F6;&#x9888;">G1&#x505C;&#x987F;&#x8017;&#x65F6;&#x7684;&#x4E3B;&#x8981;&#x74F6;&#x9888;</h3>
<p>G1&#x4E2D;&#x6807;&#x8BB0;-&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x8FC7;&#x7A0B;&#xFF08;G1&#x7684;Young GC&#x548C;Mixed GC&#x5747;&#x91C7;&#x7528;&#x8BE5;&#x7B97;&#x6CD5;&#xFF09;</p>
<p><img src="imgs/gc_gc.png" alt=""></p>
<p>G1&#x7684;&#x6DF7;&#x5408;&#x56DE;&#x6536;&#x8FC7;&#x7A0B;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x3001;&#x6E05;&#x7406;&#x9636;&#x6BB5;&#x548C;&#x590D;&#x5236;&#x9636;&#x6BB5;</p>
<ul>
<li><p>&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x505C;&#x987F;&#x5206;&#x6790;</p>
<ul>
<li>&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF1A;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x662F;&#x6307;&#x4ECE;GC Roots&#x51FA;&#x53D1;&#x6807;&#x8BB0;&#x5168;&#x90E8;&#x76F4;&#x63A5;&#x5B50;&#x8282;&#x70B9;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x8BE5;&#x9636;&#x6BB5;&#x662F;STW&#x7684;&#x3002;&#x7531;&#x4E8E;GC Roots&#x6570;&#x91CF;&#x4E0D;&#x591A;&#xFF0C;&#x901A;&#x5E38;&#x8BE5;&#x9636;&#x6BB5;&#x8017;&#x65F6;&#x975E;&#x5E38;&#x77ED;&#x3002;</li>
<li>&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF1A;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x662F;&#x6307;&#x4ECE;GC Roots&#x5F00;&#x59CB;&#x5BF9;&#x5806;&#x4E2D;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#xFF0C;&#x627E;&#x51FA;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x3002;&#x8BE5;&#x9636;&#x6BB5;&#x662F;&#x5E76;&#x53D1;&#x7684;&#xFF0C;&#x5373;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x548C;GC&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x6D3B;&#x52A8;&#x3002;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x8017;&#x65F6;&#x76F8;&#x5BF9;&#x957F;&#x5F88;&#x591A;&#xFF0C;&#x4F46;&#x56E0;&#x4E3A;&#x4E0D;&#x662F;STW&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0D;&#x592A;&#x5173;&#x5FC3;&#x8BE5;&#x9636;&#x6BB5;&#x8017;&#x65F6;&#x7684;&#x957F;&#x77ED;&#x3002;</li>
<li>&#x518D;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF1A;&#x91CD;&#x65B0;&#x6807;&#x8BB0;&#x90A3;&#x4E9B;&#x5728;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8BE5;&#x9636;&#x6BB5;&#x662F;STW&#x7684;&#x3002;</li>
</ul>
</li>
<li><p>&#x6E05;&#x70B9;&#x9636;&#x6BB5;&#x505C;&#x987F;&#x5206;&#x6790;</p>
<ul>
<li>&#x6E05;&#x7406;&#x9636;&#x6BB5;&#x6E05;&#x70B9;&#x51FA;&#x6709;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x533A;&#x548C;&#x6CA1;&#x6709;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x533A;&#xFF0C;&#x8BE5;&#x9636;&#x6BB5;&#x4E0D;&#x4F1A;&#x6E05;&#x7406;&#x5783;&#x573E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x590D;&#x5236;&#x3002;&#x8BE5;&#x9636;&#x6BB5;&#x662F;STW&#x7684;&#x3002;</li>
</ul>
</li>
<li><p>&#x590D;&#x5236;&#x9636;&#x6BB5;&#x505C;&#x987F;&#x5206;&#x6790;</p>
<ul>
<li>&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x4E2D;&#x7684;&#x8F6C;&#x79FB;&#x9636;&#x6BB5;&#x9700;&#x8981;<strong>&#x5206;&#x914D;&#x65B0;&#x5185;&#x5B58;&#x548C;&#x590D;&#x5236;&#x5BF9;&#x8C61;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;</strong>&#x3002;&#x8F6C;&#x79FB;&#x9636;&#x6BB5;&#x662F;STW&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#x5185;&#x5B58;&#x5206;&#x914D;&#x901A;&#x5E38;&#x8017;&#x65F6;&#x975E;&#x5E38;&#x77ED;&#xFF0C;&#x4F46;&#x5BF9;&#x8C61;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x7684;&#x590D;&#x5236;&#x8017;&#x65F6;&#x6709;&#x53EF;&#x80FD;&#x8F83;&#x957F;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x590D;&#x5236;&#x8017;&#x65F6;&#x4E0E;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x6570;&#x91CF;&#x4E0E;&#x5BF9;&#x8C61;&#x590D;&#x6742;&#x5EA6;&#x6210;&#x6B63;&#x6BD4;&#x3002;&#x5BF9;&#x8C61;&#x8D8A;&#x590D;&#x6742;&#xFF0C;&#x590D;&#x5236;&#x8017;&#x65F6;&#x8D8A;&#x957F;&#x3002;</li>
</ul>
</li>
</ul>
<p>&#x56DB;&#x4E2A;STW&#x8FC7;&#x7A0B;&#x4E2D;</p>
<ol>
<li>&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x56E0;&#x4E3A;&#x53EA;&#x6807;&#x8BB0;GC Roots&#xFF0C;&#x8017;&#x65F6;&#x8F83;&#x77ED;&#x3002;</li>
<li>&#x518D;&#x6807;&#x8BB0;&#x56E0;&#x4E3A;&#x5BF9;&#x8C61;&#x6570;&#x5C11;&#xFF0C;&#x8017;&#x65F6;&#x4E5F;&#x8F83;&#x77ED;&#x3002;</li>
<li>&#x6E05;&#x7406;&#x9636;&#x6BB5;&#x6E05;&#x70B9;&#x51FA;&#x6709;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x533A;&#x548C;&#x6CA1;&#x6709;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x533A;&#xFF0C;&#x56E0;&#x4E3A;&#x5185;&#x5B58;&#x5206;&#x533A;&#x6570;&#x91CF;&#x5C11;&#xFF0C;&#x8017;&#x65F6;&#x4E5F;&#x8F83;&#x77ED;&#x3002;</li>
<li>&#x590D;&#x5236;&#x9636;&#x6BB5;&#x7684;&#x8F6C;&#x79FB;&#x8FC7;&#x7A0B;&#x8981;&#x5904;&#x7406;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x8017;&#x65F6;&#x4F1A;&#x8F83;&#x957F;&#x3002;</li>
</ol>
<p>&#x56E0;&#x6B64;&#xFF0C;G1&#x505C;&#x987F;&#x65F6;&#x95F4;&#x7684;&#x74F6;&#x9888;&#x4E3B;&#x8981;&#x662F;&#x6807;&#x8BB0;-&#x590D;&#x5236;&#x4E2D;&#x7684;&#x8F6C;&#x79FB;&#x9636;&#x6BB5;STW&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x8F6C;&#x79FB;&#x9636;&#x6BB5;&#x4E0D;&#x80FD;&#x548C;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x4E00;&#x6837;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x5462;&#xFF1F;&#x4E3B;&#x8981;&#x662F;G1&#x672A;&#x80FD;&#x89E3;&#x51B3;&#x8F6C;&#x79FB;&#x8FC7;&#x7A0B;&#x4E2D;&#x51C6;&#x786E;&#x5B9A;&#x4F4D;&#x5BF9;&#x8C61;&#x5730;&#x5740;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="g1&#x7684;&#x4F18;&#x52BF;&#xFF08;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x591F;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x505C;&#x7559;&#x65F6;&#x95F4;&#xFF09;">G1&#x7684;&#x4F18;&#x52BF;&#xFF08;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x591F;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x505C;&#x7559;&#x65F6;&#x95F4;&#xFF09;</h3>
<p>G1&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x663E;&#x8457;&#x7279;&#x70B9;&#x5B83;&#x80FD;&#x591F;&#x8BA9;&#x7528;&#x6237;&#x8BBE;&#x7F6E;&#x5E94;&#x7528;&#x7684;&#x6682;&#x505C;&#x65F6;&#x95F4;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;G1&#x80FD;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x5462;&#xFF1F;&#x4E5F;&#x8BB8;&#x4F60;&#x5DF2;&#x7ECF;&#x6CE8;&#x610F;&#x5230;&#x4E86;&#xFF0C;G1&#x662F;<strong>&#x9009;&#x62E9;&#x4E00;&#x4E9B;&#x5185;&#x5B58;&#x5757;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6574;&#x4E2A;&#x4EE3;&#x7684;&#x5185;&#x5B58;&#x6765;&#x56DE;&#x6536;</strong>&#xFF0C;&#x8FD9;&#x662F;G1&#x8DDF;&#x5176;&#x5B83;GC&#x975E;&#x5E38;&#x4E0D;&#x540C;&#x7684;&#x4E00;&#x70B9;&#xFF0C;&#x5176;&#x5B83;GC&#x6BCF;&#x6B21;&#x56DE;&#x6536;&#x90FD;&#x4F1A;&#x56DE;&#x6536;&#x6574;&#x4E2A;Generation&#x7684;&#x5185;&#x5B58;(Eden, Old), &#x800C;&#x56DE;&#x6536;&#x5185;&#x5B58;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x5C31;&#x53D6;&#x51B3;&#x4E8E;&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4EE5;&#x53CA;&#x5B9E;&#x9645;&#x5783;&#x573E;&#x7684;&#x591A;&#x5C11;&#xFF0C;&#x6240;&#x4EE5;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x95F4;&#x662F;&#x4E0D;&#x53EF;&#x63A7;&#x7684;&#xFF1B;&#x800C;G1&#x6BCF;&#x6B21;&#x5E76;&#x4E0D;&#x4F1A;&#x56DE;&#x6536;&#x6574;&#x4EE3;&#x5185;&#x5B58;&#xFF0C;&#x5230;&#x5E95;&#x56DE;&#x6536;&#x591A;&#x5C11;&#x5185;&#x5B58;&#x5C31;&#x770B;&#x7528;&#x6237;&#x914D;&#x7F6E;&#x7684;&#x6682;&#x505C;&#x65F6;&#x95F4;&#xFF0C;&#x914D;&#x7F6E;&#x7684;&#x65F6;&#x95F4;&#x77ED;&#x5C31;&#x5C11;&#x56DE;&#x6536;&#x70B9;&#xFF0C;&#x914D;&#x7F6E;&#x7684;&#x65F6;&#x95F4;&#x957F;&#x5C31;&#x591A;&#x56DE;&#x6536;&#x70B9;&#xFF0C;&#x4F38;&#x7F29;&#x81EA;&#x5982;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5185;&#x5B58;&#x88AB;&#x5206;&#x6210;&#x4E86;&#x5F88;&#x591A;&#x5C0F;&#x5757;&#xFF0C;&#x53C8;&#x5E26;&#x6765;&#x4E86;&#x53E6;&#x5916;&#x597D;&#x5904;&#xFF0C;&#x7531;&#x4E8E;&#x5185;&#x5B58;&#x5757;&#x6BD4;&#x8F83;&#x5C0F;&#xFF0C;&#x8FDB;&#x884C;&#x5185;&#x5B58;&#x538B;&#x7F29;&#x6574;&#x7406;&#x7684;&#x4EE3;&#x4EF7;&#x90FD;&#x6BD4;&#x8F83;&#x5C0F;&#xFF0C;&#x76F8;&#x6BD4;&#x5176;&#x5B83;GC&#x7B97;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x7684;&#x89C4;&#x907F;&#x5185;&#x5B58;&#x788E;&#x7247;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>G1&#x7684;&#x601D;&#x60F3;&#xFF1A;&#x5C06;&#x4E00;&#x4E2A;&#x5927;&#x7684;&#x5206;&#x6210;&#x82E5;&#x5E72;&#x4E2A;Region&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5904;&#x7406;&#xFF1B;&#x5373;&#x3010;&#x5206;&#x800C;&#x6CBB;&#x4E4B;&#x3011;&#x7684;&#x601D;&#x60F3;</p>
<h2 id="g1-&#x548C;-cms">G1 &#x548C; CMS</h2>
<h3 id="g1-&#x548C;-cms-&#x5806;&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF08;&#x5206;&#x4EE3;--region&#xFF09;">G1 &#x548C; CMS &#x5806;&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF08;&#x5206;&#x4EE3; &amp; region&#xFF09;</h3>
<ul>
<li><p><code>CMS</code>&#x5C06;&#x5806;&#x903B;&#x8F91;&#x4E0A;&#x5206;&#x6210;<code>Eden</code>,<code>Survivor(S0,S1)</code>,<code>Old</code>&#xFF1B;&#x5E76;&#x4E14;&#x4ED6;&#x4EEC;&#x662F;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;JVM&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x5DF2;&#x7ECF;&#x8BBE;&#x5B9A;&#x4E0D;&#x80FD;&#x6539;&#x53D8;,&#x5E76;&#x4E14;&#x662F;&#x8FDE;&#x7EED;&#x7684;&#x5185;&#x5B58;&#x5757;</p>
</li>
<li><p><code>G1</code>&#x5C06;&#x5806;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x5927;&#x5C0F;&#x76F8;&#x540C;&#x7684;<code>Region(&#x533A;&#x57DF;)</code>,&#x9ED8;&#x8BA4;2048&#x4E2A;&#xFF1A;&#x5728;1Mb&#x5230;32Mb&#x4E4B;&#x95F4;&#x5927;&#x5C0F;,&#x903B;&#x8F91;&#x4E0A;&#x5206;&#x6210;<code>Eden</code>,<code>Survivor</code>,<code>Old</code>,<code>Humongous</code>(&#x5DE8;&#x578B;),<code>&#x7A7A;&#x95F2;</code>&#xFF1B;&#x4ED6;&#x4EEC;&#x4E0D;&#x662F;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;,&#x4F1A;&#x6839;&#x636E;&#x6BCF;&#x6B21;GC&#x7684;&#x4FE1;&#x606F;&#x505A;&#x51FA;&#x8C03;&#x6574;</p>
</li>
</ul>
<h3 id="g1-&#x548C;-cms-gc&#x7684;&#x533A;&#x522B;">G1 &#x548C; CMS GC&#x7684;&#x533A;&#x522B;</h3>
<p>CMS&#x7684;Young GC&#x5C31;&#x662F;&#x4F9D;&#x8D56;&#x5E76;&#x884C;GC(ParNew)&#x53BB;&#x5B8C;&#x6210;&#x7684;&#xFF0C;&#x53EA;&#x6709;&#x8001;&#x5E74;&#x4EE3;&#x4E2D;&#x4F7F;&#x7528;CMS GC(&#x4E5F;&#x5C31;&#x662F;Old GC)</p>
<p>CMS &#x4F7F;&#x7528;<strong>&#x5206;&#x4EE3;&#x56DE;&#x6536;</strong>,&#x5806;&#x88AB;&#x5206;&#x6210;&#x4E86;&#x5E74;&#x8F7B;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;,&#x5176;&#x4E2D;&#x5E74;&#x8F7B;&#x4EE3;&#x56DE;&#x6536;&#x4F9D;&#x8D56;ParNew&#x53BB;&#x56DE;&#x6536;,&#x9700;&#x8981;STW(<code>Stop The World</code>)</p>
<p>G1&#x4E2D;&#x63D0;&#x4F9B;&#x4E86;&#x4E09;&#x79CD;&#x6A21;&#x5F0F;&#x5783;&#x573E;&#x56DE;&#x6536;&#x6A21;&#x5F0F;&#xFF0C;young gc&#x3001;mixed gc &#x548C; full gc&#xFF0C;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#x88AB;&#x89E6;&#x53D1;&#x3002;</p>
<ul>
<li>young gc</li>
</ul>
<p>&#x53D1;&#x751F;&#x5728;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;GC&#x7B97;&#x6CD5;&#xFF0C;&#x4E00;&#x822C;&#x5BF9;&#x8C61;&#xFF08;&#x9664;&#x4E86;&#x5DE8;&#x578B;&#x5BF9;&#x8C61;&#xFF09;&#x90FD;&#x662F;&#x5728;eden region&#x4E2D;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x5F53;&#x6240;&#x6709;eden region&#x88AB;&#x8017;&#x5C3D;&#x65E0;&#x6CD5;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x6B21;young gc&#xFF0C;&#x8FD9;&#x79CD;&#x89E6;&#x53D1;&#x673A;&#x5236;&#x548C;&#x4E4B;&#x524D;&#x7684;young gc&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x6267;&#x884C;&#x5B8C;&#x4E00;&#x6B21;young gc&#xFF0C;&#x6D3B;&#x8DC3;&#x5BF9;&#x8C61;&#x4F1A;&#x88AB;&#x62F7;&#x8D1D;&#x5230;survivor region&#x6216;&#x8005;&#x664B;&#x5347;&#x5230;old region&#x4E2D;&#xFF0C;&#x7A7A;&#x95F2;&#x7684;region&#x4F1A;&#x88AB;&#x653E;&#x5165;&#x7A7A;&#x95F2;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x7B49;&#x5F85;&#x4E0B;&#x6B21;&#x88AB;&#x4F7F;&#x7528;&#x3002;</p>
<ul>
<li>mixed gc</li>
</ul>
<p>&#x5F53;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#x7684;&#x5BF9;&#x8C61;&#x664B;&#x5347;&#x5230;&#x8001;&#x5E74;&#x4EE3;old region&#x65F6;&#xFF0C;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x5806;&#x5185;&#x5B58;&#x88AB;&#x8017;&#x5C3D;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x4E2A;&#x6DF7;&#x5408;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x5373;mixed gc&#xFF0C;&#x8BE5;&#x7B97;&#x6CD5;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;old gc&#xFF0C;&#x9664;&#x4E86;&#x56DE;&#x6536;&#x6574;&#x4E2A;young region&#xFF0C;&#x8FD8;&#x4F1A;&#x56DE;&#x6536;&#x4E00;&#x90E8;&#x5206;&#x7684;old region&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF1A;&#x662F;<font color="red">&#x4E00;&#x90E8;&#x5206;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5168;&#x90E8;&#x8001;&#x5E74;&#x4EE3;</font>&#xFF0C;G1&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x54EA;&#x4E9B;old region&#x8FDB;&#x884C;&#x6536;&#x96C6;&#xFF0C;&#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x5BF9;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x8017;&#x65F6;&#x65F6;&#x95F4;&#x8FDB;&#x884C;&#x63A7;&#x5236;</p>
<ul>
<li>full gc</li>
</ul>
<p>&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x5206;&#x914D;&#x901F;&#x5EA6;&#x8FC7;&#x5FEB;&#xFF0C;mixed gc&#x6765;&#x4E0D;&#x53CA;&#x56DE;&#x6536;&#xFF0C;&#x5BFC;&#x81F4;&#x8001;&#x5E74;&#x4EE3;&#x88AB;&#x586B;&#x6EE1;&#xFF0C;&#x5C31;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x6B21;full gc&#xFF0C;G1&#x7684;full gc&#x7B97;&#x6CD5;&#x5C31;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;<code>serial old gc</code>&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x5F02;&#x5E38;&#x957F;&#x65F6;&#x95F4;&#x7684;&#x6682;&#x505C;&#x65F6;&#x95F4;&#xFF1B;&#x6240;&#x4EE5;&#x8FD9;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4E0D;&#x65AD;&#x7684;&#x8C03;&#x4F18;&#xFF0C;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x907F;&#x514D;full gc&#x7684;&#x4EA7;&#x751F;</p>
<p><strong>g1 yong gc log</strong></p>
<pre class="language-"><code class="lang-java"><span class="token punctuation">[</span><span class="token class-name">GC</span> pause <span class="token punctuation">(</span>G1 <span class="token class-name">Evacuation</span> <span class="token class-name">Pause</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0707344</span> secs<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Parallel</span> <span class="token class-name">Time</span><span class="token operator">:</span> <span class="token number">68.6</span> ms<span class="token punctuation">,</span> GC <span class="token class-name">Workers</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">Start</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">4044130.9</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">4044130.9</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">4044131.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Ext</span> <span class="token class-name">Root</span> <span class="token class-name">Scanning</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">3.1</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">3.5</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">6.6</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Update</span> RS <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">4.4</span><span class="token punctuation">]</span>
         <span class="token punctuation">[</span><span class="token class-name">Processed</span> <span class="token class-name">Buffers</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">111.5</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">146</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">69</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">223</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Scan</span> RS <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Code</span> <span class="token class-name">Root</span> <span class="token class-name">Scanning</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Object</span> <span class="token class-name">Copy</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">61.4</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">62.1</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">62.8</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">1.4</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">124.1</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Termination</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
         <span class="token punctuation">[</span><span class="token class-name">Termination</span> <span class="token class-name">Attempts</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">Other</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">Total</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">68.5</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">68.5</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">68.5</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token class-name">Sum</span><span class="token operator">:</span> <span class="token number">137.0</span><span class="token punctuation">]</span>
      <span class="token punctuation">[</span>GC <span class="token class-name">Worker</span> <span class="token class-name">End</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Min</span><span class="token operator">:</span> <span class="token number">4044199.4</span><span class="token punctuation">,</span> <span class="token class-name">Avg</span><span class="token operator">:</span> <span class="token number">4044199.4</span><span class="token punctuation">,</span> <span class="token class-name">Max</span><span class="token operator">:</span> <span class="token number">4044199.4</span><span class="token punctuation">,</span> <span class="token class-name">Diff</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Code</span> <span class="token class-name">Root</span> <span class="token class-name">Fixup</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Code</span> <span class="token class-name">Root</span> <span class="token class-name">Purge</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Clear</span> CT<span class="token operator">:</span> <span class="token number">0.4</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Other</span><span class="token operator">:</span> <span class="token number">1.7</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Choose</span> <span class="token class-name">CSet</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Ref</span> <span class="token class-name">Proc</span><span class="token operator">:</span> <span class="token number">0.1</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Ref</span> <span class="token class-name">Enq</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Redirty</span> <span class="token class-name">Cards</span><span class="token operator">:</span> <span class="token number">0.1</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Humongous</span> <span class="token class-name">Register</span><span class="token operator">:</span> <span class="token number">0.1</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Humongous</span> <span class="token class-name">Reclaim</span><span class="token operator">:</span> <span class="token number">0.0</span> ms<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token class-name">Free</span> <span class="token class-name">CSet</span><span class="token operator">:</span> <span class="token number">0.7</span> ms<span class="token punctuation">]</span>
   <span class="token punctuation">[</span><span class="token class-name">Eden</span><span class="token operator">:</span> <span class="token number">1160.</span><span class="token function">0M</span><span class="token punctuation">(</span><span class="token number">1160.0</span>M<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token number">0.</span><span class="token function">0B</span><span class="token punctuation">(</span><span class="token number">1153.0</span>M<span class="token punctuation">)</span> <span class="token class-name">Survivors</span><span class="token operator">:</span> <span class="token number">68.0</span>M<span class="token operator">-&gt;</span><span class="token number">75.0</span>M <span class="token class-name">Heap</span><span class="token operator">:</span> <span class="token number">1551.</span><span class="token function">2M</span><span class="token punctuation">(</span><span class="token number">2048.0</span>M<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token number">398.</span><span class="token function">7M</span><span class="token punctuation">(</span><span class="token number">2048.0</span>M<span class="token punctuation">)</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.14</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.07</span> secs<span class="token punctuation">]</span>
</code></pre>
<h2 id="&#x5185;&#x5B58;&#x5206;&#x914D;&#x4E0E;&#x56DE;&#x6536;&#x7B56;&#x7565;&#x7406;&#x8BBA;&#x57FA;&#x7840;">&#x5185;&#x5B58;&#x5206;&#x914D;&#x4E0E;&#x56DE;&#x6536;&#x7B56;&#x7565;(&#x7406;&#x8BBA;&#x57FA;&#x7840;)</h2>
<h3 id="&#x5BF9;&#x8C61;&#x4F18;&#x5148;&#x5728;eden&#x5206;&#x914D;">&#x5BF9;&#x8C61;&#x4F18;&#x5148;&#x5728;Eden&#x5206;&#x914D;</h3>
<p>&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BF9;&#x8C61;&#x5728;&#x65B0;&#x751F;&#x4EE3;Eden&#x533A;&#x4E2D;&#x5206;&#x914D;&#x3002;&#x5F53;Eden&#x533A;&#x6CA1;&#x6709;&#x8DB3;&#x591F;&#x7A7A;&#x95F4;&#x8FDB;&#x884C;&#x5206;&#x914D;&#x662F;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x5C06;&#x53D1;&#x8D77;&#x4E00;&#x6B21;<code>Minor GC</code>&#x3002;&#xFF08;<code>-XX:+PrintGCDetails</code>&#xFF09;</p>
<h4 id="minor-gcyong-gc">minor gc(yong gc)</h4>
<p>&#x65B0;&#x751F;&#x4EE3;GC(<code>Minor GC</code>): &#x6307;&#x53D1;&#x751F;&#x5728;&#x65B0;&#x751F;&#x4EE3;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x52A8;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;Java&#x5BF9;&#x8C61;&#x5927;&#x591A;&#x6570;&#x90FD;&#x5177;&#x5907;&#x671D;&#x751F;&#x5915;&#x706D;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x6240;&#x4EE5;<code>Minor GC</code>&#x975E;&#x5E38;&#x9891;&#x7E41;&#xFF0C;&#x4E00;&#x822C;&#x56DE;&#x6536;&#x901F;&#x5EA6;&#x4E5F;&#x6BD4;&#x8F83;&#x5FEB;</p>
<p>&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x7528;&#x65B0;&#x751F;&#x4EE3;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;<code>Eden</code>&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;<code>Minor GC</code>&#xFF0C;&#x8FD9;&#x65F6;&#x4F1A;&#x628A;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#x8F6C;&#x79FB;&#x8FDB;Survivor&#x533A;&#x3002;</p>
<p>&#x65B0;&#x751F;&#x4EE3;&#x901A;&#x5E38;&#x5B58;&#x6D3B;&#x65F6;&#x95F4;&#x8F83;&#x77ED;&#x57FA;&#x4E8E;Copying&#x7B97;&#x6CD5;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#xFF0C;&#x6240;&#x8C13;Copying&#x7B97;&#x6CD5;&#x5C31;&#x662F;&#x626B;&#x63CF;&#x51FA;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x590D;&#x5236;&#x5230;&#x4E00;&#x5757;&#x65B0;&#x7684;&#x5B8C;&#x5168;&#x672A;&#x4F7F;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#x4E2D;&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;&#x65B0;&#x751F;&#x4EE3;&#xFF0C;&#x5C31;&#x662F;&#x5728;<code>Eden</code>&#x548C;<code>From Space</code>&#x6216;<code>To Space</code>&#x4E4B;&#x95F4;copy&#x3002;&#x65B0;&#x751F;&#x4EE3;&#x91C7;&#x7528;&#x7A7A;&#x95F2;&#x6307;&#x9488;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x63A7;&#x5236;GC&#x89E6;&#x53D1;&#xFF0C;&#x6307;&#x9488;&#x4FDD;&#x6301;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5206;&#x914D;&#x7684;&#x5BF9;&#x8C61;&#x5728;&#x65B0;&#x751F;&#x4EE3;&#x533A;&#x95F4;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5F53;&#x6709;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x8981;&#x5206;&#x914D;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x7528;&#x4E8E;&#x68C0;&#x67E5;&#x7A7A;&#x95F4;&#x662F;&#x5426;&#x8DB3;&#x591F;&#xFF0C;&#x4E0D;&#x591F;&#x5C31;&#x89E6;&#x53D1;GC&#x3002;&#x5F53;&#x8FDE;&#x7EED;&#x5206;&#x914D;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x5BF9;&#x8C61;&#x4F1A;&#x9010;&#x6E10;&#x4ECE;Eden&#x5230;Survivor&#xFF0C;&#x6700;&#x540E;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x3002;</p>
<h4 id="major-gc-full-gc">major gc/ full gc</h4>
<p>&#x8001;&#x5E74;&#x4EE3;GC(Major GC/Full GC): &#x6307;&#x53D1;&#x751F;&#x5728;&#x8001;&#x5E74;&#x4EE3;&#x7684;GC,&#x51FA;&#x73B0;&#x4E86;<code>Major GC</code>, &#x7ECF;&#x5E38;&#x4F1A;&#x4F34;&#x968F;&#x81F3;&#x5C11;&#x4E00;&#x6B21;&#x7684;<code>Minor GC</code>(&#x4F46;&#x975E;&#x7EDD;&#x5BF9;&#x7684;&#xFF0C;&#x5728;Parallel Scavenge&#x6536;&#x96C6;&#x5668;&#x7684;&#x6536;&#x96C6;&#x7B56;&#x7565;&#x91CC;&#x5C31;&#x6709;&#x76F4;&#x63A5;&#x8FDB;&#x884C;<code>Major GC</code>&#x7684;&#x7B56;&#x7565;&#x9009;&#x62E9;&#x8FC7;&#x7A0B;)&#x3002;Major GC&#x7684;&#x901F;&#x5EA6;&#x4E00;&#x822C;&#x4F1A;&#x6BD4;Minor GC&#x6162;10&#x500D;&#x4EE5;&#x4E0A;</p>
<p>&#x8001;&#x5E74;&#x4EE3;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x7ECF;&#x8FC7;&#x591A;&#x6B21;Minor GC&#x4E4B;&#x540E;&#x4F9D;&#x7136;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x8001;&#x5E74;&#x4EE3;&#x4E0E;&#x65B0;&#x751F;&#x4EE3;&#x4E0D;&#x540C;&#xFF0C;&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x5B58;&#x6D3B;&#x7684;&#x65F6;&#x95F4;&#x6BD4;&#x8F83;&#x957F;&#x3001;&#x6BD4;&#x8F83;&#x7A33;&#x5B9A;&#xFF0C;&#x56E0;&#x6B64;&#x91C7;&#x7528;&#x6807;&#x8BB0;(Mark)&#x7B97;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#xFF0C;&#x6240;&#x8C13;&#x6807;&#x8BB0;&#x5C31;&#x662F;&#x626B;&#x63CF;&#x51FA;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#x672A;&#x88AB;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56DE;&#x6536;&#x540E;&#x5BF9;&#x7528;&#x7A7A;&#x51FA;&#x7684;&#x7A7A;&#x95F4;&#x8981;&#x4E48;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#x3001;&#x8981;&#x4E48;&#x6807;&#x8BB0;&#x51FA;&#x6765;&#x4FBF;&#x4E8E;&#x4E0B;&#x6B21;&#x8FDB;&#x884C;&#x5206;&#x914D;&#xFF0C;&#x603B;&#x4E4B;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x8981;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x788E;&#x7247;&#x5E26;&#x6765;&#x7684;&#x6548;&#x7387;&#x635F;&#x8017;&#x3002;</p>
<ul>
<li>-Xms &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5806;&#x5185;&#x5B58;&#x7684;64&#x5206;&#x4E4B;&#x4E00;</li>
<li>-Xmx &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5806;&#x5185;&#x5B58;&#x7684;4&#x5206;&#x4E4B;&#x4E00;</li>
<li>-Xmn &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5806;&#x5185;&#x5B58;&#x7684;64&#x5206;&#x4E4B;&#x4E00;&#xFF0C; &#x65B0;&#x751F;&#x4EE3;&#x5927;&#x5C0F;&#xFF0C;&#x8BE5;&#x914D;&#x7F6E;&#x4F18;&#x5148;&#x4E8E;-XX:NewRatio&#xFF0C;&#x5373;&#x5982;&#x679C;&#x914D;&#x7F6E;&#x4E86;-Xmn&#xFF0C;-XX:NewRatio&#x4F1A;&#x5931;&#x6548;&#x3002;</li>
<li>-XXNewRatio &#x9ED8;&#x8BA4;&#x4E3A;2</li>
<li>-XX:SurvivorRatio &#x9ED8;&#x8BA4;&#x4E3A;8&#xFF0C;&#x8868;&#x793A;Suvivor:eden=2:8,&#x5373;&#x4E00;&#x4E2A;Survivor&#x5360;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;1/10</li>
</ul>
<h4 id="java-&#x5206;&#x4EE3;gc&#x6D4B;&#x8BD5;&#x7A0B;&#x5E8F;-&#x548C;-&#x521D;&#x59CB;&#x5806;&#x60C5;&#x51B5;java7-cms">Java &#x5206;&#x4EE3;GC&#x6D4B;&#x8BD5;&#x7A0B;&#x5E8F; &#x548C; &#x521D;&#x59CB;&#x5806;&#x60C5;&#x51B5;(Java7 CMS)</h4>
<ul>
<li>jdk1.7.0_80</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token comment">/*
 * -verbose:gc -Xms20M -Xmx20M -Xmn10M  -XX:+PrintGCDetails -XX:SurvivorRatio=8
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> _1MB <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> alloc1<span class="token punctuation">,</span> alloc2<span class="token punctuation">,</span> alloc3<span class="token punctuation">,</span> alloc4<span class="token punctuation">;</span>
        alloc1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>
        alloc2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>
        alloc3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x51FA;&#x73B0; GC</span>
        alloc4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-java"><span class="token operator">-</span>verbose<span class="token operator">:</span>gc <span class="token operator">-</span><span class="token class-name">Xms20M</span> <span class="token operator">-</span><span class="token class-name">Xmx20M</span> <span class="token operator">-</span><span class="token class-name">Xmn10M</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCDetails</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">SurvivorRatio</span><span class="token operator">=</span><span class="token number">8</span>
</code></pre>
<table>
<thead>
<tr>
<th>eden</th>
<th>from survivor</th>
<th>to survivor</th>
<th>old</th>
</tr>
</thead>
<tbody>
<tr>
<td>8192K</td>
<td>1024K</td>
<td>1024K</td>
<td>10240K</td>
</tr>
</tbody>
</table>
<h5 id="&#x5BF9;&#x5E94;&#x7684;gc&#x65E5;&#x5FD7;">&#x5BF9;&#x5E94;&#x7684;GC&#x65E5;&#x5FD7;</h5>
<pre class="language-"><code class="lang-java"><span class="token punctuation">[</span>GC <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">7534</span>K<span class="token operator">-&gt;</span><span class="token function">416K</span><span class="token punctuation">(</span><span class="token number">9216</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">7534</span>K<span class="token operator">-&gt;</span><span class="token function">6560K</span><span class="token punctuation">(</span><span class="token number">19456</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0049590</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.01</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.01</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Full</span> GC <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">416</span>K<span class="token operator">-&gt;</span><span class="token function">0K</span><span class="token punctuation">(</span><span class="token number">9216</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">ParOldGen</span><span class="token operator">:</span> <span class="token number">6144</span>K<span class="token operator">-&gt;</span><span class="token function">6466K</span><span class="token punctuation">(</span><span class="token number">10240</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">6560</span>K<span class="token operator">-&gt;</span><span class="token function">6466K</span><span class="token punctuation">(</span><span class="token number">19456</span>K<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSPermGen</span><span class="token operator">:</span> <span class="token number">3121</span>K<span class="token operator">-&gt;</span><span class="token function">3120K</span><span class="token punctuation">(</span><span class="token number">21504</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.0103590</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.02</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.01</span> secs<span class="token punctuation">]</span>
<span class="token class-name">Heap</span>
 <span class="token class-name">PSYoungGen</span>      total <span class="token number">9216</span>K<span class="token punctuation">,</span> used <span class="token number">3403</span>K <span class="token punctuation">[</span><span class="token number">0x00000007ff600000</span><span class="token punctuation">,</span> <span class="token number">0x0000000800000000</span><span class="token punctuation">,</span> <span class="token number">0x0000000800000000</span><span class="token punctuation">)</span>
  eden space <span class="token number">8192</span>K<span class="token punctuation">,</span> <span class="token number">41</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007ff600000</span><span class="token punctuation">,</span><span class="token number">0x00000007ff952de0</span><span class="token punctuation">,</span><span class="token number">0x00000007ffe00000</span><span class="token punctuation">)</span>
  from space <span class="token number">1024</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007ffe00000</span><span class="token punctuation">,</span><span class="token number">0x00000007ffe00000</span><span class="token punctuation">,</span><span class="token number">0x00000007fff00000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   space <span class="token number">1024</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000007fff00000</span><span class="token punctuation">,</span><span class="token number">0x0000000800000000</span><span class="token punctuation">)</span>
 <span class="token class-name">ParOldGen</span>       total <span class="token number">10240</span>K<span class="token punctuation">,</span> used <span class="token number">6466</span>K <span class="token punctuation">[</span><span class="token number">0x00000007fec00000</span><span class="token punctuation">,</span> <span class="token number">0x00000007ff600000</span><span class="token punctuation">,</span> <span class="token number">0x00000007ff600000</span><span class="token punctuation">)</span>
  object space <span class="token number">10240</span>K<span class="token punctuation">,</span> <span class="token number">63</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007fec00000</span><span class="token punctuation">,</span><span class="token number">0x00000007ff250b48</span><span class="token punctuation">,</span><span class="token number">0x00000007ff600000</span><span class="token punctuation">)</span>
 <span class="token class-name">PSPermGen</span>       total <span class="token number">21504</span>K<span class="token punctuation">,</span> used <span class="token number">3142</span>K <span class="token punctuation">[</span><span class="token number">0x00000007f9a00000</span><span class="token punctuation">,</span> <span class="token number">0x00000007faf00000</span><span class="token punctuation">,</span> <span class="token number">0x00000007fec00000</span><span class="token punctuation">)</span>
  object space <span class="token number">21504</span>K<span class="token punctuation">,</span> <span class="token number">14</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007f9a00000</span><span class="token punctuation">,</span><span class="token number">0x00000007f9d118a0</span><span class="token punctuation">,</span><span class="token number">0x00000007faf00000</span><span class="token punctuation">)</span>
</code></pre>
<ul>
<li>gc&#x8FC7;&#x7A0B;</li>
</ul>
<table>
<thead>
<tr>
<th>&#x72B6;&#x6001;</th>
<th>eden</th>
<th>from survivor</th>
<th>to survivor</th>
<th>old</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x521D;&#x59CB;&#x72B6;&#x6001;&#x603B;&#x5927;&#x5C0F;</td>
<td>8192K</td>
<td>1024K</td>
<td>1024K</td>
<td>10240K</td>
</tr>
<tr>
<td>&#x5206;&#x914D;&#x4E86;alloc1,2,3</td>
<td>&#x4F7F;&#x7528;&#x4E86;6144K</td>
</tr>
<tr>
<td>&#x63A5;&#x7740;&#x9700;&#x8981;&#x5206;&#x914D;alloc4&#xFF0C;&#x9700;&#x8981;3M,&#x4E0D;&#x591F;&#x7528;&#xFF0C;GC</td>
<td></td>
</tr>
<tr>
<td>&#x5185;&#x5B58;&#x91CD;&#x65B0;&#x5206;&#x914D;</td>
<td>3M&#x5B58;alloc4</td>
<td>-</td>
<td>-</td>
<td>old&#x4F7F;&#x7528;&#x4E86;6M&#x7528;&#x6765;&#x5B58;alloc1,2,3</td>
</tr>
<tr>
<td>&#x6700;&#x540E;&#x4F7F;&#x7528;&#x5360;&#x6BD4;</td>
<td>37%&#x591A;</td>
<td>0%</td>
<td>0%</td>
<td>60%&#x591A;</td>
</tr>
</tbody>
</table>
<h4 id="&#x53C2;&#x8003;">&#x53C2;&#x8003;</h4>
<p>JVM GC log&#x6587;&#x4EF6;&#x7684;&#x67E5;&#x770B;<a target="_blank" href="https://www.cnblogs.com/xuezhiyizu1120/p/6237510.html">&#x53C2;&#x8003;&#x535A;&#x6587;&#x94FE;&#x63A5;</a></p>
<ul>
<li>[PSYoungGen: 7698K-&gt;448K(9216K)]<ol>
<li>PSYoungGen &#x65B0;&#x751F;&#x4EE3;/</li>
<li>GC&#x524D;&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5DF2;&#x4F7F;&#x7528;&#x5BB9;&#x91CF; -&gt; GC&#x540E;&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5DF2;&#x4F7F;&#x7528;&#x5BB9;&#x91CF;(&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x7684;&#x603B;&#x5BB9;&#x91CF;)&#x3002;</li>
</ol>
</li>
<li>7698K-&gt;6592K(19456K)<ol>
<li>GC&#x524D;Java&#x5806;&#x5DF2;&#x4F7F;&#x7528;&#x5BB9;&#x91CF; -&gt; GC&#x540E;Java&#x5806;&#x5DF2;&#x4F7F;&#x7528;&#x5BB9;&#x91CF;&#xFF08;Java&#x5806;&#x603B;&#x5BB9;&#x91CF;&#xFF09;&#x3002;</li>
</ol>
</li>
</ul>
<h3 id="&#x5927;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;">&#x5927;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</h3>
<p>&#x8FD9;&#x91CC;&#x6240;&#x8C13;&#x7684;&#x5927;&#x5BF9;&#x8C61;&#x662F;&#x6307;&#xFF0C;&#x9700;&#x8981;&#x5927;&#x91CF;&#x8FDE;&#x7EED;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x7684;Java&#x5BF9;&#x8C61;&#xFF0C;&#x6700;&#x5178;&#x578B;&#x7684;&#x5927;&#x5BF9;&#x8C61;&#x5C31;&#x662F;&#x90A3;&#x79CD;&#x5F88;&#x957F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4EE5;&#x53CA;&#x6570;&#x7EC4;&#x3002;&#x5927;&#x5BF9;&#x8C61;&#x5BF9;&#x865A;&#x62DF;&#x673A;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x574F;&#x6D88;&#x606F;&#x3002;&#xFF08;&#x66F4;&#x574F;&#x7684;&#x662F;&#xFF1A;&#x4E00;&#x7FA4;&quot;&#x671D;&#x751F;&#x5915;&#x706D;&quot;&#x7684;&quot;&#x77ED;&#x547D;&#x5927;&#x5BF9;&#x8C61;&quot;&#xFF09;&#xFF0C;&#x7ECF;&#x5E38;&#x51FA;&#x73B0;&#x5927;&#x5BF9;&#x8C61;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x8FD8;&#x6709;&#x4E0D;&#x5C11;&#x7A7A;&#x95F4;&#x65F6;&#x5C31;&#x63D0;&#x524D;&#x89E6;&#x53D1;&#x5783;&#x573E;&#x6536;&#x96C6;&#x4EE5;&#x83B7;&#x53D6;&#x8DB3;&#x591F;&#x7684;&#x8FDE;&#x7EED;&#x7A7A;&#x95F4;&#x6765;&quot;&#x5B89;&#x7F6E;&quot;&#x5B83;&#x4EEC;</p>
<p><code>-XX:PretenureSizeThreshold</code>&#x53C2;&#x6570;&#xFF0C;&#x53E6;&#x5927;&#x4E8E;&#x8FD9;&#x4E2A;&#x8BBE;&#x7F6E;&#x503C;&#x7684;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x5728;&#x8001;&#x5E74;&#x4EE3;&#x5206;&#x914D;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x76EE;&#x7684;&#x662F;&#x907F;&#x514D;&#x5728;Eden&#x533A;&#x4EE5;&#x53CA;&#x4E24;&#x4E2A;Survivor&#x533A;&#x4E4B;&#x95F4;&#x53D1;&#x751F;&#x5927;&#x91CF;&#x7684;&#x5185;&#x5B58;&#x590D;&#x5236;(&#x590D;&#x4E60;&#x4E00;&#x4E0B;&#xFF1A;&#x65B0;&#x751F;&#x4EE3;&#x91C7;&#x7528;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x6536;&#x96C6;&#x5185;&#x5B58;)</p>
<h3 id="&#x957F;&#x671F;&#x5B58;&#x6D3B;&#x7684;age15&#x5BF9;&#x8C61;&#x5C06;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;">&#x957F;&#x671F;&#x5B58;&#x6D3B;&#x7684;(<code>Age&gt;15</code>)&#x5BF9;&#x8C61;&#x5C06;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</h3>
<p>&#x5185;&#x5B58;&#x56DE;&#x6536;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x8BC6;&#x522B;&#x54EA;&#x4E9B;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x5728;&#x65B0;&#x751F;&#x4EE3;&#xFF0C;&#x54EA;&#x4E9B;&#x5BF9;&#x8C61;&#x5E94;&#x653E;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x3002;</p>
<p>&#x865A;&#x62DF;&#x673A;&#x7ED9;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5E74;&#x9F84;(<code>Age</code>)&#x8BA1;&#x6570;&#x5668;&#x3002;&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x5728;<code>Eden</code>&#x51FA;&#x751F;&#x5E76;&#x7ECF;&#x5386;&#x8FC7;&#x7B2C;&#x4E00;&#x6B21;<code>Minor GC</code>&#x540E;&#x4ECD;&#x7136;&#x5B58;&#x6D3B;&#xFF0C;&#x5E76;&#x4E14;&#x80FD;&#x88AB;<code>Survivor</code>&#x5BB9;&#x7EB3;&#x7684;&#x8BDD;&#xFF0C;&#x5C06;&#x88AB;&#x79FB;&#x52A8;&#x5230;<code>Survivor</code>&#x7A7A;&#x95F4;,&#x5E76;&#x4E14;&#x5BF9;&#x8C61;&#x7684;&#x5E74;&#x9F84;&#x4E3A;1.&#x5BF9;&#x8C61;&#x5728;<code>Survivor</code>&#x533A;&#x4E2D;&#x6BCF;&quot;&#x71AC;&#x8FC7;&quot;&#x4E00;&#x6B21;<code>Minor GC</code>&#xFF0C;&#x5E74;&#x9F84;&#x5C31;&#x589E;&#x52A0;1&#x5C81;&#xFF0C;&#x5F53;&#x4ED6;&#x7684;&#x5E74;&#x9F84;&#x589E;&#x52A0;&#x5230;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#xFF08;&#x9ED8;&#x8BA4;15&#x5C81;&#xFF09;&#xFF0C;&#x5C31;&#x5C06;&#x4F1A;&#x88AB;&#x664B;&#x5347;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x4E2D;&#x3002;&#x5BF9;&#x8C61;&#x664B;&#x5347;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x5E74;&#x9F84;&#x9608;&#x503C;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53C2;&#x6570;<code>-XX:MaxTenuringThreshold</code>&#x8BBE;&#x7F6E;</p>
<h3 id="&#x52A8;&#x6001;&#x5BF9;&#x8C61;&#x7684;&#x5E74;&#x9F84;&#x5224;&#x5B9A;">&#x52A8;&#x6001;&#x5BF9;&#x8C61;&#x7684;&#x5E74;&#x9F84;&#x5224;&#x5B9A;</h3>
<p>&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x5730;&#x9002;&#x5E94;&#x4E0D;&#x540C;&#x7A0B;&#x5E8F;&#x7684;&#x5185;&#x5B58;&#x72B6;&#x51B5;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x5E76;&#x4E0D;&#x662F;&#x6C38;&#x8FDC;&#x5730;&#x8981;&#x6C42;&#x5BF9;&#x8C61;&#x7684;&#x5E74;&#x9F84;&#x5FC5;&#x987B;&#x8FBE;&#x5230;&#x4E86;<code>MaxTenuringThreshold</code>&#x624D;&#x80FD;&#x664B;&#x5347;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x5982;&#x679C;&#x5728;<code>Survivor</code>&#x7A7A;&#x95F4;&#x4E2D;&#x76F8;&#x540C;&#x5E74;&#x9F84;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#x7684;&#x603B;&#x548C;&#x5927;&#x4E8E;<code>Survivor</code>&#x7A7A;&#x95F4;&#x7684;&#x4E00;&#x534A;&#xFF0C;&#x5E74;&#x9F84;&#x5927;&#x4E8E;&#x6216;&#x7B49;&#x4E8E;&#x8BE5;&#x5E74;&#x9F84;&#x5BF9;&#x8C61;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x65E0;&#x987B;&#x7B49;&#x5230;<code>MaxTenuringThreshold</code>&#x8981;&#x6C42;&#x7684;&#x5E74;&#x9F84;&#x3002;</p>
<h3 id="&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x62C5;&#x4FDD;">&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x62C5;&#x4FDD;</h3>
<p>&#x8001;&#x5E74;&#x4EE3;&#x6700;&#x5927;&#x53EF;&#x7528;&#x7684;&#x8FDE;&#x7EED;&#x7A7A;&#x95F4; &gt; &#x65B0;&#x751F;&#x4EE3;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x603B;&#x7A7A;&#x95F4;, &#x8FD9;&#x6837;&#x80FD;&#x786E;&#x4FDD;<code>Minor GC</code>&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x6210;&#x7ACB;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x4F1A;&#x67E5;&#x770B;<code>HandlerPromotionFailure</code>&#x8BBE;&#x7F6E;&#x503C;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x62C5;&#x4FDD;&#x5931;&#x8D25;&#x3002;&#x5982;&#x679C;&#x5141;&#x8BB8;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x7EE7;&#x7EED;&#x68C0;&#x67E5;&#x8001;&#x5E74;&#x4EE3;&#x6700;&#x5927;&#x53EF;&#x7528;&#x7684;&#x8FDE;&#x7EED;&#x7A7A;&#x95F4;&#x662F;&#x5426;&#x5927;&#x4E8E;&#x5386;&#x6B21;&#x664B;&#x5347;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x7684;&#x5E73;&#x5747;&#x5927;&#x5C0F;</p>
<p>&#x5982;&#x679C;&#x5927;&#x4E8E;&#xFF0C;&#x5C06;&#x5C1D;&#x8BD5;&#x7740;&#x8FDB;&#x884C;&#x4E00;&#x6B21;<code>Minor GC</code>,&#x5C3D;&#x7BA1;&#x8FD9;&#x6B21;&#x7684;<code>Minor GC</code>&#x662F;&#x6709;&#x98CE;&#x9669;&#x7684;</p>
<p>&#x5982;&#x679C;&#x5C0F;&#x4E8E;&#xFF0C;&#x6216;&#x8005;<code>HandlerPromotionFailure</code>&#x8BBE;&#x7F6E;&#x503C;&#x4E0D;&#x5141;&#x8BB8;&#x62C5;&#x4FDD;&#x5931;&#x8D25;&#xFF0C;&#x8FD9;&#x65F6;&#x6539;&#x4E3A;&#x8FDB;&#x884C;&#x4E00;&#x6B21;<code>Full GC</code></p>
<h3 id="&#x89E6;&#x53D1;gc&#x7684;&#x6761;&#x4EF6;">&#x89E6;&#x53D1;gc&#x7684;&#x6761;&#x4EF6;</h3>
<p>GC&#x89E6;&#x53D1;&#x7684;&#x6761;&#x4EF6;&#x6709;&#x4E24;&#x79CD;&#x3002;&#xFF08;1&#xFF09;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;System.gc&#x65F6;&#x53EF;&#x4EE5;&#x89E6;&#x53D1;&#xFF1B;&#xFF08;2&#xFF09;&#x7CFB;&#x7EDF;&#x81EA;&#x8EAB;&#x6765;&#x51B3;&#x5B9A;GC&#x89E6;&#x53D1;&#x7684;&#x65F6;&#x673A;&#x3002;</p>
<h4 id="minor-gc&#x89E6;&#x53D1;&#x6761;&#x4EF6;">Minor GC&#x89E6;&#x53D1;&#x6761;&#x4EF6;</h4>
<ul>
<li>&#x5F53;<code>Eden</code>&#x533A;&#x6EE1;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;<code>Minor GC</code></li>
</ul>
<h4 id="full-gc&#x89E6;&#x53D1;&#x6761;&#x4EF6;">Full GC&#x89E6;&#x53D1;&#x6761;&#x4EF6;</h4>
<ul>
<li><p>&#xFF08;1&#xFF09;&#x8C03;&#x7528;System.gc&#x65F6;&#xFF0C;&#x7CFB;&#x7EDF;&#x5EFA;&#x8BAE;&#x6267;&#x884C;Full GC&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x5FC5;&#x7136;&#x6267;&#x884C;</p>
</li>
<li><p>&#xFF08;2&#xFF09;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;</p>
</li>
<li><p>&#xFF08;3&#xFF09;&#x65B9;&#x6CD5;&#x533A;&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;</p>
</li>
<li><p>&#xFF08;4&#xFF09;&#x901A;&#x8FC7;Minor GC&#x540E;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x5E73;&#x5747;&#x5927;&#x5C0F;&#x5927;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x53EF;&#x7528;&#x5185;&#x5B58;</p>
</li>
<li><p>&#xFF08;5&#xFF09;&#x7531;Eden&#x533A;&#x3001;From Space&#x533A;&#x5411;To Space&#x533A;&#x590D;&#x5236;&#x65F6;&#xFF0C;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#x5927;&#x4E8E;To Space&#x53EF;&#x7528;&#x5185;&#x5B58;&#xFF0C;&#x5219;&#x628A;&#x8BE5;&#x5BF9;&#x8C61;&#x8F6C;&#x5B58;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x4E14;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x53EF;&#x7528;&#x5185;&#x5B58;&#x5C0F;&#x4E8E;&#x8BE5;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;</p>
</li>
</ul>
<h2 id="jvm&#x53C2;&#x6570;&#x4E0E;gc">JVM&#x53C2;&#x6570;&#x4E0E;GC</h2>
<table>
<thead>
<tr>
<th>&#x5E74;&#x8F7B;&#x4EE3;</th>
<th>&#x8001;&#x5E74;&#x4EE3;</th>
<th>jvm &#x53C2;&#x6570;</th>
</tr>
</thead>
<tbody>
<tr>
<td>Serial (DefNew)</td>
<td>Serial Old(PSOldGen)</td>
<td>-XX:+UseSerialGC</td>
</tr>
<tr>
<td>Parallel Scavenge (PSYoungGen)</td>
<td>Serial Old(PSOldGen)</td>
<td>-XX:+UseParallelGC</td>
</tr>
<tr>
<td>Parallel Scavenge (PSYoungGen)</td>
<td>Parallel Old (ParOldGen)</td>
<td>-XX:+UseParallelOldGC</td>
</tr>
<tr>
<td>ParNew (ParNew)</td>
<td>Serial Old(PSOldGen)</td>
<td>-XX:-UseParNewGC</td>
</tr>
<tr>
<td>ParNew (ParNew)</td>
<td>CMS+Serial Old(PSOldGen)</td>
<td>-XX:+UseConcMarkSweepGC</td>
</tr>
<tr>
<td>G1</td>
<td>G1</td>
<td>-XX:+UseG1GC</td>
</tr>
</tbody>
</table>
<h3 id="java8-&#x9ED8;&#x8BA4;gc">Java8 &#x9ED8;&#x8BA4;GC</h3>
<ul>
<li>jvm &#x914D;&#x7F6E;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token operator">-</span><span class="token class-name">Xloggc</span><span class="token operator">:</span><span class="token operator">/</span><span class="token class-name">Users</span><span class="token operator">/</span>mubi<span class="token operator">/</span>git_workspace<span class="token operator">/</span>java8<span class="token operator">/</span>gc<span class="token punctuation">.</span>log <span class="token operator">-</span>verbose<span class="token operator">:</span>gc <span class="token operator">-</span><span class="token class-name">Xms20M</span> <span class="token operator">-</span><span class="token class-name">Xmx20M</span> <span class="token operator">-</span><span class="token class-name">Xmn10M</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">SurvivorRatio</span><span class="token operator">=</span><span class="token number">8</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCDetails</span>
</code></pre>
<table>
<thead>
<tr>
<th>gc &#x7C7B;&#x578B;</th>
<th>&#x65B9;&#x5F0F;</th>
</tr>
</thead>
<tbody>
<tr>
<td>yong gc</td>
<td>Parallel Scavenge&#xFF08;PSYoungGen&#xFF09;</td>
</tr>
<tr>
<td>full gc</td>
<td>Parallel Old&#xFF08;ParOldGen&#xFF09;</td>
</tr>
</tbody>
</table>
<ul>
<li>Java &#x7A0B;&#x5E8F;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testAllocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">{</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> a4<span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;free:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;max:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;used:&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>

    a2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;free:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;max:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;used:&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    a3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>

    a4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">*</span> _1MB<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
    <span class="token function">testAllocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>gc.log &#x6587;&#x4EF6;</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token class-name">Java</span> <span class="token class-name">HotSpot</span><span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span><span class="token operator">-</span><span class="token class-name">Bit</span> <span class="token class-name">Server</span> VM <span class="token punctuation">(</span><span class="token number">25.171</span><span class="token operator">-</span>b11<span class="token punctuation">)</span> <span class="token keyword">for</span> bsd<span class="token operator">-</span>amd64 JRE <span class="token punctuation">(</span><span class="token number">1.8</span><span class="token number">.0_171</span><span class="token operator">-</span>b11<span class="token punctuation">)</span><span class="token punctuation">,</span> built on <span class="token class-name">Mar</span> <span class="token number">28</span> <span class="token number">2018</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">50</span><span class="token operator">:</span><span class="token number">57</span> by <span class="token string">&quot;java_re&quot;</span> <span class="token keyword">with</span> gcc <span class="token number">4.2</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token class-name">Based</span> on <span class="token class-name">Apple</span> <span class="token class-name">Inc</span><span class="token punctuation">.</span> build <span class="token number">5658</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>LLVM build <span class="token number">2336.11</span><span class="token number">.00</span><span class="token punctuation">)</span>
<span class="token class-name">Memory</span><span class="token operator">:</span> <span class="token number">4</span>k page<span class="token punctuation">,</span> physical <span class="token function">16777216k</span><span class="token punctuation">(</span><span class="token number">3251600</span>k free<span class="token punctuation">)</span>

<span class="token operator">/</span>proc<span class="token operator">/</span>meminfo<span class="token operator">:</span>

<span class="token class-name">CommandLine</span> flags<span class="token operator">:</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">InitialHeapSize</span><span class="token operator">=</span><span class="token number">20971520</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxHeapSize</span><span class="token operator">=</span><span class="token number">20971520</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">MaxNewSize</span><span class="token operator">=</span><span class="token number">10485760</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">NewSize</span><span class="token operator">=</span><span class="token number">10485760</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGC</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCDetails</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">PrintGCTimeStamps</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token class-name">SurvivorRatio</span><span class="token operator">=</span><span class="token number">8</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseCompressedClassPointers</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseCompressedOops</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">UseParallelGC</span>
<span class="token number">0.240</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">6524</span>K<span class="token operator">-&gt;</span><span class="token function">706K</span><span class="token punctuation">(</span><span class="token number">9216</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">6524</span>K<span class="token operator">-&gt;</span><span class="token function">4810K</span><span class="token punctuation">(</span><span class="token number">19456</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0127210</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.01</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.02</span> secs<span class="token punctuation">]</span>
<span class="token number">0.256</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">2754</span>K<span class="token operator">-&gt;</span><span class="token function">690K</span><span class="token punctuation">(</span><span class="token number">9216</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">6858</span>K<span class="token operator">-&gt;</span><span class="token function">6850K</span><span class="token punctuation">(</span><span class="token number">19456</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0114299</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.01</span> secs<span class="token punctuation">]</span>
<span class="token number">0.267</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">Full</span> GC <span class="token punctuation">(</span><span class="token class-name">Ergonomics</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">690</span>K<span class="token operator">-&gt;</span><span class="token function">0K</span><span class="token punctuation">(</span><span class="token number">9216</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">ParOldGen</span><span class="token operator">:</span> <span class="token number">6160</span>K<span class="token operator">-&gt;</span><span class="token function">6699K</span><span class="token punctuation">(</span><span class="token number">10240</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">6850</span>K<span class="token operator">-&gt;</span><span class="token function">6699K</span><span class="token punctuation">(</span><span class="token number">19456</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name">Metaspace</span><span class="token operator">:</span> <span class="token number">3305</span>K<span class="token operator">-&gt;</span><span class="token function">3305K</span><span class="token punctuation">(</span><span class="token number">1056768</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.0128112</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.01</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.01</span> secs<span class="token punctuation">]</span>
<span class="token class-name">Heap</span>
 <span class="token class-name">PSYoungGen</span>      total <span class="token number">9216</span>K<span class="token punctuation">,</span> used <span class="token number">6547</span>K <span class="token punctuation">[</span><span class="token number">0x00000007bf600000</span><span class="token punctuation">,</span> <span class="token number">0x00000007c0000000</span><span class="token punctuation">,</span> <span class="token number">0x00000007c0000000</span><span class="token punctuation">)</span>
  eden space <span class="token number">8192</span>K<span class="token punctuation">,</span> <span class="token number">79</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007bf600000</span><span class="token punctuation">,</span><span class="token number">0x00000007bfc64d10</span><span class="token punctuation">,</span><span class="token number">0x00000007bfe00000</span><span class="token punctuation">)</span>
  from space <span class="token number">1024</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007bff00000</span><span class="token punctuation">,</span><span class="token number">0x00000007bff00000</span><span class="token punctuation">,</span><span class="token number">0x00000007c0000000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   space <span class="token number">1024</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007bfe00000</span><span class="token punctuation">,</span><span class="token number">0x00000007bfe00000</span><span class="token punctuation">,</span><span class="token number">0x00000007bff00000</span><span class="token punctuation">)</span>
 <span class="token class-name">ParOldGen</span>       total <span class="token number">10240</span>K<span class="token punctuation">,</span> used <span class="token number">6699</span>K <span class="token punctuation">[</span><span class="token number">0x00000007bec00000</span><span class="token punctuation">,</span> <span class="token number">0x00000007bf600000</span><span class="token punctuation">,</span> <span class="token number">0x00000007bf600000</span><span class="token punctuation">)</span>
  object space <span class="token number">10240</span>K<span class="token punctuation">,</span> <span class="token number">65</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000007bec00000</span><span class="token punctuation">,</span><span class="token number">0x00000007bf28afe8</span><span class="token punctuation">,</span><span class="token number">0x00000007bf600000</span><span class="token punctuation">)</span>
 <span class="token class-name">Metaspace</span>       used <span class="token number">3339</span>K<span class="token punctuation">,</span> capacity <span class="token number">4500</span>K<span class="token punctuation">,</span> committed <span class="token number">4864</span>K<span class="token punctuation">,</span> reserved <span class="token number">1056768</span>K
  <span class="token keyword">class</span> space    used <span class="token number">371</span>K<span class="token punctuation">,</span> capacity <span class="token number">388</span>K<span class="token punctuation">,</span> committed <span class="token number">512</span>K<span class="token punctuation">,</span> reserved <span class="token number">1048576</span>K
</code></pre>
<h1 id="&#x5806;&#x5916;&#x5185;&#x5B58;">&#x5806;&#x5916;&#x5185;&#x5B58;</h1>
<h2 id="&#x95EE;&#x9898;">&#x95EE;&#x9898;</h2>
<p><code>metaspace</code>&#x6CA1;&#x6709;&#x9650;&#x5236;&#xFF0C;&#x5806;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x6B63;&#x5E38;(&#x6CA1;&#x6709;<code>full gc</code>)&#x800C;&#x6CA1;&#x6709;&#x91CA;&#x653E;&#xFF0C;&#x6700;&#x7EC8;&#x4F1A;&#x9047;&#x5230;<code>OOMKilled(&#x7A0B;&#x5E8F;&#x56E0;&#x4E3A;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x8D85;&#x8FC7;&#x9650;&#x989D;&#x88AB; kill -9 &#x6740;&#x6389;)</code>,&#x5373;&#x673A;&#x5668;&#x5B9E;&#x4F8B;&#x7684;OOM</p>
<h2 id="&#x6982;&#x5FF5;">&#x6982;&#x5FF5;</h2>
<p>&#x9664;&#x4E86;&#x5806;&#x5185;&#x5B58;&#xFF0C;Java &#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5806;&#x5916;&#x5185;&#x5B58;&#xFF0C;&#x4E5F;&#x79F0;&#x76F4;&#x63A5;&#x5185;&#x5B58;&#xFF08;Direct Memory&#xFF09;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF1A;&#x5728;&#x901A;&#x4FE1;&#x4E2D;&#xFF0C;&#x5C06;&#x5B58;&#x5728;&#x4E8E;&#x5806;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E; flush &#x5230;&#x8FDC;&#x7A0B;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x9996;&#x5148;&#x5C06;&#x5806;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x62F7;&#x8D1D;&#x5230;&#x5806;&#x5916;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5199;&#x5165; Socket &#x4E2D;&#xFF1B;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x5C06;&#x6570;&#x636E;&#x5B58;&#x5230;&#x5806;&#x5916;&#x5185;&#x5B58;&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x4E0A;&#x8FF0;&#x62F7;&#x8D1D;&#x64CD;&#x4F5C;&#xFF0C;&#x63D0;&#x5347;&#x6027;&#x80FD;&#x3002;&#x7C7B;&#x4F3C;&#x7684;&#x4F8B;&#x5B50;&#x8FD8;&#x6709;&#x8BFB;&#x5199;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x5F88;&#x591A; NIO &#x6846;&#x67B6; &#xFF08;&#x5982; netty&#xFF0C;rpc&#xFF09; &#x4F1A;&#x91C7;&#x7528; Java &#x7684; DirectByteBuffer &#x7C7B;&#x6765;&#x64CD;&#x4F5C;&#x5806;&#x5916;&#x5185;&#x5B58;&#xFF0C;DirectByteBuffer &#x7C7B;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x4F4D;&#x4E8E; Java &#x5185;&#x5B58;&#x6A21;&#x578B;&#x7684;&#x5806;&#x4E2D;&#xFF0C;&#x7531; JVM &#x76F4;&#x63A5;&#x7BA1;&#x63A7;&#x3001;&#x64CD;&#x7EB5;&#x3002;DirectByteBuffer &#x4E2D;&#x7528;&#x4E8E;&#x5206;&#x914D;&#x5806;&#x5916;&#x5185;&#x5B58;&#x7684;&#x65B9;&#x6CD5; unsafe.allocateMemory(size) &#x662F;&#x4E2A; native &#x65B9;&#x6CD5;&#xFF0C;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x7528; C &#x7684; malloc &#x6765;&#x8FDB;&#x884C;&#x5206;&#x914D;&#x7684;&#x3002;</p>
<p><strong>&#x5806;&#x5916;&#x5185;&#x5B58;&#x5E76;&#x4E0D;&#x76F4;&#x63A5;&#x63A7;&#x5236;&#x4E8E;JVM&#xFF0C;&#x56E0;&#x6B64;&#x53EA;&#x80FD;&#x7B49;&#x5230;full GC&#x7684;&#x65F6;&#x5019;&#x624D;&#x80FD;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF01;</strong>&#xFF08;direct buffer&#x5F52;&#x5C5E;&#x7684;&#x7684;JAVA&#x5BF9;&#x8C61;&#x662F;&#x5728;&#x5806;&#x4E0A;&#x4E14;&#x80FD;&#x591F;&#x88AB;GC&#x56DE;&#x6536;&#x7684;&#xFF0C;&#x4E00;&#x65E6;&#x5B83;&#x88AB;&#x56DE;&#x6536;&#xFF0C;JVM&#x5C06;&#x91CA;&#x653E;direct buffer&#x7684;&#x5806;&#x5916;&#x7A7A;&#x95F4;&#x3002;&#x524D;&#x63D0;&#x662F;&#x6CA1;&#x6709;&#x5173;&#x95ED;DisableExplicitGC&#xFF09;&#x3002;&#x5806;&#x5916;&#x5185;&#x5B58;&#x5305;&#x542B;&#x7EBF;&#x7A0B;&#x6808;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#xFF0C;NIO&#x7F13;&#x5B58;&#xFF0C;JNI&#x8C03;&#x7528;&#x7B49;.&#x4F8B;&#x5982;<code>ByteBuffer bb = ByteBuffer.allocateDirect(1024)</code>&#xFF0C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x6267;&#x884C;&#x4F1A;&#x5728;&#x5806;&#x5916;&#x5360;&#x7528;<code>1k</code>&#x7684;&#x5185;&#x5B58;&#xFF0C;Java&#x5806;&#x5185;&#x53EA;&#x4F1A;&#x5360;&#x7528;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6307;&#x9488;&#x5F15;&#x7528;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5806;&#x5916;&#x7684;&#x8FD9;1k&#x7684;&#x7A7A;&#x95F4;&#x53EA;&#x6709;&#x5F53;bb&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#x65F6;&#xFF0C;&#x624D;&#x4F1A;&#x88AB;&#x56DE;&#x6536;&#xFF0C;&#x8FD9;&#x91CC;&#x4F1A;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;&#x660E;&#x663E;&#x7684;&#x4E0D;&#x5BF9;&#x79F0;&#x73B0;&#x8C61;&#xFF0C;&#x5C31;&#x662F;&#x5806;&#x5916;&#x53EF;&#x80FD;&#x5360;&#x7528;&#x4E86;&#x5F88;&#x591A;&#xFF0C;&#x800C;&#x5806;&#x5185;&#x6CA1;&#x5360;&#x7528;&#x591A;&#x5C11;&#xFF0C;&#x5BFC;&#x81F4;&#x8FD8;&#x6CA1;&#x89E6;&#x53D1;GC&#xFF0C;&#x90A3;&#x5C31;&#x5F88;&#x5BB9;&#x6613;&#x51FA;&#x73B0;<strong>Direct Memory&#x9020;&#x6210;&#x7269;&#x7406;&#x5185;&#x5B58;&#x8017;&#x5149;</strong></p>
<h3 id="directbytebuffer-&#x5982;&#x4F55;&#x56DE;&#x6536;">DirectByteBuffer &#x5982;&#x4F55;&#x56DE;&#x6536;</h3>
<p>JDK&#x4E2D;&#x4F7F;&#x7528;DirectByteBuffer&#x5BF9;&#x8C61;&#x6765;&#x8868;&#x793A;&#x5806;&#x5916;&#x5185;&#x5B58;&#xFF0C;&#x6BCF;&#x4E2A;DirectByteBuffer&#x5BF9;&#x8C61;&#x5728;&#x521D;&#x59CB;&#x5316;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;<code>Cleaner</code>&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;Cleaner&#x5BF9;&#x8C61;&#x4F1A;&#x5728;&#x5408;&#x9002;&#x7684;&#x65F6;&#x5019;&#x6267;&#x884C;<code>unsafe.freeMemory(address)</code>&#xFF0C;&#x4ECE;&#x800C;&#x56DE;&#x6536;&#x8FD9;&#x5757;&#x5806;&#x5916;&#x5185;&#x5B58;&#x3002;</p>
<p>Cleaner &#x7EE7;&#x627F;&#x4E86; PhantomReference&#xFF08;&#x865A;&#x5F15;&#x7528;&#xFF09;</p>
<h3 id="&#x5806;&#x5916;&#x5185;&#x5B58;&#x6EA2;&#x51FA;">&#x5806;&#x5916;&#x5185;&#x5B58;&#x6EA2;&#x51FA;</h3>
<ol>
<li>&#x6700;&#x5927;&#x7684;&#x5806;&#x5916;&#x5185;&#x5B58;&#x8BBE;&#x7F6E;&#x7684;&#x592A;&#x5C0F;&#x4E86;</li>
<li>&#x6CA1;&#x6709;full gc&#xFF0C;&#x5806;&#x5916;&#x5185;&#x5B58;&#x6CA1;&#x6709;&#x53CA;&#x65F6;&#x88AB;&#x6E05;&#x7406;&#x6389;</li>
<li>&#x5143;&#x7A7A;&#x95F4;&#x6EA2;&#x51FA;</li>
</ol>
<h3 id="&#x5806;&#x5916;&#x5185;&#x5B58;&#x66F4;&#x9002;&#x5408;&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;">&#x5806;&#x5916;&#x5185;&#x5B58;&#x66F4;&#x9002;&#x5408;&#x5B58;&#x50A8;&#x7684;&#x5BF9;&#x8C61;</h3>
<ul>
<li>&#x5B58;&#x50A8;&#x751F;&#x547D;&#x5468;&#x671F;&#x957F;&#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x53EF;&#x4EE5;&#x5728;&#x8FDB;&#x7A0B;&#x95F4;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#xFF0C;&#x51CF;&#x5C11; JVM &#x95F4;&#x7684;&#x5BF9;&#x8C61;&#x590D;&#x5236;&#xFF0C;&#x4F7F;&#x5F97; JVM &#x7684;&#x5206;&#x5272;&#x90E8;&#x7F72;&#x66F4;&#x5BB9;&#x6613;&#x5B9E;&#x73B0;</li>
<li>&#x672C;&#x5730;&#x7F13;&#x5B58;&#xFF0C;&#x51CF;&#x5C11;&#x78C1;&#x76D8;&#x7F13;&#x5B58;&#x6216;&#x8005;&#x5206;&#x5E03;&#x5F0F;&#x7F13;&#x5B58;&#x7684;&#x54CD;&#x5E94;&#x65F6;&#x95F4;</li>
</ul>
<h1 id="java-&#x5185;&#x5B58;&#x533A;&#x57DF;&#x548C;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x6F14;&#x7EC3;&#x6D4B;&#x8BD5;">Java &#x5185;&#x5B58;&#x533A;&#x57DF;&#x548C;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x6F14;&#x7EC3;&#x6D4B;&#x8BD5;</h1>
<h2 id="outofmemoryerror">OutOfMemoryError</h2>
<p>java vm&#x53C2;&#x6570;</p>
<ul>
<li>-Xms20M</li>
</ul>
<p>&#x8868;&#x793A;&#x8BBE;&#x7F6E;<code>&#x5806;&#x5BB9;&#x91CF;&#x7684;&#x6700;&#x5C0F;&#x503C;</code>&#x4E3A;20M&#xFF0C;&#x5FC5;&#x987B;&#x4EE5;M&#x4E3A;&#x5355;&#x4F4D;</p>
<ul>
<li>-Xmx20M</li>
</ul>
<p>&#x8868;&#x793A;&#x8BBE;&#x7F6E;&#x5806;&#x5BB9;&#x91CF;&#x7684;&#x6700;&#x5927;&#x503C;&#x4E3A;20M&#xFF0C;&#x5FC5;&#x987B;&#x4EE5;M&#x4E3A;&#x5355;&#x4F4D;&#x3002;&#x5C06;-Xmx&#x548C;-Xms&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x6837;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5806;&#x81EA;&#x52A8;&#x6269;&#x5C55;&#x3002;</p>
<pre class="language-"><code class="lang-java"><span class="token keyword">package</span> java7<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * &#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#xFF1A;-verbose:gc -Xms20M -Xmx20M -XX:+HeapDumpOnOutOfMemoryError
 * @Author mubi
 * @Date 2019/2/20 11:05 PM
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapOOM</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">OOMObject</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OOMObject</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OOMObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>output</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token punctuation">[</span>GC <span class="token number">5499</span>K<span class="token operator">-&gt;</span><span class="token function">3757K</span><span class="token punctuation">(</span><span class="token number">20480</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0069130</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span>GC <span class="token number">9901</span>K<span class="token operator">-&gt;</span><span class="token function">8805K</span><span class="token punctuation">(</span><span class="token number">20480</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0089900</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Full</span> GC <span class="token number">18460</span>K<span class="token operator">-&gt;</span><span class="token function">13805K</span><span class="token punctuation">(</span><span class="token number">20480</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1417260</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Full</span> GC <span class="token number">17849</span>K<span class="token operator">-&gt;</span><span class="token function">17803K</span><span class="token punctuation">(</span><span class="token number">20480</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1140610</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Full</span> GC <span class="token number">17803</span>K<span class="token operator">-&gt;</span><span class="token function">17791K</span><span class="token punctuation">(</span><span class="token number">20480</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0981060</span> secs<span class="token punctuation">]</span>
java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">OutOfMemoryError</span><span class="token operator">:</span> <span class="token class-name">Java</span> heap space
<span class="token class-name">Dumping</span> heap <span class="token keyword">to</span> <span class="token namespace">java_pid42185<span class="token punctuation">.</span>hprof</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token class-name">Heap</span> dump file created <span class="token punctuation">[</span><span class="token number">30470683</span> bytes in <span class="token number">0.161</span> secs<span class="token punctuation">]</span>
<span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">OutOfMemoryError</span><span class="token operator">:</span> <span class="token class-name">Java</span> heap space
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2245</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2219</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">grow</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">242</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">216</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">208</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">440</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">HeapOOM</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">HeapOOM</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="imgs/oom_analyse.png" alt=""></p>
<ul>
<li><p>Shallow heap&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6D88;&#x8D39;&#x7684;&#x5185;&#x5B58;&#x6570;&#x91CF;&#x3002;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x9700;&#x8981;32&#xFF08;&#x6216;&#x8005;64 bits&#xFF0C;&#x57FA;&#x4E8E;CPU&#x67B6;&#x6784;&#xFF09;&#x3002;</p>
</li>
<li><p>Retained Heap&#x663E;&#x793A;&#x7684;&#x662F;&#x90A3;&#x4E9B;&#x5F53;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x5019;&#x4F1A;&#x6E05;&#x7406;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x7684;Shallow Heap&#x7684;&#x603B;&#x548C;&#x3002;</p>
</li>
</ul>
<p><img src="imgs/oom_histogram.png" alt=""></p>
<ul>
<li><p>&#x53C2;&#x8003;</p>
</li>
<li><p>&#x300A;Java &#x865A;&#x62DF;&#x673A;&#x300B;&#xFF08;&#x7B2C;&#x4E8C;&#x7248;&#xFF09;</p>
</li>
<li><p><a href="https://www.cnblogs.com/cnmenglang/p/6261435.html" target="_blank">&#x53C2;&#x8003;1</a></p>
</li>
<li><p><a href="https://www.jianshu.com/p/759e02c1feee" target="_blank">&#x53C2;&#x8003;2</a></p>
</li>
</ul>
<h2 id="&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x6EA2;&#x51FA;">&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x6EA2;&#x51FA;</h2>
<ul>
<li><p>Java&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x81EA;&#x5DF1;&#x7684;Stack Space(&#x5806;&#x6808;)&#x3002;</p>
</li>
<li><p>-Xss128k&#xFF1A;</p>
</li>
</ul>
<p>&#x8BBE;&#x7F6E;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x5806;&#x6808;&#x5927;&#x5C0F;&#x3002;JDK5.0&#x4EE5;&#x540E;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5806; &#x6808;&#x5927;&#x5C0F;&#x4E3A;1M&#xFF0C;&#x4EE5;&#x524D;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5806;&#x6808;&#x5927;&#x5C0F;&#x4E3A;256K&#x3002;&#x6839;&#x636E;&#x5E94;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x6240;&#x9700;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x8C03;&#x6574;&#x3002;&#x5728;&#x76F8;&#x540C;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E0B;&#xFF0C;&#x51CF;&#x5C0F;&#x8FD9;&#x4E2A;&#x503C;&#x80FD;&#x751F;&#x6210;&#x66F4;&#x591A;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x4F46;&#x662F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5BF9;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5185;&#x7684;&#x7EBF;&#x7A0B;&#x6570;&#x8FD8;&#x662F;&#x6709;&#x9650;&#x5236;&#x7684;&#xFF0C;&#x4E0D;&#x80FD;&#x65E0;&#x9650;&#x751F;&#x6210;&#xFF0C;&#x7ECF;&#x9A8C;&#x503C;&#x5728;3000~5000&#x5DE6;&#x53F3;</p>
<p>Stack Space&#x7528;&#x6765;&#x505A;&#x65B9;&#x6CD5;&#x7684;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x65F6;&#x538B;&#x5165;Stack Frame(&#x6808;&#x5E27;)&#x3002;&#x6240;&#x4EE5;&#x5F53;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x592A;&#x6DF1;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x6709;&#x53EF;&#x80FD;&#x8017;&#x5C3D;Stack Space&#xFF0C;&#x7206;&#x51FA;StackOverflow&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<ul>
<li>code</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token keyword">package</span> java7<span class="token punctuation">;</span>

<span class="token comment">/**
 * &#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#xFF1A;-Xss160k
 * @Author mubi
 * @Date 2019/2/20 11:05 PM
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JavaVMStackSOF</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> stackLength <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        stackLength <span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">JavaVMStackSOF</span> javaVMStackSOF <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">try</span><span class="token punctuation">{</span>
           javaVMStackSOF<span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;stackLength:&quot;</span> <span class="token operator">+</span> javaVMStackSOF<span class="token punctuation">.</span>stackLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>output</p>
<pre class="language-"><code class="lang-java">stackLength<span class="token operator">:</span><span class="token number">774</span>
<span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">StackOverflowError</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span><span class="token function">stackLeak</span><span class="token punctuation">(</span><span class="token class-name">JavaVMStackSOF</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>
</code></pre>
<p>&#x53C2;&#x8003;&#xFF1A;</p>
<ol>
<li><a href="https://blog.csdn.net/z69183787/article/details/79228215" target="_blank">&#x53C2;&#x8003;blog</a></li>
</ol>
<h2 id="&#x65B9;&#x6CD5;&#x533A;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x6EA2;&#x51FA;">&#x65B9;&#x6CD5;&#x533A;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x6EA2;&#x51FA;</h2>
<p>&#x65B9;&#x6CD5;&#x533A;&#x7528;&#x4E8E;&#x5B58;&#x653E;Class&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#xFF1A;&#x7C7B;&#x540D;&#xFF0C;&#x8BBF;&#x95EE;&#x4FEE;&#x9970;&#x7B26;&#xFF0C;&#x5E38;&#x91CF;&#x6C60;&#xFF0C;&#x5B57;&#x7B26;&#x63CF;&#x8FF0;&#xFF0C;&#x65B9;&#x6CD5;&#x63CF;&#x8FF0;&#x7B49;&#x3002;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x57FA;&#x672C;&#x601D;&#x8DEF;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x4EA7;&#x751F;&#x5927;&#x91CF;&#x7684;&#x7C7B;&#x53BB;&#x586B;&#x6EE1;&#x65B9;&#x6CD5;&#x533A;&#xFF0C;&#x76F4;&#x5230;&#x6EA2;&#x51FA;&#x3002;</p>
<ul>
<li><p>Java7&#x4E2D;</p>
</li>
<li><p>Java7 &#x6C38;&#x4E45;&#x4EE3;&#x4ECD;&#x5B58;&#x5728;&#xFF1B;&#x5BF9;&#x6BD4;java6&#xFF0C;&#x5176;&#x4E2D;&#xFF1A;&#x7B26;&#x53F7;&#x5F15;&#x7528;(Symbols)&#x8F6C;&#x79FB;&#x5230;&#x4E86;native heap&#xFF1B;&#x5B57;&#x9762;&#x91CF;(interned strings)&#x8F6C;&#x79FB;&#x5230;&#x4E86;java heap&#xFF1B;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x53D8;&#x91CF;(class statics)&#x8F6C;&#x79FB;&#x5230;&#x4E86;java heap&#x3002;</p>
</li>
</ul>
<h3 id="java7-&#x5E38;&#x91CF;&#x6C60;-&#x4ECD;&#x662F;javalangoutofmemoryerror-java-heap-space">Java7 &#x5E38;&#x91CF;&#x6C60; &#x4ECD;&#x662F;<code>java.lang.OutOfMemoryError: Java heap space</code></h3>
<pre class="language-"><code class="lang-java"><span class="token keyword">package</span> java7<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util</span><span class="token punctuation">.</span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * VM args: -XX:PermSize=10M -XX:MaxPermSize=10M
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JavaMethodAreaOOM</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * &#x5728;JDK1.6&#x4E2D;&#xFF0C;intern()&#x65B9;&#x6CD5;&#x4F1A;&#x628A;&#x9996;&#x6B21;&#x9047;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x590D;&#x5236;&#x5230;&#x6C38;&#x4E45;&#x4EE3;&#x4E2D;&#xFF0C;
     * &#x8FD4;&#x56DE;&#x7684;&#x4E5F;&#x662F;&#x6C38;&#x4E45;&#x4EE3;&#x4E2D;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F15;&#x7528;&#xFF0C;
     * &#x800C;&#x7531;StringBuilder&#x521B;&#x5EFA;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5B9E;&#x4F8B;&#x5728;Java&#x5806;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x5FC5;&#x7136;&#x4E0D;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#xFF0C;&#x5C06;&#x8FD4;&#x56DE;false&#x3002;
     * 
     * &#x800C;JDK1.7(&#x4EE5;&#x53CA;&#x90E8;&#x5206;&#x5176;&#x4ED6;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x4F8B;&#x5982;JRockit)&#x7684;intern()&#x5B9E;&#x73B0;&#x4E0D;&#x4F1A;&#x518D;&#x590D;&#x5236;&#x5B9E;&#x4F8B;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x5E38;&#x91CF;&#x6C60;&#x4E2D;&#x8BB0;&#x5F55;&#x9996;&#x6B21;&#x51FA;&#x73B0;&#x7684;&#x5B9E;&#x4F8B;&#x5F15;&#x7528;&#xFF0C;
     * &#x56E0;&#x6B64;intern()&#x8FD4;&#x56DE;&#x7684;&#x5F15;&#x7528;&#x548C;&#x7531;StringBuilder&#x521B;&#x5EFA;&#x7684;&#x90A3;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x3002;
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testStringIntern</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> str1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;&#x8BA1;&#x7B97;&#x673A;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&#x8F6F;&#x4EF6;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str1<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> str1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

        <span class="token class-name">String</span> str2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;ja&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;va&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str2<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">String</span>  base <span class="token operator">=</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x4E0D;&#x65AD;&#x751F;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">String</span> str <span class="token operator">=</span> base <span class="token operator">+</span> base<span class="token punctuation">;</span>
            base <span class="token operator">=</span> str<span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>output</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">OutOfMemoryError</span><span class="token operator">:</span> <span class="token class-name">Java</span> heap space
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2367</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">AbstractStringBuilder</span><span class="token punctuation">.</span><span class="token function">expandCapacity</span><span class="token punctuation">(</span><span class="token class-name">AbstractStringBuilder</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">130</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">AbstractStringBuilder</span><span class="token punctuation">.</span><span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token class-name">AbstractStringBuilder</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">114</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">AbstractStringBuilder</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">AbstractStringBuilder</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">415</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">StringBuilder</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">StringBuilder</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">132</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">JavaMethodAreaOOM</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">JavaMethodAreaOOM</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">31</span>
</code></pre>
<p>&#x53C2;&#x8003;&#xFF1A;</p>
<ol>
<li><a href="https://blog.csdn.net/tlk20071/article/details/77841841" target="_blank">&#x53C2;&#x8003;blog</a></li>
</ol>
<h2 id="&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x6EA2;&#x51FA;">&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x6EA2;&#x51FA;</h2>
<p>NIO&#x7684;Buffer&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x4E0D;&#x7ECF;&#x8FC7;JVM&#x5185;&#x5B58;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x7CFB;&#x7EDF;&#x7269;&#x7406;&#x5185;&#x5B58;&#x7684;&#x7C7B;&#x2014;&#x2014;DirectBuffer&#x3002;DirectBuffer&#x7C7B;&#x7EE7;&#x627F;&#x81EA;ByteBuffer&#xFF0C;&#x4F46;&#x548C;&#x666E;&#x901A;&#x7684;ByteBuffer&#x4E0D;&#x540C;&#xFF0C;&#x666E;&#x901A;&#x7684;ByteBuffer&#x4ECD;&#x5728;JVM&#x5806;&#x4E0A;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x5176;&#x6700;&#x5927;&#x5185;&#x5B58;&#x53D7;&#x5230;&#x6700;&#x5927;&#x5806;&#x5185;&#x5B58;&#x7684;&#x9650;&#x5236;&#xFF1B;&#x800C;DirectBuffer&#x76F4;&#x63A5;&#x5206;&#x914D;&#x5728;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x5E76;&#x4E0D;&#x5360;&#x7528;&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x5176;&#x53EF;&#x7533;&#x8BF7;&#x7684;&#x6700;&#x5927;&#x5185;&#x5B58;&#x53D7;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x3002;</p>
<p>&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x7684;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x6BD4;&#x666E;&#x901A;Buffer&#x5FEB;&#xFF0C;&#x4F46;&#x5B83;&#x7684;&#x521B;&#x5EFA;&#x3001;&#x9500;&#x6BC1;&#x6BD4;&#x666E;&#x901A;Buffer&#x6162;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x4E8E;&#x9700;&#x8981;&#x5927;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x4E14;&#x9891;&#x7E41;&#x8BBF;&#x95EE;&#x7684;&#x573A;&#x5408;&#xFF0C;&#x4E0D;&#x9002;&#x7528;&#x4E8E;&#x9891;&#x7E41;&#x7533;&#x8BF7;&#x91CA;&#x653E;&#x5185;&#x5B58;&#x7684;&#x573A;&#x5408;&#x3002;</p>
<ul>
<li><code>-XX:MaxDirectMemorySize</code>&#xFF0C;&#x8BE5;&#x503C;&#x662F;&#x6709;&#x4E0A;&#x9650;&#x7684;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;64M&#xFF0C;&#x6700;&#x5927;&#x4E3A;<code>sun.misc.VM.maxDirectMemory()</code>&#xFF0C;&#x6B64;&#x53C2;&#x6570;&#x7684;&#x542B;&#x4E49;&#x662F;&#x5F53;Direct ByteBuffer&#x5206;&#x914D;&#x7684;&#x5806;&#x5916;&#x5185;&#x5B58;&#x5230;&#x8FBE;&#x6307;&#x5B9A;&#x5927;&#x5C0F;&#x540E;&#xFF0C;&#x5373;&#x89E6;&#x53D1;Full GC</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token keyword">package</span> java7<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio</span><span class="token punctuation">.</span><span class="token class-name">ByteBuffer</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * &#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#xFF1A;-verbose:-Xmx20M -XX:MaxDirectMemorySize=10M
 * @Author mubi
 * @Date 2019/2/20 11:05 PM
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DirectMemoryOOM</span> <span class="token punctuation">{</span>
     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> _1MB <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
        <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocateDirect</span><span class="token punctuation">(</span><span class="token number">11</span> <span class="token operator">*</span> _1MB<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>output</li>
</ul>
<pre class="language-"><code class="lang-java"><span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">OutOfMemoryError</span><span class="token operator">:</span> <span class="token class-name">Direct</span> buffer memory
    at java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span><span class="token class-name">Bits</span><span class="token punctuation">.</span><span class="token function">reserveMemory</span><span class="token punctuation">(</span><span class="token class-name">Bits</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">658</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span><span class="token class-name">DirectByteBuffer</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">DirectByteBuffer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span><span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocateDirect</span><span class="token punctuation">(</span><span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">306</span><span class="token punctuation">)</span>
    at java7<span class="token punctuation">.</span><span class="token class-name">DirectMemoryOOM</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">DirectMemoryOOM</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">)</span>
</code></pre>
<p><footer class="page-footer"><span class="copyright">Copyright @doctording all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF1A;
2023-03-30 08:17:04
</span></footer><div id="gitalk-container"></div><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="jvm_hot.html" class="navigation navigation-prev " aria-label="Previous page: JVM预热">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="jvm_params.html" class="navigation navigation-next " aria-label="Next page: JVM参数">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"堆栈 & GC","layout":"page","date":"2019-02-15 00:00","level":"1.10.6","depth":2,"next":{"title":"JVM参数","level":"1.10.7","depth":2,"path":"content/java_jvm/jvm_params.md","ref":"./content/java_jvm/jvm_params.md","articles":[]},"previous":{"title":"JVM预热","level":"1.10.5","depth":2,"path":"content/java_jvm/jvm_hot.md","ref":"./content/java_jvm/jvm_hot.md","articles":[]},"dir":"ltr"},"config":{"plugins":["prism","-highlight","-lunr","-search","-sharing","ace","codeblock-filename","search-plus","sectionx","splitter","tbfed-pagefooter","expandable-chapters","back-to-top-button","code","copy-code-button","uml","page-treeview","gittalk","advanced-emoji","todo","github"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright @doctording","modify_label":"该文件修改时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"page-treeview":{"collapsed":false,"copyright":"Copyright @doctording","minHeaderCount":"2","minHeaderDeep":"2"},"prism":{},"ace":{},"github":{"url":"https://github.com/doctording"},"todo":{},"splitter":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"sectionx":{},"uml":{"format":"svg"},"codeblock-filename":{},"back-to-top-button":{},"copy-code-button":{},"advanced-emoji":{"embedEmojis":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"gittalk":{"clientID":"094729e19245d3fe84aa","clientSecret":"6c4cf7b48e7ae41c20d453c24eb9d5469e4d19fb","repo":"sword_at_offer","owner":"doctording","admin":["doctording"],"distractionFreeMode":false},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"doctording","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"java-note","language":"zh-hans","gitbook":"*","description":"Java开发"},"file":{"path":"content/java_jvm/jvm_mem_gc.md","mtime":"2023-03-30T00:17:04.761Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-09-09T05:44:40.932Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-ace/ace/ace.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ace/ace.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sectionx/sectionx.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-gittalk/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

